<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="20056" />

<meta name="date" content="2020-12-21" />

<title>Introduction to StatComp20056</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>
<style type="text/css">
a.anchor-section {margin-left: 10px; visibility: hidden; color: inherit;}
a.anchor-section::before {content: '#';}
.hasAnchor:hover a.anchor-section {visibility: visible;}
</style>
<script>// Anchor sections v1.0 written by Atsushi Yasumoto on Oct 3rd, 2020.
document.addEventListener('DOMContentLoaded', function() {
  // Do nothing if AnchorJS is used
  if (typeof window.anchors === 'object' && anchors.hasOwnProperty('hasAnchorJSLink')) {
    return;
  }

  const h = document.querySelectorAll('h1, h2, h3, h4, h5, h6');

  // Do nothing if sections are already anchored
  if (Array.from(h).some(x => x.classList.contains('hasAnchor'))) {
    return null;
  }

  // Use section id when pandoc runs with --section-divs
  const section_id = function(x) {
    return ((x.classList.contains('section') || (x.tagName === 'SECTION'))
            ? x.id : '');
  };

  // Add anchors
  h.forEach(function(x) {
    const id = x.id || section_id(x.parentElement);
    if (id === '') {
      return null;
    }
    let anchor = document.createElement('a');
    anchor.href = '#' + id;
    anchor.classList = ['anchor-section'];
    x.classList.add('hasAnchor');
    x.appendChild(anchor);
  });
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to StatComp20056</h1>
<h4 class="author">20056</h4>
<h4 class="date">2020-12-21</h4>



<div id="section" class="section level1">
<h1>2020-09-22</h1>
<div id="question-1" class="section level2">
<h2>Question 1</h2>
<p>The 1st example should contain texts and at least one ﬁgure.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer 1</h2>
<p>20 samples were randomly selected from the standard normal distribution and the t-distribution with 5 degrees of freedom, respectively, and q-q graphs were made for the two samples.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a>x&lt;-<span class="kw">rnorm</span>(<span class="dv">20</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a>y&lt;-<span class="kw">rt</span>(<span class="dv">20</span>,<span class="dv">5</span>)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">qqnorm</span>(x,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="kw">mtext</span>(<span class="st">&quot;random samples from N(0,1)&quot;</span>,<span class="dt">side=</span><span class="dv">3</span>,<span class="dt">line=</span><span class="fl">0.5</span>,<span class="dt">at=</span><span class="fl">1.3</span>,<span class="dt">cex=</span><span class="fl">0.9</span>)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="kw">qqnorm</span>(y,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="kw">mtext</span>(<span class="st">&quot;random samples from t(5)&quot;</span>,<span class="dt">side=</span><span class="dv">3</span>,<span class="dt">line=</span><span class="fl">0.5</span>,<span class="dt">at=</span><span class="fl">1.3</span>,<span class="dt">cex=</span><span class="fl">0.9</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-2" class="section level2">
<h2>Question 2</h2>
<p>The 2nd example should contains texts and at least one table.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer 2</h2>
<p>Generate samples of different distribution forms with a sample size of 10, form a data frame and list the data in a table form.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">library</span>(knitr)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a>z1&lt;-<span class="kw">round</span>(<span class="kw">runif</span>(<span class="dv">10</span>),<span class="dv">3</span>);z2&lt;-<span class="kw">round</span>(<span class="kw">rnorm</span>(<span class="dv">10</span>),<span class="dv">3</span>);z3&lt;-<span class="kw">round</span>(<span class="kw">rexp</span>(<span class="dv">10</span>),<span class="dv">3</span>);</span>
<span id="cb2-4"><a href="#cb2-4"></a>m&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,z1,z2,z3),<span class="dv">10</span>,<span class="dv">4</span>)</span>
<span id="cb2-5"><a href="#cb2-5"></a>m&lt;-<span class="kw">as.data.frame</span>(m)</span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="kw">names</span>(m)&lt;-<span class="kw">c</span>(<span class="st">&quot;No&quot;</span>,<span class="st">&quot;uniform&quot;</span>,<span class="st">&quot;normal&quot;</span>,<span class="st">&quot;exponential&quot;</span>)</span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co">##knitr::kable(m, format=&quot;html&quot;)</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co">##print(xtable(m), type=&quot;html&quot;)</span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="kw">kable</span>(m, <span class="dt">format =</span> <span class="st">&quot;html&quot;</span>,<span class="dt">caption =</span> <span class="st">&quot;Different Distributions&quot;</span>)</span></code></pre></div>
<table>
<caption>
Different Distributions
</caption>
<thead>
<tr>
<th style="text-align:right;">
No
</th>
<th style="text-align:right;">
uniform
</th>
<th style="text-align:right;">
normal
</th>
<th style="text-align:right;">
exponential
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.185
</td>
<td style="text-align:right;">
0.132
</td>
<td style="text-align:right;">
4.492
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.702
</td>
<td style="text-align:right;">
0.708
</td>
<td style="text-align:right;">
1.703
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.573
</td>
<td style="text-align:right;">
-0.240
</td>
<td style="text-align:right;">
0.620
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0.168
</td>
<td style="text-align:right;">
1.984
</td>
<td style="text-align:right;">
0.356
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.944
</td>
<td style="text-align:right;">
-0.139
</td>
<td style="text-align:right;">
0.689
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0.943
</td>
<td style="text-align:right;">
0.418
</td>
<td style="text-align:right;">
0.833
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0.129
</td>
<td style="text-align:right;">
0.982
</td>
<td style="text-align:right;">
0.334
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.833
</td>
<td style="text-align:right;">
-0.393
</td>
<td style="text-align:right;">
1.590
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0.468
</td>
<td style="text-align:right;">
-1.040
</td>
<td style="text-align:right;">
0.080
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0.550
</td>
<td style="text-align:right;">
1.782
</td>
<td style="text-align:right;">
0.551
</td>
</tr>
</tbody>
</table>
</div>
<div id="question-3" class="section level2">
<h2>Question 3</h2>
<p>The 3rd example should contain at least a couple of LaTeX formulas.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer 3</h2>
<p>Let <span class="math inline">\(X_1, X_2, \ldots, X_n \sim (unknown)F,\)</span> then the definition of empirical distribution function(ECDF) is <span class="math display">\[F_n(x)=\sum_{i=1}^{n} 1\left\{X_i \le x \right\}\]</span> where <span class="math display">\[1\left\{X_{i} \leq x\right\}=\left\{\begin{array}{l}1, X_{i} \leq x \\ 0, \text { otherwise }\end{array}\right.\]</span> Properties:</p>
<ul>
<li><p>For fixed x, <span class="math inline">\(nF_n(x)\sim B(n,F(x)),\)</span> then <span class="math inline">\(EF_n(x)=F(x),\quad Var(F_n(x))=\frac{F(x)(1-F(x))}{n}.\)</span></p></li>
<li><p>Glivenko-Cantelli Theorem<br />
For any distribution of F, <span class="math inline">\(\sup_{x \in R}|F_{n}(x)-F(x)| \rightarrow 0,\quad as(n \rightarrow \infty)\)</span></p></li>
<li><p>Dvoretzky-Kiefer-Wolfowith(DKW) Inequality<br />
For any <span class="math inline">\(\varepsilon &gt;0\)</span> and n, <span class="math display">\[P(sup_{x \in R} |F_n(x)-F(x)|&gt;\varepsilon)\leq 2e^{-2n\varepsilon^2}\]</span></p></li>
</ul>
</div>
</div>
<div id="section-1" class="section level1">
<h1>2020-09-29</h1>
<div id="question-3.3" class="section level2">
<h2>Question 3.3</h2>
<p>The Pareto(a, b) distribution has cdf <span class="math display">\[F(x)=1-(\frac{b}{x})^a, \quad x\geq b&gt;0, a&gt;0\]</span> Derive the probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> and use the inverse transform method to simulate a random sample from the Pareto(2, 2) distribution. Graph the density histogram of the sample with the Pareto(2, 2) density superimposed for comparison.</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p><span class="math inline">\(X\sim Pareto(a,b)\)</span>. Let <span class="math inline">\(U=F(X)=1-(\frac{b}{x})^a \sim Uniform(0,1)\)</span>, then <span class="math inline">\(F^{-1}(U)=b\cdot (1-U)^{-\frac{1}{a}}.\)</span></p>
<p>The probability density function of the random variable X is <span class="math inline">\(F(x)=a\cdot b^a\cdot x^{-a-1}\)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a>a&lt;-<span class="dv">2</span>;b&lt;-<span class="dv">2</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>u1&lt;-<span class="kw">runif</span>(<span class="dv">500</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a>x1&lt;-b<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>u1)<span class="op">^</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span>a)<span class="co">## generate samples from Preto(2,2)</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="kw">hist</span>(x1,<span class="dt">prob=</span>T,<span class="dt">main=</span><span class="st">&quot;Density histogram of the sample  with the Pareto(2, 2) density&quot;</span>)</span>
<span id="cb3-6"><a href="#cb3-6"></a>x2&lt;-<span class="kw">seq</span>(b,<span class="kw">max</span>(x1),<span class="fl">0.1</span>)</span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="kw">lines</span>(x2,a<span class="op">*</span>b<span class="op">^</span>a<span class="op">*</span>x2<span class="op">^</span>(<span class="op">-</span>a<span class="dv">-1</span>))<span class="co">## theoretical density curve</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The density histogram of the sample with the Pareto(2, 2) density superimposed is shown above.</p>
</div>
<div id="question-3.9" class="section level2">
<h2>Question 3.9</h2>
<p>The rescaled Epanechnikov kernel [85] is a symmetric density function <span class="math display">\[f_{e}(x)=\frac{3}{4}\left(1-x^{2}\right), \quad|x| \leq 1\]</span> Devroye and Gyorfi [71, p.236] give the following algorithm for simulation from this distribution. Generate iid <span class="math inline">\(U_1, U_2, U_3\sim Uniform(−1, 1)\)</span>. If <span class="math inline">\(|U_3| ≥ |U_2|\)</span> and <span class="math inline">\(|U_3|≥|U_1|\)</span>, deliver <span class="math inline">\(U_2\)</span>; otherwise deliver <span class="math inline">\(U_3\)</span>. Write a function to generate random variates from <span class="math inline">\(f_e\)</span>, and construct the histogram density estimate of a large simulated random sample.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<p>The function “ranfe” is to generate random variates from <span class="math inline">\(f_e\)</span>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">set.seed</span>(<span class="dv">22</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a>ranfe&lt;-<span class="cf">function</span>(n){<span class="co">## the function to generate random variates from fe</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>  u1&lt;-<span class="kw">runif</span>(n,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>);u2&lt;-<span class="kw">runif</span>(n,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>);u3&lt;-<span class="kw">runif</span>(n,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb4-4"><a href="#cb4-4"></a>  x1&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb4-6"><a href="#cb4-6"></a>  <span class="cf">if</span>(<span class="kw">abs</span>(u3[i])<span class="op">&gt;=</span><span class="kw">abs</span>(u2[i])<span class="op">&amp;&amp;</span><span class="kw">abs</span>(u3[i])<span class="op">&gt;=</span><span class="kw">abs</span>(u1[i])){</span>
<span id="cb4-7"><a href="#cb4-7"></a>    x1[i]&lt;-u2[i]</span>
<span id="cb4-8"><a href="#cb4-8"></a>  }<span class="cf">else</span>{</span>
<span id="cb4-9"><a href="#cb4-9"></a>    x1[i]&lt;-u3[i]</span>
<span id="cb4-10"><a href="#cb4-10"></a>  }</span>
<span id="cb4-11"><a href="#cb4-11"></a>}</span>
<span id="cb4-12"><a href="#cb4-12"></a>  <span class="kw">return</span>(x1)</span>
<span id="cb4-13"><a href="#cb4-13"></a>}</span>
<span id="cb4-14"><a href="#cb4-14"></a>x1&lt;-<span class="kw">ranfe</span>(<span class="dt">n=</span><span class="dv">10000</span>)</span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="kw">hist</span>(x1,<span class="dt">prob=</span>T)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co">##x2&lt;-seq(-1,1,0.01)</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co">##lines(x2,3/4*(1-x2^2))## theoretical density curve</span></span></code></pre></div>
</div>
<div id="question-3.10" class="section level2">
<h2>Question 3.10</h2>
<p>Prove that the algorithm given in Exercise 3.9 generates variates from the density fe.</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<p>Density function <span class="math inline">\(f_{e}(x)=\frac{3}{4}\left(1-x^{2}\right), \quad|x| \leq 1\)</span>, then distribution function is <span class="math inline">\(Fe(x)=-\frac{1}{4} x^3+\frac{3}{4} x+\frac{1}{2}\)</span>.</p>
<p>Define <span class="math display">\[X=
\begin{cases}
U_2, &amp;if |U_3|\text{is max}\left\{|U_1|,|U_2|,|U_3|\right\} \\
U_3, &amp;if |U_3|\text{is max}\left\{|U_1|,|U_2|,|U_3|\right\}
\end{cases}\]</span></p>
<p>Then we need to prove that cumulative distribution function of X is equal to Fe(x) above, that’s to say,$ P(X x)=- x^3+ x+$. The joint density of <span class="math inline">\((U_1,U_2,U_3)\)</span> is <span class="math inline">\(p(u_1,u_2,u_3)= (\frac{1}{2})^3, u_1,u_2,u_3 \in (-1,1)\)</span> First we set <span class="math inline">\(sx\leq 0\)</span> and discuss the case. <span class="math display">\[P(X\leq x)=P(|U_3| \mbox{is max and} U_2 \leq x)+P(|U_3| \mbox{is  not max and} U_3 \leq x)\]</span> <span class="math display">\[P(|U_3| \mbox{is max and} U_2 \leq x)=\iiint_{u_3 \in (-1,1);u_2 \in (-|u_3|,x);u_1 \in (-|u_3|,|u_3|)}   p(u_1,u_2,u_3)\, du_1\,du\,du_3=\iiint_{u_3 \in (-1,x) ;u_2 \in (-|u_3|,x);u_1 \in (-|u_3|,|u_3|)}   p(u_1,u_2,u_3)\, du_1\,du\,du_3+\iiint_{u_3 \in (-x,1) ;u_2 \in (-|u_3|,x);u_1 \in (-|u_3|,|u_3|)}   p(u_1,u_2,u_3)\, du_1\,du\,du_3 =I_1+I_2\]</span> where there <span class="math display">\[I_1=\int_{-1}^{x} \frac{1}{8} \cdot 2|u_3|(x+|u_3|)=\int_{-1}^{x} \frac{1}{8} \cdot (-2u_3)(x-u_3)\]</span>, <span class="math display">\[I_2=\int_{-x}^{1} \frac{1}{8} \cdot 2|u_3|(x+|u_3|)=\int_{-1}^{x} \frac{1}{8} \cdot 2u_3(x+u_3)\]</span>, then calculate <span class="math display">\[I_1+I_2= (-\frac{1}{24}x^3+\frac{1}{8}x+\frac{1}{12})+(-\frac{1}{24}x^3+\frac{1}{8}x+\frac{1}{12})=-\frac{1}{12}x^3+\frac{1}{4}x+\frac{1}{6}\]</span></p>
<p><span class="math inline">\(P(|U_3| \mbox{is not max and} U_3 \leq x)= P(|U_1| \mbox{is max and} U_3 \leq x)+P(|U_2| \mbox{is max and} U_2 \leq x)= P(|U_3| \mbox{is max and} U_2 \leq x)\)</span></p>
<p>then <span class="math inline">\(P(X\leq x)=3\cdot P(|U_3| \mbox{is max and} U_2 \leq x)=-\frac{1}{3}x^3+\frac{3}{4}x+\frac{1}{2}\)</span></p>
<p>So far, we have proved <span class="math inline">\(P(X\leq x)=Fe(x)\)</span> for the case <span class="math inline">\(x\leq 0\)</span>. For <span class="math inline">\(x\geq 0\)</span>, we just need to change the the upper and lower indices in the integral formula and will find the the integral result is the same as above. Now we could say that the algorithm given in Exercise 3.9 generates variates from the density fe.</p>
</div>
<div id="question-3.13" class="section level2">
<h2>Question 3.13</h2>
<p>It can be shown that the mixture in Exercise 3.12 has a Pareto distribution with cdf <span class="math display">\[F(y)=1-(\frac{\beta}{\beta +y})^r,\quad y\geq 0.\]</span> (This is an alternative parameterization of the Pareto cdf given in Exercise 3.3.) Generate 1000 random observations from the mixture with r = 4 and β = 2. Compare the empirical and theoretical (Pareto) distributions by graphing the density histogram of the sample and superimposing the Pareto density curve.</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<p>Suppose that the rate parameter <span class="math inline">\(\Lambda\)</span> has Gamma<span class="math inline">\((r, \beta)\)</span> distribution and Y has Exp(<span class="math inline">\(\Lambda\)</span>) distribution. That is, <span class="math inline">\((Y|\Lambda = \lambda) \sim f_Y(y|\lambda) = \lambda e^{-\lambda y}.\)</span>Now we derive the distribution of Y. Let <span class="math inline">\(p(y,\lambda)\)</span> be the joint density of <span class="math inline">\((Y,\Lambda)\)</span>.<span class="math inline">\(p(y,\lambda)=f_Y(y|\lambda)\cdot f_\Lambda(\lambda)=\lambda e^{-\lambda y}\cdot \frac{\beta ^r}{\Gamma(r)} \cdot \lambda^{r-1}e^{-\beta \lambda}\)</span></p>
<p><span class="math inline">\(F_Y(y)=P(Y\leq y)=\iint_{t \in (0,y);\lambda \in (0,\infty)} p(t,\lambda) \,d\lambda \,dt=\iint_{t \in (0,y);\lambda \in (0,\infty)}\frac{\Gamma (r+1)}{\Gamma (r)}\cdot \frac{\beta^r}{(\beta +t)^r}\cdot [\frac{\lambda}{\Gamma (r+1)}\cdot e^{-\lambda(\beta+t)} \, d\lambda \,dt]=\int_{t \in (0,y)}r\cdot \frac{\beta^r}{(\beta +t)^{r+1}}\,dt\)</span></p>
<p>Thus, the density of Y is <span class="math display">\[f_Y(y)=r\cdot \frac{\beta^r}{(\beta +t)^{r+1}}\]</span> and the distribution function of Y is <span class="math display">\[F(y)=1-(\frac{\beta}{\beta +y})^r,\quad y\geq 0.\]</span></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">set.seed</span>(<span class="dv">33</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a>n&lt;-<span class="dv">10000</span>;r&lt;-<span class="dv">4</span>;beta&lt;-<span class="dv">2</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>x1&lt;-<span class="kw">rgamma</span>(n,r,beta)</span>
<span id="cb6-4"><a href="#cb6-4"></a>x2&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="st"> </span>n){</span>
<span id="cb6-6"><a href="#cb6-6"></a>  x2[i]&lt;-<span class="kw">rexp</span>(<span class="dv">1</span>,x1[i])</span>
<span id="cb6-7"><a href="#cb6-7"></a>}</span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="kw">hist</span>(x2,<span class="dt">prob=</span>T,<span class="dt">main=</span><span class="st">&quot;the empirical and theoretical (Pareto) distributions &quot;</span>)</span>
<span id="cb6-9"><a href="#cb6-9"></a>x3&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="fl">0.01</span>)</span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="kw">lines</span>(x3,r<span class="op">*</span>beta<span class="op">^</span>r<span class="op">/</span>(beta<span class="op">+</span>x3)<span class="op">^</span>(<span class="dv">1</span><span class="op">+</span>r))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="section-2" class="section level1">
<h1>2020-10-13</h1>
<div id="question-5.1" class="section level2">
<h2>Question 5.1</h2>
<p>Compute a Monte Carlo estimate of <span class="math display">\[\int_{0}^{\frac{\pi}{3}} \sin t\, dt\]</span> and compare your estimate with the exact value of the integral.</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a>x&lt;-<span class="kw">runif</span>(<span class="fl">1e4</span>,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span>pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb7-3"><a href="#cb7-3"></a>theta.hat&lt;-<span class="kw">mean</span>(<span class="kw">sin</span>(x)<span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb7-4"><a href="#cb7-4"></a>theta&lt;-<span class="kw">cos</span>(<span class="dv">0</span>)<span class="op">-</span><span class="kw">cos</span>(pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="kw">print</span>(theta.hat);<span class="kw">print</span>(theta)</span></code></pre></div>
<pre><code>## [1] 0.5043115</code></pre>
<pre><code>## [1] 0.5</code></pre>
<p>The Monte Carlo estimate is 0.5043115, and th exact value of the integral is 0.5.</p>
</div>
<div id="question-5.7" class="section level2">
<h2>Question 5.7</h2>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach and by the simple Monte Carlo method. Compute an empirical estimate of the percent reduction in variance using the antithetic variate. Compare the result with the theoretical value from Exercise 5.6.</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">set.seed</span>(<span class="dv">22</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a>m&lt;-<span class="fl">1e4</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>u1&lt;-<span class="kw">runif</span>(m<span class="op">/</span><span class="dv">2</span>,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span><span class="dv">1</span>);u2&lt;-<span class="kw">runif</span>(m<span class="op">/</span><span class="dv">2</span>,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span><span class="dv">1</span>);u3&lt;-<span class="dv">1</span><span class="op">-</span>u1</span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co">##simple MC</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>x1&lt;-<span class="kw">c</span>(u1,u2)</span>
<span id="cb10-6"><a href="#cb10-6"></a>theta.hat1&lt;-<span class="kw">mean</span>(<span class="kw">exp</span>(x1))</span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">##antithetic variate approach</span></span>
<span id="cb10-8"><a href="#cb10-8"></a>x2&lt;-<span class="kw">c</span>(u1,u3)</span>
<span id="cb10-9"><a href="#cb10-9"></a>theta.hat2&lt;-<span class="kw">mean</span>(<span class="kw">exp</span>(x2))</span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="kw">print</span>(theta.hat1);<span class="kw">print</span>(theta.hat2)</span></code></pre></div>
<pre><code>## [1] 1.715508</code></pre>
<pre><code>## [1] 1.716689</code></pre>
<p>The estimate by simple Monte Carlo method is <span class="math inline">\(\hat{\theta}_1\)</span>=1.7155076 and estimate by antithetic variate approach is <span class="math inline">\(\hat{\theta}_2\)</span>=1.7166885.</p>
<p>The empirical estimate of the percent reduction in variance is <span class="math display">\[ 1-\frac{\hat{Var(\hat{\theta}_2)}}{\hat{Var(\hat{\theta}_1)}}\]</span></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>var1&lt;-<span class="kw">var</span>(<span class="kw">exp</span>(x1))<span class="op">/</span>m</span>
<span id="cb13-2"><a href="#cb13-2"></a>var2&lt;-<span class="kw">var</span>((<span class="kw">exp</span>(u1)<span class="op">+</span><span class="kw">exp</span>(<span class="dv">1</span><span class="op">-</span>u1))<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(m<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb13-3"><a href="#cb13-3"></a>redu&lt;-<span class="dv">1</span><span class="op">-</span>var2<span class="op">/</span>var1</span></code></pre></div>
<p>The value of empirical estimate is 0.967616.</p>
<p>Now we compute the percent reduction in variance of <span class="math inline">\(\hat{\theta}\)</span> that can be achieved using antithetic variates(in Exercise 5.6). <span class="math display">\[Cov(e^U,e^{1-U})=E(e)-E(e^U)\cdot E(e^{1-U})=e-E^2(e^U)=e-(e-1)^2\]</span> <span class="math display">\[Var(e^{1-U})=Var(e^U)=E(e^{2U})-E(e^U)^2=\frac{e^2-1}{2}-(e-1)^2\]</span> <span class="math display">\[Var(e^U+e^{1-U})=Var(e^U)+Var(e^{1-U})+2Cov(e^U,e^{1-U})=e^2+2e-1-4(e-1)^2\]</span></p>
<p>Then <span class="math display">\[Var(\hat{\theta}_1)=\frac{1}{m}Var(e^U)\]</span>, <span class="math display">\[Var(\hat{\theta}_2)=\frac{1}{\frac{m}{2}}Var(\frac{e^U+e^{1-U}}{2})=\frac{1}{2m}Var(e^U+e^{1-U})\]</span> and the percent reduction in variance is <span class="math display">\[\frac{Var(\hat{\theta}_1)-Var(\hat{\theta}_2)}{Var(\hat{\theta}_1)}=1-\frac{e^2+2e-1-4(e-1)^2}{e^2-1-2(e-1)^2}\]</span> The value of that is 0.9676701.</p>
</div>
<div id="question-5.11" class="section level2">
<h2>Question 5.11</h2>
<p>If <span class="math inline">\(\hat\theta_1\)</span>and <span class="math inline">\(\hat\theta_2\)</span> are unbiased estimators of <span class="math inline">\(\theta\)</span>, and <span class="math inline">\(\hat\theta_1\)</span> and <span class="math inline">\(\hat\theta_2\)</span> are antithetic, we derived that <span class="math inline">\(c^∗ = \frac{1}{2}\)</span> is the optimal constant that minimizes the variance of <span class="math inline">\(\hat{\theta_c} = c\hat{\theta_1} + (1 − c)\hat{\theta_2}\)</span>. Derive <span class="math inline">\(c^∗\)</span> for the general case. That is, if <span class="math inline">\(\hat\theta_1\)</span> and <span class="math inline">\(\hat\theta_2\)</span> are any two unbiased estimators of <span class="math inline">\(\theta\)</span>, find the value <span class="math inline">\(c^∗\)</span> that minimizes the variance of the estimator <span class="math inline">\(\hat{\theta_c} = c\hat{\theta_1} + (1 − c)\hat{\theta_2}\)</span> in equation (5.11). (<span class="math inline">\(c^∗\)</span> will be a function of the variances and the covariance of the estimators.)</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<p><span class="math display">\[
\begin{equation}
\begin{aligned}
Var(\hat{\theta_c}) &amp;=Var(c\hat{\theta_1} + (1 − c)\hat{\theta_2})\\
&amp;=c^2\cdot Var(\hat\theta_1-\hat\theta_2)+2c\cdot Cov(\hat\theta_1-\hat\theta_2,\hat\theta_2)+Var(\hat\theta_2)\\
\end{aligned}
\end{equation}
\]</span></p>
<p>First for the general case, the variance of <span class="math inline">\(\hat{\theta_c}\)</span> is a quadratic function of c, and it minimizes when <span class="math display">\[c=-\frac{Cov(\hat\theta_1-\hat\theta_2,\hat\theta_2)}{Var(\hat\theta_1-\hat\theta_2)}\]</span>.</p>
<p>Whem <span class="math inline">\(\hat\theta_1\)</span> and <span class="math inline">\(\hat\theta_2\)</span> are antithetic, we can write <span class="math inline">\(\hat\theta_1=\frac{1}{\frac{m}{2}} \sum_{i=1}^{\frac{m}{2}} g(U_i)\)</span>, and <span class="math inline">\(\hat\theta_2=\frac{1}{\frac{m}{2}} \sum_{i=1}^{\frac{m}{2}} g(1-U_i)\)</span>, where <span class="math inline">\(U_1,\ldots,U_{\frac{m}{2}} i.i.d \sim \text{Uniform}(0,1)\)</span>.Now we know that <span class="math inline">\(Var(\hat\theta_1)=Var(\hat\theta_1)\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
-Cov(\hat\theta_1-\hat\theta_2,\hat\theta_2) &amp;=E(\hat\theta_1-\hat\theta_2)\hat\theta_2-E(\hat\theta_1-\hat\theta_2)\cdot E\hat\theta_2 \\
&amp;=-(E\hat\theta_1 \hat\theta_2-E\hat\theta_1 E\hat\theta_2)+(E\hat\theta_2^2-E\hat\theta_2 E\hat\theta_2) \\
&amp;=Var(\hat\theta_2)-Cov(\hat\theta_1, \hat\theta_2)
\end{aligned}
\]</span> <span class="math display">\[
\begin{aligned}
Var(\hat\theta_1-\hat\theta_2) &amp;=Var(\hat\theta_1)+Var(\hat\theta_2)-2Cov(\hat\theta_1, \hat\theta_2)\\
&amp;=2(Var(\hat\theta_2)-Cov(\hat\theta_1, \hat\theta_2))
\end{aligned}
\]</span> So when <span class="math inline">\(\hat\theta_1\)</span> and <span class="math inline">\(\hat\theta_2\)</span> are antithetic, <span class="math inline">\(c^*=\frac{1}{2}\)</span>.</p>
</div>
</div>
<div id="section-3" class="section level1">
<h1>2020-10-20</h1>
<div id="question-5.13" class="section level2">
<h2>Question 5.13</h2>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1, \infty)\)</span> and are ‘close’ to <span class="math display">\[
g(x)=\frac{x^{2}}{\sqrt{2 \pi}} e^{-x^{2} / 2}, \quad x&gt;1
\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[
\int_{1}^{\infty} \frac{x^{2}}{\sqrt{2 \pi}} e^{-x^{2} / 2} d x
\]</span> by importance sampling? Explain.</p>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<p>We take two importance functions <span class="math inline">\(f_1, f_2\)</span> are <span class="math display">\[f_1(x)=e^{1-x}\cdot I(x&gt;1), \quad f_2=\frac{2}{\sqrt{2\pi}}e^{-\frac{(x-1)^2}{2}}\cdot I(x&gt;1)\]</span> The <span class="math inline">\(f_1\)</span> is easy to prove that it is a density supported on <span class="math inline">\((1,\infty)\)</span>, and the <span class="math inline">\(f_2\)</span> is from the pdf of Normal(1,1). The two functions were chosen according to the shape of <span class="math inline">\(g(x)\)</span>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>x1&lt;-<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">6</span>,<span class="fl">0.01</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a>g&lt;-<span class="cf">function</span>(t){</span>
<span id="cb14-3"><a href="#cb14-3"></a>  <span class="kw">return</span>(t<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>t<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb14-4"><a href="#cb14-4"></a>}</span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="kw">plot</span>(x1,<span class="kw">g</span>(x1),<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>),<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;g(x)&quot;</span>,<span class="dt">main=</span><span class="st">&quot;Plot of g, f1 and f2&quot;</span>)</span>
<span id="cb14-6"><a href="#cb14-6"></a>f1&lt;-<span class="cf">function</span>(t){</span>
<span id="cb14-7"><a href="#cb14-7"></a>  <span class="kw">return</span>(<span class="kw">exp</span>(<span class="dv">1</span><span class="op">-</span>t))</span>
<span id="cb14-8"><a href="#cb14-8"></a>}</span>
<span id="cb14-9"><a href="#cb14-9"></a><span class="kw">lines</span>(x1,<span class="kw">f1</span>(x1),<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb14-10"><a href="#cb14-10"></a>f2&lt;-<span class="cf">function</span>(t){</span>
<span id="cb14-11"><a href="#cb14-11"></a>  <span class="kw">return</span>(<span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(t<span class="dv">-1</span>)<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb14-12"><a href="#cb14-12"></a>}</span>
<span id="cb14-13"><a href="#cb14-13"></a><span class="kw">lines</span>(x1,<span class="kw">f2</span>(x1),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb14-14"><a href="#cb14-14"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;g&quot;</span>,<span class="st">&quot;f1&quot;</span>,<span class="st">&quot;f2&quot;</span>),<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>),<span class="dt">lty=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAwFBMVEUAAAAAADoAAGYAAP8AOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kNtmAABmADpmAGZmOgBmOjpmOpBmZmZmkLZmkNtmtttmtv+QOgCQOmaQZgCQZjqQkGaQkLaQttuQ27aQ29uQ2/+2ZgC2Zjq2ZpC2kDq2kGa2tma229u22/+2/7a2///bkDrbkGbbtpDb27bb2//b/9vb////AAD/tmb/25D/27b//7b//9v////961FqAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAK3UlEQVR4nO2da2OkNBhGaWtrR1dXO+qq69a7pd7WRVe7tB3+/7+SJDBDQpInFwKk854vbWdCCKdvAoQkFA1hpVi6AGuHBAFIEIAEAUgQgAQBSBCABAFIEIAEAUgQgAQBSBCABAFIEIAEAUgQgAQBSBCABAFIEIAEAUgQgAQBSBCABAFIEIAEAUgQgAQBSBCABAGmF1QVgo9fN83uuri4k7/e/fpGs9HudlMUn1pyPSQoR1maKIvTN9LWDy+6cnmQTlBxcqMR9PDFqU5QzTa4suTaJ9jdFgGCxNb1pi+XBwkFtQcyFnQotLIRKHaX4J8vihBBVfffOr1p7jfO23NSCOLFeti2heoF/dPG9ntf37Eyt+wVyR/3iliQnN/IJrsErfwT6QC5sI9v+G5PfuEbiiw2xflP+yzE1j+/2Fw2xn+RiWSC+H+tE1T1ESULUj7uBLXbsD+e6QWd/zkMynpfmfeBy34XWRz2JPlfi6C32/anECSiuuJtyKB4w48HVaw96Mu7XVnIxyES/P2pVGvb39/n2fMcivPXXW4ii9tCrmLDvbozRxvUSeE/BoKGHw+OQHz8uNUJasYnxre/P2t18N2+4od/qcnikH37IUvnzgxnsf6QeCkHp97hx4cj6D8uXQTtvhe7uuwTtMd/yZKwxkZtpBlty+gXQOkEnXzSXwfxQjc88F8NCi19LP2LlaPrctUIYm3N+Y9vt4qgcRb91m2AefpJ2EgzEkeQaH0eVUHjLLqtA/zMIShdG1T37c6VJMjUBj16169mHkGG0xU+iw1kmCLo4u7hWm2DxidC8WUZ4GcWQYMLHn7lMr4OGgoaXAchQfvrHUWQuPApFEH3G+VTJ2YRJC6ZX/JPbvn1iuDw8fBWgyV5/rp0EMTPYuc/VYdK2gna/bYp3vtGaYP2p9eFBU2EuGkvL5cux/oElbxbQ1zx3W+8LupSsD5B9eA68/uXS5dmhYKahxeb7jpzDaxQ0LogQQASBCBBABIEIEEAEgQgQQASBCBBABIEIEEAEgQgQQASBCBBABIEIEEAEgQgQQASBPATVJ6+4U9w/QaKZo2XIO7nA/6Ed/EHenPhI+hxe9U/DK78h0lkip+gV83umg/3rr0GAOSMXxVjw0wogsw8btmQFDbO9nhaac/TfL0fsGTITseZ+PFO++VSJBIUlN1Z9/Pd9Fmnz20OQb2hYxJUGc5iVkFxhvISpOZir9okCGU3RR07BkFRhrIQ1A9MNl5HH7mgqp9WWpvml5qym8BQBoK6+zCG6VbjuAUNOjlMN6vHLSgigiYwlIGgtg3qQsi7DToSQXzGFcPY2XHsgiKyizZEgoKzTprb7IKCDT11QdEhdDyCAg3FlLQsipMfpG7iFQsKDSEla58OVfY8ry5WLyiyjoWXVMxbLNcuKDaEwksq7ovqJQU5PSxYTFC1vCC37OLqWNYR5JZdXAjFtkFVBoKiQiiipHmcxZrIOhZ5HXT6h9SFtW5BQYZiS1pnICgqhCLbID64KSC3ZQSFGIooKR9yIY+JW6mgmBB68jerHBIEvo+oY0ciKDyEjkNQRAhFlFSsk9bcf3g40a9XUHAIhZe0O8OzEZb+uc0tKLyZjhHETvG1NOYiA0G+hoJLyuZOnL6pi6s6C0HBIRQbQfLNxho7zDomEnRmRUq6AkFe2QUayjqCvLIjQYh+SKefoeMT5BlCiwvqF3iMmirnJihoVPCygvpFvPlA1oi5YG77DQqhRQU9fj50Iv81orbMWXXcb0gIZXGzWrZ3fffP78xzVv0EeRlaWtDuX5y4ZOuv8+jxHsSpEBBCSwt63IpGaPetsX7xuOGznr2HAatkKKh7slZZmmjRbcBDLTaCAgwtLqibiGF7h9V+lpjyDCVgv92pPitB3JD9Kqh7vl0bk7kfRSfI3dDygtpT1DfjN8ol2q9/HYvscuX14xD3IY0037yOuUz0OgrfOhbX5bq75u9F2E/XDhD0pQgdy1lsgN+cVS2+rVDclXQ3BGZf7BV3mO2ZS5DocuW/HgZRpbzVwNkN/rZp8zMUfy8mBgp55pb0ZnWvRu9IVLJAQe+sSEn3ggaTlBJ1d/jNWR1a0SryCqEJ7uYHS2qkaYO85qyqRoyG5hIkFTqJIL8Zh6OcNYbmFFRJ/9Sg66ACVDKfOau6eIkzFCmokg8rqA0SF4qvjDdaPhGkL8BYETM0h6D7jXxQAf1B16IFaw/duLyU+5xV0/7HgpwNxQnqX00ZeB3USB235gXKXOesmnevNZRYUFRugwgSQcEiKPxCqIB7D65kSws6tEF9ZUu0X50hl16PxQWJ+sPe9Jn4sY+axrGSLS9orv2OTmWtIYcQOh5BGkMuIXREgnSGSJA9mYOhrAV5d5iNDcFWKGtB8fs9OyNBcsKRIRRCRyZIZ2iqrJ12P3nCybPTNEP29NOS4Iimzm6UNnRVjxByEKQxdKZLloQsBI1Sv5vPUCaCRoaas5kU5SFoQUOZCNJUspkM5SJoMUPZCBobapo5FOUjaCFDGQkaj0po+GywKYrjvNMJEqbLTj2VievpxIZyEmQwlFbR2jvM1M3lv/eG0inKKoLG2/V3rekU5SbIZCiZovwEyVsOej7SKMpOkKpo2DeUQlGGgkZBNPxjckc5CrJUs0YsJBCTubqvyRNyQt/M4loYczVjTKkojaDwN7M4F8dqaMI4SiIo5r0aziBFzXhtjqDdTJ6wiXoziwdyPVNHzQviJeUbQY2bon75l+B9TJ6QEfFmFj/cFDURlhKdxcLfzOKLfOM7mp8io1s0COU/ecL5s/NyxDCsr6TP3LkUrgkXya6RulA0M530mBejOmTsXALXhDITTMl0Ru5q0s4Is6FfviuvDjPfnbTY59PhyXZPpYolgwQB8rxZnZFcb1ZnY7FbjWxIIcjhZtUtU/B93Nexm0ckd4ggt0yfqiCHm1W3TJ+sIHyz6pbp0xU0UaYkKO57EkSC4r4nQUcv6ClBggAkCECCACQIQIIAJAhAggAkCECCACQIQIIAJAiQQtDwZYsjlJXBR1SW15oISkuHr+gTNq/BxpZO9luhLYEg6WWLKurK4Cps2EhtNVTbesTFSy3M217c7d+P4cj0gmrLk+lmtDK4Al8F1LoMXxsjFkH253XiuZXfKoiTC1JetmhIZI0Rq6Dq4juLoMoaHSC+tKRog7Ag+0qElUVfe4y2Nqj8yNbC1ad/be1vDhmziCDrc8fadgisklgEPW7Zd6Vpe/7aGc91NJcQVIMTye7aqIA98rZFkH3/IjRxgA9ZQBB4bt1YmijeiEBB4kSgQTTPxq+1zC+owo2A+Qi7sSv2IzS2xaJgfk317IIq69EJNXbDlggCm3cvfV51FVNXBldhRz8YZmNKYvyOtW7GRpo3YSB3lbkFqSuDjyhhDbK2QWDz2n6fo4FuVgEkCECCACQIQIIAJAhAggAkCECCACQIQIIAJAhAggAkCECCACQIQIIAJAhAggAkCECCACQIQIIAJAhAggAkCECCACQIQIIAJAiwdkFs1BwfPL0UaxfEhjvZFytKzNoFsbHNn/kP/56O1QtqSs/ZJxOzfkE1GJGXmNUL2l1/5TUqdWpWL6i6+M9vWOrErF0QG9rsN7B5YtYuSIybXrCZXrugxSFBABIEIEEAEgQgQQASBCBBABIEIEEAEgQgQQASBCBBABIEIEEAEgQgQQASBCBBABIEIEEAEgQgQYD/AZ6dKA9aUWGAAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="kw">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb15-3"><a href="#cb15-3"></a>theta.hat &lt;-<span class="st"> </span>se &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="co">## f1=Exp distribution, inverse transform method</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>u&lt;-<span class="kw">runif</span>(m)</span>
<span id="cb15-6"><a href="#cb15-6"></a>x&lt;-<span class="dv">1</span><span class="op">-</span><span class="kw">log</span>(u)</span>
<span id="cb15-7"><a href="#cb15-7"></a>fg&lt;-<span class="kw">g</span>(x)<span class="op">/</span><span class="kw">f1</span>(x)</span>
<span id="cb15-8"><a href="#cb15-8"></a>theta.hat[<span class="dv">1</span>]&lt;-<span class="kw">mean</span>(fg)</span>
<span id="cb15-9"><a href="#cb15-9"></a>se[<span class="dv">1</span>]&lt;-<span class="kw">round</span>(<span class="kw">var</span>(fg),<span class="dv">4</span>)</span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="co">## f2 is half of normal distribution</span></span>
<span id="cb15-11"><a href="#cb15-11"></a>v&lt;-<span class="kw">rnorm</span>(m,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb15-12"><a href="#cb15-12"></a>y&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb15-13"><a href="#cb15-13"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb15-14"><a href="#cb15-14"></a>  y[i]&lt;-v[i]<span class="op">*</span>(v[i]<span class="op">&gt;=</span><span class="dv">1</span>)<span class="op">+</span>(<span class="dv">2</span><span class="op">-</span>v[i])<span class="op">*</span>(v[i]<span class="op">&lt;</span><span class="dv">1</span>)</span>
<span id="cb15-15"><a href="#cb15-15"></a>}</span>
<span id="cb15-16"><a href="#cb15-16"></a>fg&lt;-<span class="kw">g</span>(y)<span class="op">/</span><span class="kw">f2</span>(y)</span>
<span id="cb15-17"><a href="#cb15-17"></a>theta.hat[<span class="dv">2</span>]&lt;-<span class="kw">mean</span>(fg)</span>
<span id="cb15-18"><a href="#cb15-18"></a>se[<span class="dv">2</span>]&lt;-<span class="kw">round</span>(<span class="kw">var</span>(fg),<span class="dv">4</span>)</span>
<span id="cb15-19"><a href="#cb15-19"></a><span class="kw">print</span>(theta.hat)</span></code></pre></div>
<pre><code>## [1] 0.3982314 0.4017276</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">print</span>(se)</span></code></pre></div>
<pre><code>## [1] 0.0253 0.0019</code></pre>
<p>We could see that the variance of <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> is0.0253and0.0019,and <span class="math inline">\(f_2=\frac{2}{\sqrt{2\pi}}e^{-\frac{(x-1)^2}{2}}\cdot I(x&gt;1)\)</span> produce smaller variance.</p>
</div>
<div id="question-5.15" class="section level2">
<h2>Question 5.15</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
</div>
<div id="answer-11" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>g&lt;-<span class="cf">function</span>(x){</span>
<span id="cb19-2"><a href="#cb19-2"></a>  <span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb19-3"><a href="#cb19-3"></a>}</span>
<span id="cb19-4"><a href="#cb19-4"></a>theta_I&lt;-<span class="fl">0.5257801</span></span>
<span id="cb19-5"><a href="#cb19-5"></a>se_I&lt;-<span class="st"> </span><span class="fl">0.0970314</span></span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="kw">set.seed</span>(<span class="dv">222</span>)</span>
<span id="cb19-7"><a href="#cb19-7"></a>m&lt;-<span class="dv">10000</span></span>
<span id="cb19-8"><a href="#cb19-8"></a>theta.hat&lt;-se.hat&lt;-<span class="kw">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb19-9"><a href="#cb19-9"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>){</span>
<span id="cb19-10"><a href="#cb19-10"></a>  u&lt;-<span class="kw">runif</span>(m<span class="op">/</span><span class="dv">5</span>,(j<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>,j<span class="op">/</span><span class="dv">5</span>)</span>
<span id="cb19-11"><a href="#cb19-11"></a>  temp&lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span>(j<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">-</span>(u<span class="op">*</span>(<span class="kw">exp</span>(<span class="op">-</span>(j<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>j<span class="op">/</span><span class="dv">5</span>))))</span>
<span id="cb19-12"><a href="#cb19-12"></a>  theta.hat[j]&lt;-<span class="kw">mean</span>(<span class="kw">g</span>(temp)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>temp)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>(j<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>j<span class="op">/</span><span class="dv">5</span>))))</span>
<span id="cb19-13"><a href="#cb19-13"></a>  se.hat[j]&lt;-<span class="kw">var</span>(<span class="kw">g</span>(temp)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>temp)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>(j<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>j<span class="op">/</span><span class="dv">5</span>))))<span class="op">*</span>(m<span class="op">/</span><span class="dv">5-1</span>)</span>
<span id="cb19-14"><a href="#cb19-14"></a>}</span>
<span id="cb19-15"><a href="#cb19-15"></a><span class="co">##print(theta.hat)</span></span>
<span id="cb19-16"><a href="#cb19-16"></a>theta_hat&lt;-<span class="kw">sum</span>(theta.hat)</span>
<span id="cb19-17"><a href="#cb19-17"></a>se_hat&lt;-<span class="kw">sum</span>(se.hat)</span>
<span id="cb19-18"><a href="#cb19-18"></a><span class="kw">print</span>(<span class="kw">c</span>(theta_hat,<span class="kw">sqrt</span>(se_hat)))</span></code></pre></div>
<pre><code>## [1] 0.52426827 0.06567511</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw">print</span>(<span class="kw">c</span>(theta_I,se_I))</span></code></pre></div>
<pre><code>## [1] 0.5257801 0.0970314</code></pre>
<p>The stratified importance sampling estimate of <span class="math inline">\(\theta\)</span> is 0.5242683 and an estimated standard error is 0.0656751.In example 5.10 we obtained the estimate <span class="math inline">\(\hat{\theta}\)</span>=0.5257801 and an estimated standard error 0.0970314.The stratified importance sampling method has a standard error reduction of 32.3156152%.</p>
</div>
<div id="question-6.4" class="section level2">
<h2>Question 6.4</h2>
<p>Suppose that <span class="math inline">\(X_1,\ldots,X_n\)</span> are a random sample from a lognormal distribution with unknown parameters. Construct a 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain an empirical estimate of the confidence level.</p>
</div>
<div id="answer-12" class="section level2">
<h2>Answer</h2>
<p>Define <span class="math inline">\(Y_i=log(X_i)\)</span>, then <span class="math inline">\(Y_1,\ldots,Y_n\)</span> are a random sample from a lognormal distribution. Let <span class="math inline">\(Y_i \sim N(\mu,\sigma^2)\)</span>, and we make inference about <span class="math inline">\(\mu\)</span>.</p>
<p>It can be obtained from the normal distribution that, <span class="math display">\[\frac{\sqrt{n}(\bar{Y}-\mu)}{\hat{\sigma}}\sim t_{n-1}\]</span> where <span class="math display">\[\bar{Y}=\frac{Y_1+\ldots+Y_n}{n}, \hat{\sigma}^2=\frac{1}{n-1}\sum_{i=1}^{n}(Y_i-\bar{Y})^2\]</span> A 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span> is <span class="math inline">\(\bar{Y}\pm\hat{\sigma}\cdot t_{n-1}(0.025)\)</span>, where <span class="math inline">\(P(t_{n-1}&gt;t_{n-1}(\alpha))=\alpha\)</span>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>mu&lt;-<span class="dv">0</span>;sigma2&lt;-<span class="dv">1</span><span class="op">^</span><span class="dv">2</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>m&lt;-<span class="fl">1e4</span>;n&lt;-<span class="dv">20</span></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="kw">set.seed</span>(<span class="dv">333</span>)</span>
<span id="cb23-4"><a href="#cb23-4"></a>ybar&lt;-sigmahat&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb23-6"><a href="#cb23-6"></a>  y&lt;-<span class="kw">rnorm</span>(n,mu,sigma2)</span>
<span id="cb23-7"><a href="#cb23-7"></a>  ybar[i]&lt;-<span class="kw">mean</span>(y)</span>
<span id="cb23-8"><a href="#cb23-8"></a>  sigmahat[i]&lt;-<span class="kw">sd</span>(y)</span>
<span id="cb23-9"><a href="#cb23-9"></a>}</span>
<span id="cb23-10"><a href="#cb23-10"></a>y_bar&lt;-<span class="kw">mean</span>(ybar)</span>
<span id="cb23-11"><a href="#cb23-11"></a>sigma_hat&lt;-<span class="kw">mean</span>(sigmahat)</span>
<span id="cb23-12"><a href="#cb23-12"></a><span class="co">##print(c(y_bar,sigma_hat))</span></span></code></pre></div>
<p>When <span class="math inline">\(log(X)\)</span> is from the specific distribution<span class="math inline">\(N(0,1^2)\)</span>, a 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span> is -0.0014342 <span class="math inline">\(\pm\)</span> 0.4619359.</p>
</div>
<div id="question-6.5" class="section level2">
<h2>Question 6.5</h2>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^{2}(2)\)</span> data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
</div>
<div id="answer-13" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>cp_<span class="dv">1</span>&lt;-<span class="dv">0</span></span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb24-3"><a href="#cb24-3"></a>  <span class="cf">if</span>(mu<span class="op">&gt;</span>ybar[i]<span class="op">-</span><span class="kw">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>)<span class="op">*</span>sigmahat[i]<span class="op">/</span><span class="kw">sqrt</span>(n)<span class="op">&amp;&amp;</span>mu<span class="op">&lt;</span>ybar[i]<span class="op">+</span><span class="kw">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>)<span class="op">*</span>sigmahat[i]<span class="op">/</span><span class="kw">sqrt</span>(n)) cp_<span class="dv">1</span>&lt;-cp_<span class="dv">1</span><span class="op">+</span><span class="dv">1</span></span>
<span id="cb24-4"><a href="#cb24-4"></a>}</span>
<span id="cb24-5"><a href="#cb24-5"></a>cp_<span class="dv">1</span>&lt;-cp_<span class="dv">1</span><span class="op">/</span>m</span>
<span id="cb24-6"><a href="#cb24-6"></a>cp_<span class="dv">1</span></span></code></pre></div>
<pre><code>## [1] 0.9529</code></pre>
<p>First we could see that estimation of the coverage probability of the t-interval for random samples of example 6.4 is 0.9529, which is close to the true coverage probability 0.95.</p>
<p>Now we generate <span class="math inline">\(\chi^2(2)\)</span> data <span class="math inline">\(Y_1,\ldots,Y_n\)</span> and construct the 95% CP(t-interval), which has the same form of <span class="math inline">\(\bar{Y}\pm\hat{\sigma}\cdot t_{n-1}(0.025)\)</span></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>m&lt;-<span class="fl">1e4</span>;n&lt;-<span class="dv">20</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>mean&lt;-<span class="dv">2</span><span class="co">##mean is equal to df</span></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="kw">set.seed</span>(<span class="dv">444</span>)</span>
<span id="cb26-4"><a href="#cb26-4"></a>ybar&lt;-sigmahat&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb26-6"><a href="#cb26-6"></a>  y&lt;-<span class="kw">rchisq</span>(n,<span class="dv">2</span>)</span>
<span id="cb26-7"><a href="#cb26-7"></a>  ybar[i]&lt;-<span class="kw">mean</span>(y)</span>
<span id="cb26-8"><a href="#cb26-8"></a>  sigmahat[i]&lt;-<span class="kw">sd</span>(y)</span>
<span id="cb26-9"><a href="#cb26-9"></a>}</span>
<span id="cb26-10"><a href="#cb26-10"></a>y_bar&lt;-<span class="kw">mean</span>(ybar)</span>
<span id="cb26-11"><a href="#cb26-11"></a>sigma_hat&lt;-<span class="kw">mean</span>(sigmahat)</span>
<span id="cb26-12"><a href="#cb26-12"></a><span class="co">##print(c(y_bar,sigma_hat))</span></span></code></pre></div>
<p>Then a 95% confidence t-interval for the mean is 1.9990663 <span class="math inline">\(\pm\)</span> 0.8969018.</p>
<p>Here we calculate the coverage probability of the t-interval above.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>cp_<span class="dv">2</span>&lt;-<span class="dv">0</span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb27-3"><a href="#cb27-3"></a>  <span class="cf">if</span>(mean<span class="op">&gt;</span>ybar[i]<span class="op">-</span><span class="kw">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>)<span class="op">*</span>sigmahat[i]<span class="op">/</span><span class="kw">sqrt</span>(n)<span class="op">&amp;&amp;</span>mean<span class="op">&lt;</span>ybar[i]<span class="op">+</span><span class="kw">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>)<span class="op">*</span>sigmahat[i]<span class="op">/</span><span class="kw">sqrt</span>(n)) cp_<span class="dv">2</span>&lt;-cp_<span class="dv">2</span><span class="op">+</span><span class="dv">1</span></span>
<span id="cb27-4"><a href="#cb27-4"></a>}</span>
<span id="cb27-5"><a href="#cb27-5"></a>cp_<span class="dv">2</span>&lt;-cp_<span class="dv">2</span><span class="op">/</span>m</span>
<span id="cb27-6"><a href="#cb27-6"></a>cp_<span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] 0.9189</code></pre>
<p>we could see that estimation of the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> is 0.9189, which is smaller than 0.95.</p>
</div>
</div>
<div id="section-4" class="section level1">
<h1>2020-10-27</h1>
<div id="question-6.7" class="section level2">
<h2>Question 6.7</h2>
<p>Estimate the power of the skewness test of normality against symmetric Beta(<span class="math inline">\(\alpha, \alpha\)</span>) distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(\nu)\)</span>?</p>
</div>
<div id="answer-14" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="co">#computes the sample skewness coeff.</span></span>
<span id="cb29-3"><a href="#cb29-3"></a>xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb29-4"><a href="#cb29-4"></a>m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb29-5"><a href="#cb29-5"></a>m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb29-6"><a href="#cb29-6"></a><span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</span>
<span id="cb29-7"><a href="#cb29-7"></a>}</span>
<span id="cb29-8"><a href="#cb29-8"></a><span class="kw">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb29-9"><a href="#cb29-9"></a>level&lt;-<span class="fl">0.05</span></span>
<span id="cb29-10"><a href="#cb29-10"></a>n &lt;-<span class="st"> </span><span class="dv">50</span></span>
<span id="cb29-11"><a href="#cb29-11"></a>m &lt;-<span class="st"> </span><span class="dv">2500</span></span>
<span id="cb29-12"><a href="#cb29-12"></a>para1&lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.5</span>,<span class="dv">10</span>,<span class="fl">0.5</span>)</span>
<span id="cb29-13"><a href="#cb29-13"></a>para2&lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">40</span></span>
<span id="cb29-14"><a href="#cb29-14"></a>power&lt;-<span class="cf">function</span>(para,<span class="dt">level=</span><span class="fl">0.05</span>,<span class="dt">n=</span><span class="dv">50</span>,<span class="dt">m=</span><span class="dv">2500</span>){</span>
<span id="cb29-15"><a href="#cb29-15"></a>  N &lt;-<span class="st"> </span><span class="kw">length</span>(para)</span>
<span id="cb29-16"><a href="#cb29-16"></a>  pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb29-17"><a href="#cb29-17"></a><span class="co">#critical value for the skewness test</span></span>
<span id="cb29-18"><a href="#cb29-18"></a>cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>level<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</span>
<span id="cb29-19"><a href="#cb29-19"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</span>
<span id="cb29-20"><a href="#cb29-20"></a>  e &lt;-<span class="st"> </span>para[j]</span>
<span id="cb29-21"><a href="#cb29-21"></a>  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb29-22"><a href="#cb29-22"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb29-23"><a href="#cb29-23"></a>    x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n, para[j],para[j])</span>
<span id="cb29-24"><a href="#cb29-24"></a>    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb29-25"><a href="#cb29-25"></a>  }</span>
<span id="cb29-26"><a href="#cb29-26"></a>  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb29-27"><a href="#cb29-27"></a>}</span>
<span id="cb29-28"><a href="#cb29-28"></a><span class="kw">return</span>(pwr)</span>
<span id="cb29-29"><a href="#cb29-29"></a>}</span>
<span id="cb29-30"><a href="#cb29-30"></a><span class="co">#plot power vs epsilon</span></span>
<span id="cb29-31"><a href="#cb29-31"></a>pwr1&lt;-<span class="kw">power</span>(para1)</span>
<span id="cb29-32"><a href="#cb29-32"></a>pwr2&lt;-<span class="kw">power</span>(para2)</span>
<span id="cb29-33"><a href="#cb29-33"></a><span class="kw">plot</span>(para1, pwr1, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">xlab =</span> <span class="kw">bquote</span>(alpha), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.1</span>))</span>
<span id="cb29-34"><a href="#cb29-34"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.05</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAbFBMVEUAAAAAADoAAGYAOpAAZpAAZrY6AAA6ADo6AGY6ZpA6kNtmAABmADpmZmZmZrZmtv+QOgCQOjqQZgCQZmaQ29uQ2/+2ZgC2Zjq22/+2/7a2///bkDrb////tmb/tpD/25D/27b//7b//9v////Emdc2AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAGzklEQVR4nO2dCXejNhRGyeyNp427jNuGoYnt//8fy+INbL0rg4SU8N1zMvEQHQmun1Z0oNgLkyL1CeSOBAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEFAYEHFmyGVoLDZxUOCAAkCZhZ0f9VOjSIIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJArRoDyiCAAkCJAiQIECCAAkCIgnafHjev3wpiocfQbJLSBxBrZ+vtZzt6ilAdimJImi7eqwlfW4+lh9/Ts4uKZEEPe1368fmY1XH0tTskhKpitXRUyqC3GxXH57bEKpcrfTCBdVmuinp50DZpUPjIECCgEiCduuuijn6sPcraLs6L3k5L77uu4rH7kN1/DC63NTcG0G7teHlyGEM1LC8bn63dvZMJy4mGAscKFaFY3p1ZtER5EV5lDhsg7Rof+DYmDvi511H0EX9maPc1NwvyLnEE6fc1IyoYq6O6Sbl8nqx01jxHk/jy02N5mKABAGjqhiPpRc7WW04NELOOzr7RU9WTzSrqq60PlON4u38jBDUBJERQcuerLZ3TO0uftmTVatuHXFOVu8vNzVjqlgdQtSPLXmy2lIWvCoUptzUROnFQpabmhGCNpqLmQnr5sUaI4YuNzWaiwFjBLVdlLN/snNZwpp0t2OjnFbP3rGg3brr4DfjYujeclMzopH+3oXOXSuv48tNzfgIcs2yApebmjFtUDuILqcNpd+xIM8NHqHKTY3GQYAEARIESBAgQYAEHbiaHh4OSFBHsR+cU3HrIOUQ+IQyojj/20XO6YAEtZwFHX4kqM/ARyFBw0a53+QUaoNO134U1eu0iuEBzxwDn+Cs9EVcBUrvxIrB//0KmHqGUbPzKu9GG3zRe51SXtc97xKmM/ui/aDmuH4bGXiXNOr85sruOv+zmMsqNaxaixV0ezRzGTEDg2ZO3kUGJK6gGz72w3A6JoXavhRBw+78zqxCJkySnXcvfn/GwRO2zL0N+FYt6gXOpJzDJmyItg3Ycb3ONng6UQRF28TpqjH+w5pRRYZNuI+3Dfg6QBzjwIC8qQi6anvPTc3wQDBitUFRtgEbE4WxvbhnmSETtoTeBtwf90asUdclB08YMrtTXOx7gbI8QUbv3Rv33frDDLO6sAlb/AaKjgC5OR7un0G0Juf2iQZN2OA3ULwKkMFBQ9B8JOzmr67f3UnNUJVcJBwooqDL8Eq2bziHCHL33hnsp555oNhbk74KkBk7J2+SDhRdOypyiJwjeYyDMkaCgNiCFvhwk0DlvhkSCZpaWg4JJiWfSA7XH1UQTlanlpZDggnJebI6tbQcEoxP7jHVmFpaDgnGJ/eYrE4tLYcE45Mrggi+qzG1tBwSTEmOk9WppeWQYFLy5SFBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIEDCfoHY9m1ZJ7AeENc/jNZ+mWhbmo0RfvrXLfJX91Ow+swnareuTKuFpsZW5kFLVf9yujByaJ9QZr+A5PGW0eZqd8x2EV8wm6OVL+4Arc6l2u7IEdQuaRg7dC5w2LoNVdzemy8aZasjMbZD9zZUf/zAEta/AtbAFVcVju5Lu801dMLOgjXVetQGrDao+/LuyWzGoYt2ths6z912HeQWZa9lN7FuCyqaG2O9Bg+a3tdIFsXcjNKugymyjmzslpqAH+uq7d3W7v4PcBdn3QtrQNwW1arom5HYO1LpkXsVKexRUHvalOK+/uyajqcbYyLuR9nqEpRVB3Y1d46vvLt1IUOXczVttwxlzJN00UuZ74rzaoFwHiocaBCdmTzUqmqxs7ASH4CqznGq8VSQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCAgc0G7v4uHp4nvn55G5oJqNa+//2XtKotN3oLabYnbX2mLfUzyFtRtabX35UUmc0HfnvewuT42eQvafv/huz82FnkL2m8+/Xxdf/rzn9ffUp1B5oLqbr745ed/X/y37YYmc0HpkSBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAv4Hj/V1nRf4wXgAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="kw">plot</span>(para2, pwr2, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">xlab =</span> <span class="kw">bquote</span>(alpha), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.1</span>))</span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.05</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We use the sample coefficient of skewness <span class="math inline">\(\sqrt(b_1)\)</span> to test the the skewness of symmetric Beta(<span class="math inline">\(\alpha, \alpha\)</span>) distribution.<span class="math inline">\(\alpha\)</span> is evaluated in a small range (0.5,10) and a large range (1,40) and we obtain the variation of powers with <span class="math inline">\(\alpha\)</span> respectively.</p>
<p>The results are the plots of powers with differernt <span class="math inline">\(\alpha\)</span> above. As you can see from the plot, the power increases with <span class="math inline">\(\alpha\)</span> and finally stabilizes around the significant level of 0.05. For any <span class="math inline">\(\alpha\)</span>, the rejection rate of null hypothesis is smaller than 0.05, so we could believe that skewness of Beta(<span class="math inline">\(\alpha, \alpha\)</span>) distribution is small.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb31-2"><a href="#cb31-2"></a>power_stu&lt;-<span class="cf">function</span>(para,<span class="dt">level=</span><span class="fl">0.05</span>,<span class="dt">n=</span><span class="dv">50</span>,<span class="dt">m=</span><span class="dv">2500</span>){</span>
<span id="cb31-3"><a href="#cb31-3"></a>   N &lt;-<span class="st"> </span><span class="kw">length</span>(para)</span>
<span id="cb31-4"><a href="#cb31-4"></a>   pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb31-5"><a href="#cb31-5"></a><span class="co">#critical value for the skewness test</span></span>
<span id="cb31-6"><a href="#cb31-6"></a>cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>level<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</span>
<span id="cb31-7"><a href="#cb31-7"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</span>
<span id="cb31-8"><a href="#cb31-8"></a>  e &lt;-<span class="st"> </span>para[j]</span>
<span id="cb31-9"><a href="#cb31-9"></a>  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb31-10"><a href="#cb31-10"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb31-11"><a href="#cb31-11"></a>    x &lt;-<span class="st"> </span><span class="kw">rt</span>(n, para[j])</span>
<span id="cb31-12"><a href="#cb31-12"></a>    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb31-13"><a href="#cb31-13"></a>  }</span>
<span id="cb31-14"><a href="#cb31-14"></a>  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb31-15"><a href="#cb31-15"></a>}</span>
<span id="cb31-16"><a href="#cb31-16"></a><span class="kw">return</span>(pwr)</span>
<span id="cb31-17"><a href="#cb31-17"></a>}</span>
<span id="cb31-18"><a href="#cb31-18"></a>nu&lt;-<span class="kw">seq</span>(<span class="fl">0.5</span>,<span class="dv">20</span>,<span class="fl">0.5</span>)</span>
<span id="cb31-19"><a href="#cb31-19"></a>pwr&lt;-<span class="kw">power_stu</span>(nu)</span>
<span id="cb31-20"><a href="#cb31-20"></a><span class="kw">plot</span>(nu, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">xlab =</span> <span class="kw">bquote</span>(nu), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb31-21"><a href="#cb31-21"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.05</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="co">#print(power_stu(50:60))</span></span></code></pre></div>
<p>The results are the plots of powers of skewness test of normality against t-distribution with differernt <span class="math inline">\(\nu\)</span> above. Power decreases with degrees of freedom <span class="math inline">\(\nu\)</span>, and is close to 1.0 when <span class="math inline">\(\nu\)</span> is samll and finally stabilizes around the significant level of 0.05 when <span class="math inline">\(\nu\)</span> is large. This means that the t distribution approximates the normal distribution as the degree of freedom increases</p>
</div>
<div id="question-6.8" class="section level2">
<h2>Question 6.8</h2>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the F test of equal variance, at significance level <span class="math inline">\(\hat{\alpha}\)</span>= 0.055. Compare the power of the Count Five test and F test for small, medium, and large sample sizes. (Recall that the F test is not applicable for non-normal distributions.)</p>
</div>
<div id="answer-15" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="kw">set.seed</span>(<span class="dv">21</span>)</span>
<span id="cb33-2"><a href="#cb33-2"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb33-3"><a href="#cb33-3"></a>  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb33-4"><a href="#cb33-4"></a>  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb33-5"><a href="#cb33-5"></a>  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb33-6"><a href="#cb33-6"></a>  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb33-7"><a href="#cb33-7"></a>  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb33-8"><a href="#cb33-8"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb33-9"><a href="#cb33-9"></a>}</span>
<span id="cb33-10"><a href="#cb33-10"></a>ftest&lt;-<span class="cf">function</span>(x,y,<span class="dt">level=</span><span class="fl">0.055</span>,<span class="dt">n=</span><span class="dv">20</span>){</span>
<span id="cb33-11"><a href="#cb33-11"></a>  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb33-12"><a href="#cb33-12"></a>  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb33-13"><a href="#cb33-13"></a>  t&lt;-<span class="dv">1</span></span>
<span id="cb33-14"><a href="#cb33-14"></a>  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb33-15"><a href="#cb33-15"></a>  <span class="cf">if</span>(<span class="kw">var</span>(X)<span class="op">/</span><span class="kw">var</span>(Y)<span class="op">&lt;</span><span class="kw">qf</span>(<span class="dv">1</span><span class="op">-</span>level<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>,n<span class="dv">-1</span>)<span class="op">&amp;&amp;</span><span class="kw">var</span>(X)<span class="op">/</span><span class="kw">var</span>(Y)<span class="op">&gt;</span><span class="kw">qf</span>(level<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>,n<span class="dv">-1</span>)){t&lt;-<span class="dv">0</span>}</span>
<span id="cb33-16"><a href="#cb33-16"></a>  <span class="kw">return</span>(t)</span>
<span id="cb33-17"><a href="#cb33-17"></a>}</span>
<span id="cb33-18"><a href="#cb33-18"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb33-19"><a href="#cb33-19"></a>mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb33-20"><a href="#cb33-20"></a>sigma1 &lt;-<span class="dv">1</span></span>
<span id="cb33-21"><a href="#cb33-21"></a>sigma2 &lt;-<span class="fl">1.5</span></span>
<span id="cb33-22"><a href="#cb33-22"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb33-23"><a href="#cb33-23"></a>counttest&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb33-24"><a href="#cb33-24"></a>Ftest&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb33-25"><a href="#cb33-25"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb33-26"><a href="#cb33-26"></a>  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, sigma1)</span>
<span id="cb33-27"><a href="#cb33-27"></a>  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, sigma2)</span>
<span id="cb33-28"><a href="#cb33-28"></a>  counttest[i]&lt;-<span class="kw">count5test</span>(x, y)</span>
<span id="cb33-29"><a href="#cb33-29"></a>  Ftest[i]&lt;-<span class="kw">ftest</span>(x,y)</span>
<span id="cb33-30"><a href="#cb33-30"></a>}</span>
<span id="cb33-31"><a href="#cb33-31"></a>power_count &lt;-<span class="st"> </span><span class="kw">mean</span>(counttest)</span>
<span id="cb33-32"><a href="#cb33-32"></a>power_F&lt;-<span class="kw">mean</span>(Ftest)</span>
<span id="cb33-33"><a href="#cb33-33"></a><span class="kw">print</span>(power_count)</span></code></pre></div>
<pre><code>## [1] 0.318</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="kw">print</span>(power_F)</span></code></pre></div>
<pre><code>## [1] 0.4189</code></pre>
<p>First we repeat the simulation of example 6.16, and calculate the results of Count Five test and F test equal variance. The powers are 0.318 and 0.4189 respectively.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="kw">set.seed</span>(<span class="dv">21</span>)</span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="co">#change the sample size</span></span>
<span id="cb37-3"><a href="#cb37-3"></a>n&lt;-<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">500</span>)</span>
<span id="cb37-4"><a href="#cb37-4"></a>N&lt;-<span class="kw">length</span>(n)</span>
<span id="cb37-5"><a href="#cb37-5"></a>power_count&lt;-<span class="kw">numeric</span>(N)</span>
<span id="cb37-6"><a href="#cb37-6"></a>power_F&lt;-<span class="kw">numeric</span>(N)</span>
<span id="cb37-7"><a href="#cb37-7"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="st"> </span>N){</span>
<span id="cb37-8"><a href="#cb37-8"></a>  counttest&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb37-9"><a href="#cb37-9"></a>  Ftest&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb37-10"><a href="#cb37-10"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb37-11"><a href="#cb37-11"></a>  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[j], <span class="dv">0</span>, sigma1)</span>
<span id="cb37-12"><a href="#cb37-12"></a>  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[j], <span class="dv">0</span>, sigma2)</span>
<span id="cb37-13"><a href="#cb37-13"></a>  counttest[i]&lt;-<span class="kw">count5test</span>(x, y)</span>
<span id="cb37-14"><a href="#cb37-14"></a>  Ftest[i]&lt;-<span class="kw">ftest</span>(x,y,<span class="dt">level=</span><span class="fl">0.055</span>,<span class="dt">n=</span>n[j])</span>
<span id="cb37-15"><a href="#cb37-15"></a>  }</span>
<span id="cb37-16"><a href="#cb37-16"></a>  power_count[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(counttest)</span>
<span id="cb37-17"><a href="#cb37-17"></a>  power_F[j]&lt;-<span class="kw">mean</span>(Ftest)</span>
<span id="cb37-18"><a href="#cb37-18"></a>}</span>
<span id="cb37-19"><a href="#cb37-19"></a><span class="kw">print</span>(power_count)</span></code></pre></div>
<pre><code>## [1] 0.1077 0.3179 0.4726 0.6537 0.8491 0.9914</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="kw">print</span>(power_F)</span></code></pre></div>
<pre><code>## [1] 0.2179 0.4187 0.5891 0.8145 0.9807 1.0000</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="kw">plot</span>(n,power_count,<span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;size of sample&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="kw">lines</span>(n,power_F,<span class="dt">lty=</span><span class="dv">3</span>,<span class="dt">type =</span> <span class="st">&quot;b&quot;</span>)</span>
<span id="cb41-3"><a href="#cb41-3"></a><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;CountFive test&quot;</span>,<span class="st">&quot;F test&quot;</span>),<span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Then we compare the power of the Count Five test and F test for small, medium, and large sample sizes. The n values we picked here are {10,20,30}, {50,100},{100} respectively representing small, medium, and large sample size. According to the result plot, the power of F test is always larger than Count Five test. Similarly, they both go up as the sample size goes up, and they approach 1.</p>
</div>
<div id="question-6.c" class="section level2">
<h2>Question 6.C</h2>
<p>Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If X and Y are iid, the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span> is defined by Mardia as <span class="math display">\[
\beta_{1, d}=E\left[(X-\mu)^{T} \Sigma^{-1}(Y-\mu)\right]^{3}
\]</span> Under normality, <span class="math inline">\(\beta_{1,d}=0\)</span> The multivariate skewness statistic is <span class="math display">\[
b_{1, d}=\frac{1}{n^{2}} \sum_{i, j=1}^{n}\left(\left(X_{i}-\bar{X}\right)^{T} \widehat{\Sigma}^{-1}\left(X_{j}-\bar{X}\right)\right)^{3}
\]</span> where <span class="math inline">\(\hat{\Sigma}\)</span> is the maximum likelihood estimator of covariance. Large values of ˆ b1,d are significant. The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquared with d(d + 1)(d + 2)/6 degrees of freedom.</p>
</div>
<div id="answer-16" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="co">##Example 6.8</span></span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="kw">set.seed</span>(<span class="dv">33</span>)</span>
<span id="cb42-3"><a href="#cb42-3"></a>d&lt;-<span class="dv">1</span></span>
<span id="cb42-4"><a href="#cb42-4"></a>level&lt;-<span class="fl">0.05</span></span>
<span id="cb42-5"><a href="#cb42-5"></a>n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>,<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>) <span class="co">#sample sizes</span></span>
<span id="cb42-6"><a href="#cb42-6"></a>cv &lt;-<span class="st"> </span><span class="kw">qchisq</span>(<span class="dv">1</span><span class="op">-</span>level,d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb42-7"><a href="#cb42-7"></a></span>
<span id="cb42-8"><a href="#cb42-8"></a>p.reject &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(n)) <span class="co">#to store sim. results</span></span>
<span id="cb42-9"><a href="#cb42-9"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#num. repl. each sim.</span></span>
<span id="cb42-10"><a href="#cb42-10"></a><span class="co">#sigma&lt;-matrix(c(1,0.5,0.5,1),2,2)</span></span>
<span id="cb42-11"><a href="#cb42-11"></a><span class="co">#mean&lt;-numeric(d)</span></span>
<span id="cb42-12"><a href="#cb42-12"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) {</span>
<span id="cb42-13"><a href="#cb42-13"></a>  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#test decisions</span></span>
<span id="cb42-14"><a href="#cb42-14"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb42-15"><a href="#cb42-15"></a>  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i])</span>
<span id="cb42-16"><a href="#cb42-16"></a>  <span class="co">#x&lt;-mvrnorm(n[i],mean,sigma)</span></span>
<span id="cb42-17"><a href="#cb42-17"></a>  <span class="co">#test decision is 1 (reject) or 0</span></span>
<span id="cb42-18"><a href="#cb42-18"></a>  sigma_hat&lt;-<span class="kw">var</span>(x)</span>
<span id="cb42-19"><a href="#cb42-19"></a>  sigma_inv&lt;-<span class="dv">1</span><span class="op">/</span><span class="kw">var</span>(x)</span>
<span id="cb42-20"><a href="#cb42-20"></a>  mean_hat&lt;-<span class="kw">mean</span>(x)</span>
<span id="cb42-21"><a href="#cb42-21"></a>  b1d&lt;-(<span class="kw">t</span>(x<span class="op">-</span>mean_hat))<span class="op">^</span><span class="dv">3</span><span class="op">%*%</span>(x<span class="op">-</span>mean_hat)<span class="op">^</span><span class="dv">3</span><span class="op">*</span>((sigma_inv)<span class="op">^</span><span class="dv">3</span>)<span class="op">/</span>(n[i]<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb42-22"><a href="#cb42-22"></a>  sktests[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(b1d<span class="op">*</span>n[i]<span class="op">/</span><span class="dv">6</span><span class="op">&gt;=</span>cv)</span>
<span id="cb42-23"><a href="#cb42-23"></a> }</span>
<span id="cb42-24"><a href="#cb42-24"></a>p.reject[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests) <span class="co">#proportion rejected</span></span>
<span id="cb42-25"><a href="#cb42-25"></a>}</span>
<span id="cb42-26"><a href="#cb42-26"></a><span class="kw">print</span>(p.reject)</span></code></pre></div>
<pre><code>## [1] 0.0111 0.0456 0.0625 0.0747 0.0665 0.0242</code></pre>
<p>These are the results of repeated simulation in example 6.8.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="co">#Example 6.10</span></span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="kw">set.seed</span>(<span class="dv">33</span>)</span>
<span id="cb44-3"><a href="#cb44-3"></a>d&lt;-<span class="dv">1</span></span>
<span id="cb44-4"><a href="#cb44-4"></a>alpha &lt;-<span class="st"> </span><span class="fl">.1</span></span>
<span id="cb44-5"><a href="#cb44-5"></a>n &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb44-6"><a href="#cb44-6"></a>m &lt;-<span class="st"> </span><span class="dv">2500</span></span>
<span id="cb44-7"><a href="#cb44-7"></a>epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.15</span>, <span class="fl">.01</span>), <span class="kw">seq</span>(.<span class="dv">15</span>, <span class="dv">1</span>, <span class="fl">.05</span>))</span>
<span id="cb44-8"><a href="#cb44-8"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon)</span>
<span id="cb44-9"><a href="#cb44-9"></a>pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb44-10"><a href="#cb44-10"></a><span class="co">#critical value for the skewness test</span></span>
<span id="cb44-11"><a href="#cb44-11"></a>cv &lt;-<span class="st"> </span><span class="kw">qchisq</span>(<span class="dv">1</span><span class="op">-</span>alpha,d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb44-12"><a href="#cb44-12"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each epsilon</span></span>
<span id="cb44-13"><a href="#cb44-13"></a>e &lt;-<span class="st"> </span>epsilon[j]</span>
<span id="cb44-14"><a href="#cb44-14"></a>sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb44-15"><a href="#cb44-15"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></span>
<span id="cb44-16"><a href="#cb44-16"></a>  sigma &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>,</span>
<span id="cb44-17"><a href="#cb44-17"></a>  <span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</span>
<span id="cb44-18"><a href="#cb44-18"></a>  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, sigma)</span>
<span id="cb44-19"><a href="#cb44-19"></a>  </span>
<span id="cb44-20"><a href="#cb44-20"></a>  sigma_hat&lt;-<span class="kw">var</span>(x)</span>
<span id="cb44-21"><a href="#cb44-21"></a>  sigma_inv&lt;-<span class="dv">1</span><span class="op">/</span><span class="kw">var</span>(x)</span>
<span id="cb44-22"><a href="#cb44-22"></a>  mean_hat&lt;-<span class="kw">mean</span>(x)</span>
<span id="cb44-23"><a href="#cb44-23"></a>  b1d&lt;-<span class="dv">0</span></span>
<span id="cb44-24"><a href="#cb44-24"></a>  b1d&lt;-(<span class="kw">t</span>(x<span class="op">-</span>mean_hat))<span class="op">^</span><span class="dv">3</span><span class="op">%*%</span>(x<span class="op">-</span>mean_hat)<span class="op">^</span><span class="dv">3</span><span class="op">*</span>((sigma_inv)<span class="op">^</span><span class="dv">3</span>)<span class="op">/</span>(n<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb44-25"><a href="#cb44-25"></a>  sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(b1d<span class="op">*</span>n<span class="op">/</span><span class="dv">6</span><span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb44-26"><a href="#cb44-26"></a>}</span>
<span id="cb44-27"><a href="#cb44-27"></a> pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb44-28"><a href="#cb44-28"></a>}</span>
<span id="cb44-29"><a href="#cb44-29"></a><span class="kw">print</span>(pwr)</span>
<span id="cb44-30"><a href="#cb44-30"></a><span class="co">#plot power vs epsilon</span></span>
<span id="cb44-31"><a href="#cb44-31"></a><span class="kw">plot</span>(epsilon, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb44-32"><a href="#cb44-32"></a><span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb44-33"><a href="#cb44-33"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p>These are the results of repeated simulation in example 6.10. We get the curve of the power over time and it is silmilar to the empirical power curve in example 6.10.Note that the power curve crosses the horizontal line corresponding to α = 0.10 at both endpoints, <span class="math inline">\(\epsilon\)</span>= 0 and <span class="math inline">\(\epsilon\)</span> = 1 where the alternative is normally distributed. For 0 &lt;<span class="math inline">\(\epsilon\)</span>&lt; 1 the empirical power of the test is greater than 0.10 and highest when <span class="math inline">\(\epsilon\)</span> is about 0.20.</p>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</p>
<p>1)What is the corresponding hypothesis test problem?</p>
<p>2)What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test?</p>
<p>3)What information is needed to test your hypothesis?</p>
</div>
<div id="answer-17" class="section level2">
<h2>Answer</h2>
<p>1)Let pwr1 and pw2 represent the powers for two methods. The null hypothesis <span class="math inline">\(H_0\)</span> and the alternative hypothesis <span class="math inline">\(H_1\)</span> is <span class="math display">\[
H_0:pwr_1=pwr_2 \leftrightarrow H_1:pwr_1\not=pwr_2
\]</span></p>
<p>2)We have 10000 experiments and the results of each experiment (1 for rejection, 0 for acceptance) foe method one and method two. We can think of the two method as two treatments, then compare whether there is a significant difference between the two treatments at level 0.05. So we can choose McNemar test method.</p>
<p>3)According to the results (0 or 1) of the different methods in each experiment, the results of 10,000 experiments can be divided into four categories. The number of experiments contained in each category needs to be obtained, and then a 2*2 contingency table is made for McNemar test.</p>
</div>
</div>
<div id="section-5" class="section level1">
<h1>2020-11-03</h1>
<div id="question-7.1" class="section level2">
<h2>Question 7.1</h2>
<p>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
</div>
<div id="answer-18" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="kw">library</span>(bootstrap) <span class="co">#for the law data</span></span></code></pre></div>
<p>Use jackknife to estimate the bias and the standard error of the correlation statistic computed from the sample of scores in <strong>law</strong>.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>n&lt;-<span class="kw">nrow</span>(law)</span>
<span id="cb46-2"><a href="#cb46-2"></a>LSAT&lt;-law<span class="op">$</span>LSAT</span>
<span id="cb46-3"><a href="#cb46-3"></a>GPA&lt;-law<span class="op">$</span>GPA</span>
<span id="cb46-4"><a href="#cb46-4"></a>theta.hat&lt;-<span class="kw">cor</span>(LSAT,GPA)</span>
<span id="cb46-5"><a href="#cb46-5"></a><span class="co">#compute the jackknife replicates, leave-one-out estimates</span></span>
<span id="cb46-6"><a href="#cb46-6"></a>theta.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb46-7"><a href="#cb46-7"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)</span>
<span id="cb46-8"><a href="#cb46-8"></a>{theta.jack[i] &lt;-<span class="st"> </span><span class="kw">cor</span>(LSAT[<span class="op">-</span>i],GPA[<span class="op">-</span>i])}</span>
<span id="cb46-9"><a href="#cb46-9"></a><span class="co">#estimate bias</span></span>
<span id="cb46-10"><a href="#cb46-10"></a>bias &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(theta.jack) <span class="op">-</span><span class="st"> </span>theta.hat)</span>
<span id="cb46-11"><a href="#cb46-11"></a><span class="kw">print</span>(bias)</span></code></pre></div>
<pre><code>## [1] -0.006473623</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="co">#estimate stabdard error</span></span>
<span id="cb48-2"><a href="#cb48-2"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>) <span class="op">*</span><span class="kw">mean</span>((theta.jack <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(theta.jack))<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb48-3"><a href="#cb48-3"></a><span class="kw">print</span>(se)</span></code></pre></div>
<pre><code>## [1] 0.1425186</code></pre>
<p>Then the jackknife estimate of the bias and the standard error of the correlation statistic from the sample of scores is -0.0064736 and 0.1425186 respectively.</p>
</div>
<div id="question-7.5" class="section level2">
<h2>Question 7.5</h2>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
</div>
<div id="answer-19" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb50-2"><a href="#cb50-2"></a><span class="co">#mode(aircondit)</span></span>
<span id="cb50-3"><a href="#cb50-3"></a>n&lt;-<span class="kw">nrow</span>(aircondit)</span>
<span id="cb50-4"><a href="#cb50-4"></a>time&lt;-aircondit[<span class="dv">1</span><span class="op">:</span>n,]</span></code></pre></div>
<p>If <span class="math inline">\(X_1,\dots,X_n\)</span> are random samples from the exponential distribution of <span class="math inline">\(Exp(\lambda)\)</span>, then we can calculate the MLE of <span class="math inline">\(\lambda\)</span> is <span class="math inline">\(1/\bar{X}\)</span>, where <span class="math inline">\(\bar{X}\)</span> is sample mean. In Exercise 7.4, the MLE of <span class="math inline">\(1/\lambda\)</span> is exactly the mean time between failures. Now let us compute 95% bootstrap confidence intervals by different methods.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="kw">set.seed</span>(<span class="dv">22</span>)</span>
<span id="cb51-2"><a href="#cb51-2"></a>boot.obj&lt;-<span class="kw">boot</span>(time,<span class="dt">statistic =</span> <span class="cf">function</span>(t, i){<span class="kw">mean</span>(t[i])},<span class="dv">1000</span>)</span>
<span id="cb51-3"><a href="#cb51-3"></a><span class="kw">print</span>(boot.obj)</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = time, statistic = function(t, i) {
##     mean(t[i])
## }, R = 1000)
## 
## 
## Bootstrap Statistics :
##     original   bias    std. error
## t1* 108.0833 1.292083    39.78728</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="co">#boot.obj$t0 is original mean</span></span>
<span id="cb53-2"><a href="#cb53-2"></a>ci&lt;-<span class="kw">boot.ci</span>(boot.obj, <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;basic&quot;</span>, <span class="st">&quot;norm&quot;</span>, <span class="st">&quot;perc&quot;</span>))</span>
<span id="cb53-3"><a href="#cb53-3"></a><span class="kw">print</span>(ci)</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = c(&quot;basic&quot;, &quot;norm&quot;, &quot;perc&quot;))
## 
## Intervals : 
## Level      Normal              Basic              Percentile     
## 95%   ( 28.8, 184.8 )   ( 19.1, 171.2 )   ( 44.9, 197.1 )  
## Calculations and Intervals on Original Scale</code></pre>
<p>One reason for the difference in the percentile and normal confidence intervals could be that the sampling distribution of mean time between failures is not close to normal (see the histogram below). When the sampling distribution of the statistic is approximately normal, the percentile interval will agree with the normal interval.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="kw">hist</span>(boot.obj<span class="op">$</span>t,<span class="dt">xlab =</span> <span class="st">&quot;Bootstrap sample&quot;</span>,<span class="dt">main=</span><span class="st">&quot;Histogram of Bootstrap sample&quot;</span>,<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">270</span>,<span class="dv">10</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-7.8" class="section level2">
<h2>Question 7.8</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="answer-20" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb56-2"><a href="#cb56-2"></a>lambda_hat &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(scor))<span class="op">$</span>values</span>
<span id="cb56-3"><a href="#cb56-3"></a>theta_hat &lt;-<span class="st"> </span>lambda_hat[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(lambda_hat)</span>
<span id="cb56-4"><a href="#cb56-4"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor) <span class="co"># number of rows (data size)</span></span>
<span id="cb56-5"><a href="#cb56-5"></a><span class="co"># Jackknife</span></span>
<span id="cb56-6"><a href="#cb56-6"></a>theta_j &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb56-7"><a href="#cb56-7"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb56-8"><a href="#cb56-8"></a>x &lt;-<span class="st"> </span>scor [<span class="op">-</span>i,]</span>
<span id="cb56-9"><a href="#cb56-9"></a>lambda &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(x))<span class="op">$</span>values</span>
<span id="cb56-10"><a href="#cb56-10"></a>theta_j[i] &lt;-<span class="st"> </span>lambda[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(lambda)</span>
<span id="cb56-11"><a href="#cb56-11"></a><span class="co"># the i-th entry of theta_j is the i-th &quot;leave-one-out&quot; estimation of theta</span></span>
<span id="cb56-12"><a href="#cb56-12"></a>}</span>
<span id="cb56-13"><a href="#cb56-13"></a>bias_jack &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(theta_j) <span class="op">-</span><span class="st"> </span>theta_hat)</span>
<span id="cb56-14"><a href="#cb56-14"></a><span class="co"># the estimated bias of theta_hat, using jackknife</span></span>
<span id="cb56-15"><a href="#cb56-15"></a>se_jack &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">var</span>(theta_j) <span class="op">/</span><span class="st"> </span>n)</span>
<span id="cb56-16"><a href="#cb56-16"></a><span class="co"># the estimated se of theta_hat, using jackknife</span></span>
<span id="cb56-17"><a href="#cb56-17"></a><span class="kw">print</span>(<span class="kw">c</span>(bias_jack,se_jack))</span></code></pre></div>
<pre><code>## [1] 0.001069139 0.049552307</code></pre>
<p>The jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span> are 0.0010691 and 0.0495523.</p>
</div>
<div id="question-7.18" class="section level2">
<h2>Question 7.18</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
</div>
<div id="answer-21" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>data&lt;-<span class="kw">read.table</span>(<span class="st">&quot;./data.txt&quot;</span>,<span class="dt">quote =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb58-2"><a href="#cb58-2"></a>data&lt;-<span class="kw">t</span>(<span class="kw">as.matrix</span>(data))</span>
<span id="cb58-3"><a href="#cb58-3"></a>magnetic&lt;-data[,<span class="dv">1</span>]</span>
<span id="cb58-4"><a href="#cb58-4"></a>chemical&lt;-data[,<span class="dv">2</span>]</span>
<span id="cb58-5"><a href="#cb58-5"></a>r&lt;-<span class="kw">nrow</span>(data)</span>
<span id="cb58-6"><a href="#cb58-6"></a>c&lt;-<span class="kw">ncol</span>(data)</span>
<span id="cb58-7"><a href="#cb58-7"></a><span class="co">#library(DAAG); attach(ironslag)</span></span>
<span id="cb58-8"><a href="#cb58-8"></a><span class="co">#a &lt;- seq(10, 40, .1) #sequence for plotting fits</span></span>
<span id="cb58-9"><a href="#cb58-9"></a>e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,r,r)</span>
<span id="cb58-10"><a href="#cb58-10"></a>k&lt;-r<span class="op">*</span>(r<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb58-11"><a href="#cb58-11"></a><span class="co">#index i&lt;j</span></span>
<span id="cb58-12"><a href="#cb58-12"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(r<span class="dv">-1</span>)){</span>
<span id="cb58-13"><a href="#cb58-13"></a>  <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>r){</span>
<span id="cb58-14"><a href="#cb58-14"></a>    y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span><span class="kw">c</span>(i,j)]</span>
<span id="cb58-15"><a href="#cb58-15"></a>    x &lt;-<span class="st"> </span>chemical[<span class="op">-</span><span class="kw">c</span>(i,j)]</span>
<span id="cb58-16"><a href="#cb58-16"></a>    </span>
<span id="cb58-17"><a href="#cb58-17"></a>    J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb58-18"><a href="#cb58-18"></a>    yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[<span class="kw">c</span>(i,j)]</span>
<span id="cb58-19"><a href="#cb58-19"></a>    e1[i,j] &lt;-<span class="st"> </span><span class="kw">mean</span>((magnetic[<span class="kw">c</span>(i,j)] <span class="op">-</span><span class="st"> </span>yhat1)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb58-20"><a href="#cb58-20"></a>    </span>
<span id="cb58-21"><a href="#cb58-21"></a>    J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb58-22"><a href="#cb58-22"></a>    yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[<span class="kw">c</span>(i,j)] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[<span class="kw">c</span>(i,j)]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb58-23"><a href="#cb58-23"></a>    e2[i,j] &lt;-<span class="st"> </span><span class="kw">mean</span>((magnetic[<span class="kw">c</span>(i,j)] <span class="op">-</span><span class="st"> </span>yhat2)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb58-24"><a href="#cb58-24"></a>    </span>
<span id="cb58-25"><a href="#cb58-25"></a>    J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb58-26"><a href="#cb58-26"></a>    logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[<span class="kw">c</span>(i,j)]</span>
<span id="cb58-27"><a href="#cb58-27"></a>    yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</span>
<span id="cb58-28"><a href="#cb58-28"></a>    e3[i,j] &lt;-<span class="st"> </span><span class="kw">mean</span>((magnetic[<span class="kw">c</span>(i,j)] <span class="op">-</span><span class="st"> </span>yhat3)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb58-29"><a href="#cb58-29"></a>    </span>
<span id="cb58-30"><a href="#cb58-30"></a>    J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))</span>
<span id="cb58-31"><a href="#cb58-31"></a>    logyhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[<span class="kw">c</span>(i,j)])</span>
<span id="cb58-32"><a href="#cb58-32"></a>    yhat4 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4)</span>
<span id="cb58-33"><a href="#cb58-33"></a>    e4[i,j] &lt;-<span class="st"> </span><span class="kw">mean</span>((magnetic[<span class="kw">c</span>(i,j)] <span class="op">-</span><span class="st"> </span>yhat4)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb58-34"><a href="#cb58-34"></a>  }</span>
<span id="cb58-35"><a href="#cb58-35"></a>}</span>
<span id="cb58-36"><a href="#cb58-36"></a>sum_e1&lt;-<span class="kw">sum</span>(e1)<span class="op">/</span>k</span>
<span id="cb58-37"><a href="#cb58-37"></a>sum_e2&lt;-<span class="kw">sum</span>(e2)<span class="op">/</span>k</span>
<span id="cb58-38"><a href="#cb58-38"></a>sum_e3&lt;-<span class="kw">sum</span>(e3)<span class="op">/</span>k</span>
<span id="cb58-39"><a href="#cb58-39"></a>sum_e4&lt;-<span class="kw">sum</span>(e4)<span class="op">/</span>k</span></code></pre></div>
<p>There were some errors during the installation of the function package “DAAG”, I input the two sets of data that need to be fitted into the text document “data.txt”. The following estimates for prediction error are obtained from the n-fold cross validation.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="kw">print</span>(<span class="kw">c</span>(sum_e1,sum_e2,sum_e3,sum_e4))</span></code></pre></div>
<p>According to the prediction error criterion, Model 2, the quadratic model, would be the best fit for the data. This result is consistent with the optimal model selected using the leave-one-out (n-fold) cross validation in example 7.18.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a>J2</span></code></pre></div>
<p>The fitted regression equation for Model 2 is <span class="math display">\[
\hat{Y}=25.22190-1.43158 X+0.05408 X^{2}
\]</span> The residual plots for Model 2 are shown in Figure below.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="co">#par(mfrow = c(2, 2)) #layout for graphs</span></span>
<span id="cb61-2"><a href="#cb61-2"></a><span class="kw">plot</span>(J2<span class="op">$</span>fit, J2<span class="op">$</span>res) <span class="co">#residuals vs fitted values</span></span>
<span id="cb61-3"><a href="#cb61-3"></a><span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>) <span class="co">#reference line</span></span>
<span id="cb61-4"><a href="#cb61-4"></a><span class="kw">qqnorm</span>(J2<span class="op">$</span>res) <span class="co">#normal probability plot</span></span>
<span id="cb61-5"><a href="#cb61-5"></a><span class="kw">qqline</span>(J2<span class="op">$</span>res) <span class="co">#reference line</span></span>
<span id="cb61-6"><a href="#cb61-6"></a><span class="co">#par(mfrow = c(1, 1)) #restore display</span></span></code></pre></div>
</div>
</div>
<div id="section-6" class="section level1">
<h1>2020-11-10</h1>
<div id="question-8.3" class="section level2">
<h2>Question 8.3</h2>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
</div>
<div id="answer-22" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="co">#count the maximum of extreme points</span></span>
<span id="cb62-2"><a href="#cb62-2"></a><span class="kw">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb62-3"><a href="#cb62-3"></a>maxout &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb62-4"><a href="#cb62-4"></a>  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb62-5"><a href="#cb62-5"></a>  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb62-6"><a href="#cb62-6"></a>  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb62-7"><a href="#cb62-7"></a>  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb62-8"><a href="#cb62-8"></a>  <span class="kw">return</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)))</span>
<span id="cb62-9"><a href="#cb62-9"></a>}</span>
<span id="cb62-10"><a href="#cb62-10"></a><span class="co">#define function of replicate</span></span>
<span id="cb62-11"><a href="#cb62-11"></a>eqtest.permu&lt;-<span class="cf">function</span>(x,y){</span>
<span id="cb62-12"><a href="#cb62-12"></a>  R&lt;-<span class="dv">999</span></span>
<span id="cb62-13"><a href="#cb62-13"></a>  z&lt;-<span class="kw">c</span>(x,y)</span>
<span id="cb62-14"><a href="#cb62-14"></a>  n&lt;-<span class="kw">length</span>(x);N&lt;-<span class="kw">length</span>(z)</span>
<span id="cb62-15"><a href="#cb62-15"></a>  reps&lt;-<span class="kw">numeric</span>(R)</span>
<span id="cb62-16"><a href="#cb62-16"></a>  m0&lt;-<span class="kw">maxout</span>(x,y)</span>
<span id="cb62-17"><a href="#cb62-17"></a>  </span>
<span id="cb62-18"><a href="#cb62-18"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R){</span>
<span id="cb62-19"><a href="#cb62-19"></a>    <span class="co">#generate indices k for the first sample</span></span>
<span id="cb62-20"><a href="#cb62-20"></a>    k &lt;-<span class="st"> </span><span class="kw">sample</span>(N, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb62-21"><a href="#cb62-21"></a>    x1 &lt;-<span class="st"> </span>z[k]</span>
<span id="cb62-22"><a href="#cb62-22"></a>    y1 &lt;-<span class="st"> </span>z[<span class="op">-</span>k] <span class="co">#complement of x1</span></span>
<span id="cb62-23"><a href="#cb62-23"></a>    reps[i] &lt;-<span class="st"> </span><span class="kw">maxout</span>(x1,y1)</span>
<span id="cb62-24"><a href="#cb62-24"></a>  }</span>
<span id="cb62-25"><a href="#cb62-25"></a>  phat&lt;-<span class="kw">mean</span>(<span class="kw">c</span>(m0,reps)<span class="op">&gt;=</span>m0)</span>
<span id="cb62-26"><a href="#cb62-26"></a>  <span class="kw">return</span>(phat)</span>
<span id="cb62-27"><a href="#cb62-27"></a>}</span></code></pre></div>
<p>We define the function <span class="math inline">\(eqtest.perm\)</span> to test for equal variance when sample sizes are not necessarily equal.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="co"># test the performance of eqtest.permu</span></span>
<span id="cb63-2"><a href="#cb63-2"></a><span class="kw">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb63-3"><a href="#cb63-3"></a>a&lt;-<span class="kw">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb63-4"><a href="#cb63-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>){</span>
<span id="cb63-5"><a href="#cb63-5"></a>  x&lt;-<span class="op">-</span><span class="kw">rnorm</span>(<span class="dv">15</span>,<span class="dv">0</span>,<span class="dv">4</span>)</span>
<span id="cb63-6"><a href="#cb63-6"></a>  y&lt;-<span class="kw">rnorm</span>(<span class="dv">20</span>,<span class="dv">1</span>,<span class="dv">4</span>)</span>
<span id="cb63-7"><a href="#cb63-7"></a>  a[i]&lt;-<span class="kw">eqtest.permu</span>(x,y)<span class="op">&lt;=</span><span class="fl">0.05</span></span>
<span id="cb63-8"><a href="#cb63-8"></a>}</span>
<span id="cb63-9"><a href="#cb63-9"></a><span class="co">#reject rate of 1000 replicates</span></span>
<span id="cb63-10"><a href="#cb63-10"></a><span class="kw">print</span>(<span class="kw">mean</span>(a))</span></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="kw">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb64-2"><a href="#cb64-2"></a>b&lt;-<span class="kw">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb64-3"><a href="#cb64-3"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>){</span>
<span id="cb64-4"><a href="#cb64-4"></a>  x&lt;-<span class="op">-</span><span class="kw">rnorm</span>(<span class="dv">15</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb64-5"><a href="#cb64-5"></a>  y&lt;-<span class="kw">rnorm</span>(<span class="dv">20</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb64-6"><a href="#cb64-6"></a>  b[i]&lt;-<span class="kw">eqtest.permu</span>(x,y)<span class="op">&lt;=</span><span class="fl">0.05</span></span>
<span id="cb64-7"><a href="#cb64-7"></a>}</span>
<span id="cb64-8"><a href="#cb64-8"></a><span class="co">#reject rate of 1000 replicates</span></span>
<span id="cb64-9"><a href="#cb64-9"></a><span class="kw">print</span>(<span class="kw">mean</span>(b))</span></code></pre></div>
<p>Then we obtain the power of this test method in populations of equal and unequal variances. The powers of cases N(0,1) and N(1,4) are r mean(a) and r mean(b).</p>
</div>
<div id="question-2-1" class="section level2">
<h2>Question 2</h2>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p>
<p>1)Unequal variances and equal expectations</p>
<p>2)Unequal variances and unequal expectations</p>
<p>3)Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</p>
<p>4)Unbalanced samples (say, 1 case versus 10 controls)</p>
<p>Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</p>
</div>
<div id="answer-23" class="section level2">
<h2>Answer</h2>
<p>1)Unequal variances and equal expectations</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="co"># Test whether distributions are same</span></span>
<span id="cb65-2"><a href="#cb65-2"></a><span class="co"># Different methods include NN, energy, and ball methods</span></span>
<span id="cb65-3"><a href="#cb65-3"></a><span class="co"># Generate experiment data z</span></span>
<span id="cb65-4"><a href="#cb65-4"></a></span>
<span id="cb65-5"><a href="#cb65-5"></a><span class="kw">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb65-6"><a href="#cb65-6"></a><span class="co">#NN</span></span>
<span id="cb65-7"><a href="#cb65-7"></a><span class="kw">library</span>(RANN)</span>
<span id="cb65-8"><a href="#cb65-8"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {<span class="co"># k denote the number of chosen neighbors</span></span>
<span id="cb65-9"><a href="#cb65-9"></a>  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb65-10"><a href="#cb65-10"></a>  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);<span class="co"># we consider the case that z is 1-dimension</span></span>
<span id="cb65-11"><a href="#cb65-11"></a>  z &lt;-<span class="st"> </span>z[ix, ]</span>
<span id="cb65-12"><a href="#cb65-12"></a>  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># the first column is itself!</span></span>
<span id="cb65-13"><a href="#cb65-13"></a>  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb65-14"><a href="#cb65-14"></a>  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb65-15"><a href="#cb65-15"></a>  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>(n1 <span class="fl">+0.5</span>)); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>(n1<span class="fl">+.5</span>))</span>
<span id="cb65-16"><a href="#cb65-16"></a>  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb65-17"><a href="#cb65-17"></a>}</span>
<span id="cb65-18"><a href="#cb65-18"></a><span class="co">#&quot;boot&quot; function to carry out the permutation</span></span>
<span id="cb65-19"><a href="#cb65-19"></a><span class="kw">library</span>(boot)</span>
<span id="cb65-20"><a href="#cb65-20"></a>R&lt;-<span class="dv">499</span></span>
<span id="cb65-21"><a href="#cb65-21"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb65-22"><a href="#cb65-22"></a>  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,<span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb65-23"><a href="#cb65-23"></a>  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb65-24"><a href="#cb65-24"></a>  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb65-25"><a href="#cb65-25"></a>  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb65-26"><a href="#cb65-26"></a>}</span>
<span id="cb65-27"><a href="#cb65-27"></a><span class="co">#use function eqdist.nn</span></span>
<span id="cb65-28"><a href="#cb65-28"></a></span>
<span id="cb65-29"><a href="#cb65-29"></a><span class="co">#Energy method</span></span>
<span id="cb65-30"><a href="#cb65-30"></a><span class="kw">library</span>(energy)</span>
<span id="cb65-31"><a href="#cb65-31"></a><span class="co">#use function eqdist.etest</span></span>
<span id="cb65-32"><a href="#cb65-32"></a></span>
<span id="cb65-33"><a href="#cb65-33"></a><span class="co">#Ball method</span></span>
<span id="cb65-34"><a href="#cb65-34"></a><span class="kw">library</span>(Ball)</span>
<span id="cb65-35"><a href="#cb65-35"></a><span class="co"># use function bd.test</span></span></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="co"># Now we conduct the power comparison</span></span>
<span id="cb66-2"><a href="#cb66-2"></a>n1&lt;-<span class="dv">10</span>;n2&lt;-<span class="dv">20</span>;n&lt;-n1<span class="op">+</span>n2</span>
<span id="cb66-3"><a href="#cb66-3"></a>sizes&lt;-<span class="kw">c</span>(n1,n2);k=<span class="dv">3</span></span>
<span id="cb66-4"><a href="#cb66-4"></a>m &lt;-<span class="st"> </span><span class="dv">500</span>;</span>
<span id="cb66-5"><a href="#cb66-5"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb66-6"><a href="#cb66-6"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb66-7"><a href="#cb66-7"></a>  x&lt;-<span class="kw">rnorm</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb66-8"><a href="#cb66-8"></a>  y&lt;-<span class="kw">rnorm</span>(<span class="dv">20</span>,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb66-9"><a href="#cb66-9"></a>  z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)</span>
<span id="cb66-10"><a href="#cb66-10"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,sizes,k)<span class="op">$</span>p.value</span>
<span id="cb66-11"><a href="#cb66-11"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>sizes,<span class="dt">R=</span><span class="dv">499</span>)<span class="op">$</span>p.value</span>
<span id="cb66-12"><a href="#cb66-12"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">499</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb66-13"><a href="#cb66-13"></a>}</span>
<span id="cb66-14"><a href="#cb66-14"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb66-15"><a href="#cb66-15"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb66-16"><a href="#cb66-16"></a>pow</span></code></pre></div>
<p>Two distributions with unequal variances and equal expectations are N(0,1) and N(0,4).The number of samples generated from these two distributions is 10 and 20 respectively. The functions used in the three permutation tests are “eqdist.nn”(user-defined), “eqdist.etest”(from <strong>energy</strong>) and “bd.test”(from <strong>Ball</strong>).</p>
<p><strong>Results</strong>: the powers of NN, energy and ball method are r pow. Thus we can see that the ball method performs better than the other two methods.</p>
<p>2)Unequal variances and unequal expectations</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="kw">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb67-2"><a href="#cb67-2"></a>n1&lt;-<span class="dv">10</span>;n2&lt;-<span class="dv">20</span>;n&lt;-n1<span class="op">+</span>n2</span>
<span id="cb67-3"><a href="#cb67-3"></a>sizes&lt;-<span class="kw">c</span>(n1,n2);k=<span class="dv">3</span></span>
<span id="cb67-4"><a href="#cb67-4"></a>m &lt;-<span class="st"> </span><span class="dv">500</span>;</span>
<span id="cb67-5"><a href="#cb67-5"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb67-6"><a href="#cb67-6"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb67-7"><a href="#cb67-7"></a>  x&lt;-<span class="kw">rnorm</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb67-8"><a href="#cb67-8"></a>  y&lt;-<span class="kw">rnorm</span>(<span class="dv">20</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb67-9"><a href="#cb67-9"></a>  z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)</span>
<span id="cb67-10"><a href="#cb67-10"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,sizes,k)<span class="op">$</span>p.value</span>
<span id="cb67-11"><a href="#cb67-11"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>sizes,<span class="dt">R=</span><span class="dv">499</span>)<span class="op">$</span>p.value</span>
<span id="cb67-12"><a href="#cb67-12"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">499</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb67-13"><a href="#cb67-13"></a>}</span>
<span id="cb67-14"><a href="#cb67-14"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb67-15"><a href="#cb67-15"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb67-16"><a href="#cb67-16"></a>pow</span></code></pre></div>
<p>Two distributions with unequal variances and equal expectations are N(0,1) and N(1,4).The number of samples generated from these two distributions is 10 and 20 respectively.</p>
<p><strong>Results</strong>: the powers of NN, energy and ball method are r pow. Thus we can see that the three methods are ranked ball, energy and NN in order of performance.</p>
<p>3)Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="kw">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb68-2"><a href="#cb68-2"></a>n1&lt;-<span class="dv">20</span>;n2&lt;-<span class="dv">20</span>;n&lt;-n1<span class="op">+</span>n2</span>
<span id="cb68-3"><a href="#cb68-3"></a>sizes&lt;-<span class="kw">c</span>(n1,n2);k=<span class="dv">3</span></span>
<span id="cb68-4"><a href="#cb68-4"></a>m &lt;-<span class="st"> </span><span class="dv">500</span>;</span>
<span id="cb68-5"><a href="#cb68-5"></a>e&lt;-<span class="fl">0.5</span><span class="co">#epsilon</span></span>
<span id="cb68-6"><a href="#cb68-6"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb68-7"><a href="#cb68-7"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb68-8"><a href="#cb68-8"></a>  x&lt;-<span class="kw">rt</span>(<span class="dv">20</span>,<span class="dv">1</span>)</span>
<span id="cb68-9"><a href="#cb68-9"></a>  sigma &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">size =</span> <span class="dv">20</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</span>
<span id="cb68-10"><a href="#cb68-10"></a>  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, sigma)</span>
<span id="cb68-11"><a href="#cb68-11"></a>  z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)</span>
<span id="cb68-12"><a href="#cb68-12"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,sizes,k)<span class="op">$</span>p.value</span>
<span id="cb68-13"><a href="#cb68-13"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>sizes,<span class="dt">R=</span><span class="dv">499</span>)<span class="op">$</span>p.value</span>
<span id="cb68-14"><a href="#cb68-14"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">499</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb68-15"><a href="#cb68-15"></a>}</span>
<span id="cb68-16"><a href="#cb68-16"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb68-17"><a href="#cb68-17"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb68-18"><a href="#cb68-18"></a>pow</span></code></pre></div>
<p>Here the bimodel distribution we chose is mixture of two normal distributions N(0,1) and N(0,4), which is <span class="math inline">\((1-\varepsilon) N\left(\mu=0, \sigma^{2}=1\right)+\varepsilon N\left(\mu=0, \sigma^{2}=4\right)\)</span>. We here set <span class="math inline">\(\varepsilon\)</span> to <span class="math inline">\(\frac{1}{2}\)</span>. In the case, we generate 20 samples from <span class="math inline">\(t(1)\)</span> and the bimodel distribution above, respectively.</p>
<p><strong>Results</strong>: the powers of NN, energy and ball method are r pow. As we can see, powers of three methods are similar, and all are small.</p>
<p>4)Unbalanced samples (say, 1 case versus 10 controls)</p>
</div>
</div>
<div id="section-7" class="section level1">
<h1>2020-11-17</h1>
<div id="question-1-1" class="section level2">
<h2>Question 1</h2>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
</div>
<div id="answer-24" class="section level2">
<h2>Answer</h2>
<p>The standard Laplace distribution has density f(x)=<span class="math inline">\(\frac{1}{2}e^{-|x|}, x\in R\)</span>.</p>
<p>The process of generating a sample is combined into a function, given the sample size N, variance of the random walk sigma, and the initial value x0.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="kw">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb69-2"><a href="#cb69-2"></a><span class="co">#define standard Laplace density</span></span>
<span id="cb69-3"><a href="#cb69-3"></a>lap&lt;-<span class="cf">function</span>(x){</span>
<span id="cb69-4"><a href="#cb69-4"></a>  <span class="kw">return</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb69-5"><a href="#cb69-5"></a>}</span>
<span id="cb69-6"><a href="#cb69-6"></a><span class="co">#define the random walk sampler</span></span>
<span id="cb69-7"><a href="#cb69-7"></a><span class="co">#The function returns the sample x and acceptance rates.</span></span>
<span id="cb69-8"><a href="#cb69-8"></a>rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb69-9"><a href="#cb69-9"></a>  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb69-10"><a href="#cb69-10"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb69-11"><a href="#cb69-11"></a>  k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb69-12"><a href="#cb69-12"></a>  </span>
<span id="cb69-13"><a href="#cb69-13"></a>  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x0, sigma)</span>
<span id="cb69-14"><a href="#cb69-14"></a>    <span class="cf">if</span> (u[<span class="dv">1</span>] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">lap</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">lap</span>(x0)))</span>
<span id="cb69-15"><a href="#cb69-15"></a>    x[<span class="dv">1</span>] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</span>
<span id="cb69-16"><a href="#cb69-16"></a>      x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb69-17"><a href="#cb69-17"></a>      k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb69-18"><a href="#cb69-18"></a>    }</span>
<span id="cb69-19"><a href="#cb69-19"></a>  </span>
<span id="cb69-20"><a href="#cb69-20"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb69-21"><a href="#cb69-21"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb69-22"><a href="#cb69-22"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">lap</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">lap</span>(x[i<span class="dv">-1</span>])))</span>
<span id="cb69-23"><a href="#cb69-23"></a>    x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</span>
<span id="cb69-24"><a href="#cb69-24"></a>      x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb69-25"><a href="#cb69-25"></a>      k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb69-26"><a href="#cb69-26"></a>    }</span>
<span id="cb69-27"><a href="#cb69-27"></a>  }</span>
<span id="cb69-28"><a href="#cb69-28"></a><span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>(<span class="dv">1</span><span class="op">-</span>k<span class="op">/</span>N)))</span>
<span id="cb69-29"><a href="#cb69-29"></a>}</span>
<span id="cb69-30"><a href="#cb69-30"></a>N &lt;-<span class="st"> </span><span class="dv">5000</span></span>
<span id="cb69-31"><a href="#cb69-31"></a>sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">16</span>)</span>
<span id="cb69-32"><a href="#cb69-32"></a>x0 &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb69-33"><a href="#cb69-33"></a>rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb69-34"><a href="#cb69-34"></a>rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb69-35"><a href="#cb69-35"></a>rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb69-36"><a href="#cb69-36"></a>rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb69-37"><a href="#cb69-37"></a><span class="kw">print</span>(<span class="kw">c</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k))</span></code></pre></div>
<pre><code>## [1] 0.9822 0.7028 0.3338 0.1154</code></pre>
<p>Only the second chain has a receptance rate in the range [0.5,0.85] (Correspondingly, the rejection rate is between 0.15 and 0.5). And we can see that the acceptance rate decreases when the variance of the proposed distribution increases.</p>
<p>The cdf of Laplace distribution is <span class="math display">\[
\begin{equation}
f(x)=
\begin{cases}
\frac{1}{2}e^x &amp; x\leq 0\\
1-\frac{1}{2}e^{-x}&amp; x&gt;0
\end{cases}
\end{equation}
\]</span> For x less than 0, the quantile function is <span class="math inline">\(F^{-1}(q)=Log(2q)\)</span>. Then the 2.5% quantile is Log(0.05) and the 97.5% quantile is -Log(0.05) by the symmetry.</p>
<p>The plots below show that the random walk Metropolis sampler is very sensitive to the variance of the proposal distribution. Reference lines are added at the 2.5% and 97.5% quantiles.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="co">#par(mfrow=c(2,2)) #display 4 graphs together</span></span>
<span id="cb71-2"><a href="#cb71-2"></a>refline &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">log</span>(<span class="fl">0.05</span>),<span class="op">-</span><span class="kw">log</span>(<span class="fl">0.05</span>))</span>
<span id="cb71-3"><a href="#cb71-3"></a>rw &lt;-<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>x, rw2<span class="op">$</span>x, rw3<span class="op">$</span>x, rw4<span class="op">$</span>x)</span>
<span id="cb71-4"><a href="#cb71-4"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb71-5"><a href="#cb71-5"></a>  <span class="kw">plot</span>(rw[,j],<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(rw[,j]))</span>
<span id="cb71-6"><a href="#cb71-6"></a>  <span class="kw">abline</span>(<span class="dt">h=</span>refline)</span>
<span id="cb71-7"><a href="#cb71-7"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAY1BMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6ZpA6ZrY6kNtmAABmADpmOgBmZjpmZrZmtttmtv+QOgCQZgCQ2/+2ZgC2Zjq2Zma22/+2///bkDrbtpDb////tmb/25D//7b//9v///8i3mfXAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALNUlEQVR4nO2dC3fbNhaEJ3W83bi7bbPVbquNH/j/v7KiSJB44wIENVeJvnOSksB9DMaQ5IY4NsyDImAL0A7YArQDtgDtgC1AO2AL0A7YArQDtgDtgC1AO2AL0A7YArQDtgDtgC1AO2AL0A7YArQDtgDtgC1AO2AL0A7YArQDtgDtgC1AO2AL0A7YArQDtgDtgC1AO2AL0A7YArQDtgDtgC1AO2AL0A7YArQDtgDtgC1AO2AL0A7YArQDtgDtgC1AO2AL0A7YArQDtgDtgC1AO2AL0A7YArQDtgDtgC1AO2AL0A7YArQDtgDtgC1AO2AL0A7YArQDtgDtgC1AO2AL0A7YArQDtgDtgC1AO2AL0A7YArQDtgDtgC1AO2AL0A7YArQDtgDtgC1AO2AL0A7YArQDtgDtgC1AO2AL0A7YArQDtgDtgC1AO2AL0A7YArQDtgDtgC1AO2AL0A4Gl7sbWAaNLXccGB5IKXccGB5IKXccGB7YUm5w0SPA8MByFf+9b0zRQ8HwwKZyg6seAIYHNpUbXPUAMDywqdzgqgeA4YFN5QZXPQAMD2wqN7jqAWB4YFO5wVUPAMMDm8oNrnoAGB7YVG5w1QPA8MCmcoOrHgCGBzaVG1z1ADA8sKnc4KoHgOGBV04//WXenoFPf5TLtVVlgOGBE1d//nEx5/3l92K5pqoUMDzQTLZ8uZj0ebo8P30rlWupehzonOsLNPO++fj6Zbp8vewlt0rwT71x1UqfFhnihFKMuKE4cGLaPee+HVTp0yRDmlCKETcUB068v/z013ULvebepZGrWunTJEOaUIoRNxQHzrzOL6TPlXJxVRTu2mXoNUhYLq6Kwl2PDElCKUbcUBzYVC6uisJdswy0GxTGixuKA5vKxVVRuGuWgfs3KCqL9B2S05ksdzgzk80O4yX5bYFN5aoGIRjOyMgPZ2ay2WG8JL8tsKmcYoNQrCyW0IttH5X1Bx4GRWX9gYJBMPFqEsUyM+kuiZKS/LbApnIPgyrlygbhYZAqg+BVQrFystcAon/uiMrCu/7hDArLiQyCeRjkTmxjxxnkj/6QBmH5C15AVAaOCsQzSg2Cc20Cg2Cv3dHEVoE/7P/nuzVofnfHWgHORVDJTsG53arDD4ObEmYIEQc2lcsZhPV6iZ0D8waF6yoZhMCg7cSknfYyhIgDheXuBpZB1qd4AtftABPtIP/Lb2c6d5Azbl1wdlCUKF7RKGx7+PfL1rqNQVtt2Pr3YhDKBsFmbBew12uCwTIMp1Fo0FyfYND50uf6VP7sP1kNy2FVasfSBtlV+QY5TrUbhLVCaNCmqGXd4sCJ86c/zPvL9FBsj0FIG+R8kWFLeQYt09Br0Pxc/uPr0zeRQVbRspLQoPkPMgahbpDNN3WDcBuD7KGX09O3c+XwwpEGLXUcg9ZsskHLyY7pEEN1B63ifIMWZwQGLWsMDELFIOdrsBi0vsCGGfS/9NInrC3vLxhnEOBOrlvMN8hJCA1yE9wWaYPWPS7wxgl8/9Xevz1nlj47NH+GXfbSLoOwLi40yF+vxCBn9EiDXpbzLKfc1mgqtyqy6yob5GLc9boGOY7YrNUQb3R7qYUGod+gy5aYjrS8PecPtjSVazAoImGQW8y1QmQQhhg0nfz59O/86dXGcr5BnhNygxAZFFoRGuRVGG3QsomGGxQuwV2NwCBgKxfvlZpB4cQeg87TDtr3BhQZhC6DgkuTiuo1CL0GXT64P1///nKIQZnVpJZeMUMScIBBB32K1VZXXbosKgzIGrTM9hgk/D6o3aB9S5dFhQGmmNZlkEvhO2mOQc2YYvHdBu2izSAKD4MqUAyK2iuGYlBYjm1CiYdBFe7FIElMpwOV6e/RoHRwpkSl8sOg1LDZJr4Lg8JJk7wz6ZBUZbNN3JFB+bBwxngXxhtdCpk4OChgZSk1yF9Eh0GbN0WDDNUg+aPn5Pp6DTI7DTKbQeZQgxoePbcZlEoQG2S2abJBLY+eiwZZpT0GmWaDzJJ1vEH5R8+HG2Qig0zBIOPnmlsZ1PDo2V9hwSBjVxsFu/GLQXapSYPWnIpBjesWB07IHz17LwXYDeAYtA6VDVqmY4PWPXXtOA+YrEHG2LhjDco+eg71uAa5bngGOV/4ukHrJnANsoNm88k1aM01NzNIWk5q0OrAam/KIFtyuVhfL0WDbH8rDDa3cd3iwI31rShfDsvyGw0yIoNMwqClbWjQtrw7MshuAQQGLcs2YoOcQdv2Hg0yrkHb9RbtmugZZP1zShobYaxBS41latlVCYOM09G7qCEO3Og2yMY416bLIPcP3LZ3apAx9jU1T6YMMmKDbBsb7a7CGmSsQaEy+LcCxIFN5XYaZBaXxAZttdbeWg26G1gGhbfLQLCDvN2AcAfZTNEO8vtB/Q4Kb5cBzxSEBpmCQcnKSA2aokFBQjyVQRzYVW69LRpkhhpkNoMK+lKTScSBXeXWW7FBZp9BbotwMgyQIQ7sKrfelgyyfw02qKwvF5DPGAMytzDNBiXel6OboJ1eg3Kfnp4e9wZBzHUewUB9neF8Lj4tSIQ4sKsc3Av3Jmx7nUdUIwwLx1NliiC6EGeMIVcORmBQpYagXTUV0UVri53kyoXjqXtk5hraVVMRXbS22EmuXDieukdmrqFdNRXRRWuLneTKheOpe2TmGtpVUxFdtLbYSa5cOJ66R2auo109QZzZ3KKvXDieus/ldrSrJ4gzm1uMKRfGoSG3o12cIM5sayH9rQhddOT2txNnNrUQ/1aELjpy+9uJM1tayH8rQhcduf3txJktLfK/FaGr3IDc/nbizKYW4t+K0EVHbn87cWZTC/FvRdAPhgfOZH4rQvvDAjYYHkgpdxwYHrgheLKqHwwP3CgadDeQDJIVrczvm96bvi984mFQhYdBu6kVrczvm34YdGz1neFjilbm900/DDq2+s7wMUUr8/umHwYdW31n+I8H2AK0A7YA7YAtQDtgC9AO2AK0A7YA7YAtQDtgC9AO2AK0A7YA7YAtQDtgC9AOhld8LRwfSvLxFZh/yO6aGl+UOV2PCnSnl8C+9JjpsX320X2Kj6+X6PP0NHtNjS8qPTEZ1J1eBLuyY+ZHHqeGH9399jwdxjovxyKm1PiizPvLZFB3ehnsyo5Zl9uYd/lCr6nxRTn3/PSfi0Hd6WWwJznB9YRe9nxVntNlPTY1vqi1nN6DetMrYE9ygvkl3/zCf728S6+p8UUpdXohTQZ1ptfAnuQEfaJe7Xt0xwqnw253ZFDXtn69fsr3vUauMXf0Eut5YzzP3wX1vcuel+Msv9/Jm3THR+v2U5u6P6dP9/Mx3/7N2duzPSzS/53e6X6+Ubzu+SZNy2tkyllT44sy8/9qdKeXwL707x+wBWgHbAHaAVuAdsAWoB2wBWgHbAHaAVuAdsAWoB2wBWgHbAHaAVuAdsAWoB2wBWgHbAHaAVuAdsAWoB2wBWgHbAHaAVuAdsAWoB2wBWgHbAHaAVuAdsAWoB2wBWgHbAHaAVtAK6fMDwc7Cty0237mE783BDfttpv5xO8twU277WY+8XtLcNNuIj7++3w9MZT4ITzLid9bgpt2E3F6+tO8/ZqywZ74vSW4aTcJy9nUf853p+WM5vrjLR8Gzcd233+Jj86tJ35vCW7aTcJiUOLnDa8nfm8pB7dsJmK2Zj7jHLzErgM//A4yr59+m3/jdpKHQcb8/1/AzzkbHgYpA2wB2gFbgHbAFqAdsAVoB2wB2gFbgHbAFqAdsAVoB2wB2gFbgHbAFqAdsAVoB2wB2gFbgHbAFqAdsAVoB2wB2gFbgHbAFqAdsAVoB2wB2gFbgHbAFqCdvwGoE/5yXrHpFwAAAABJRU5ErkJggg==" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="co">#par(mfrow=c(1,1)) #reset to default</span></span></code></pre></div>
</div>
<div id="question-2-2" class="section level2">
<h2>Question 2</h2>
<p>For Exercise 9.4, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}\)</span>&lt; 1.2.</p>
</div>
<div id="answer-25" class="section level2">
<h2>Answer</h2>
<p>The target distribution is standard Laplace distribution, and the proposal distribution is <span class="math inline">\(Normal(X_t, \sigma^2)\)</span>. The scalar summary statistic <span class="math inline">\(\psi_{ij}\)</span> is the mean of the ith chain up to time j.</p>
<p>The following function <strong>Gelman.Rubin</strong> is to calculate the diagnostic statistics.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="kw">set.seed</span>(<span class="dv">22</span>)</span>
<span id="cb73-2"><a href="#cb73-2"></a>Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</span>
<span id="cb73-3"><a href="#cb73-3"></a>  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb73-4"><a href="#cb73-4"></a>  <span class="co"># for chain in i-th row of X</span></span>
<span id="cb73-5"><a href="#cb73-5"></a>  psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</span>
<span id="cb73-6"><a href="#cb73-6"></a>  n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</span>
<span id="cb73-7"><a href="#cb73-7"></a>  k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</span>
<span id="cb73-8"><a href="#cb73-8"></a>  psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb73-9"><a href="#cb73-9"></a>  B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb73-10"><a href="#cb73-10"></a>  psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb73-11"><a href="#cb73-11"></a>  W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb73-12"><a href="#cb73-12"></a>  v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb73-13"><a href="#cb73-13"></a>  r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W <span class="co">#G-R statistic</span></span>
<span id="cb73-14"><a href="#cb73-14"></a>  <span class="kw">return</span>(r.hat)</span>
<span id="cb73-15"><a href="#cb73-15"></a>}</span></code></pre></div>
<p>Since several chains are to be generated, the M-H sampler is written as a function <strong>normal.chain</strong>.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a>normal.chain &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, N, X1) {</span>
<span id="cb74-2"><a href="#cb74-2"></a>  <span class="co">#generates a Metropolis chain for Normal(0,1)</span></span>
<span id="cb74-3"><a href="#cb74-3"></a>  <span class="co">#with Normal(X[t], sigma) proposal distribution</span></span>
<span id="cb74-4"><a href="#cb74-4"></a>  <span class="co">#and starting value X1</span></span>
<span id="cb74-5"><a href="#cb74-5"></a>  x &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb74-6"><a href="#cb74-6"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>X1</span>
<span id="cb74-7"><a href="#cb74-7"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb74-8"><a href="#cb74-8"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb74-9"><a href="#cb74-9"></a>  xt &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb74-10"><a href="#cb74-10"></a>  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, xt, sigma) <span class="co">#candidate point</span></span>
<span id="cb74-11"><a href="#cb74-11"></a>  r1 &lt;-<span class="st"> </span><span class="kw">lap</span>(y) <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(xt, y, sigma)</span>
<span id="cb74-12"><a href="#cb74-12"></a>  r2 &lt;-<span class="st"> </span><span class="kw">lap</span>(xt) <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(y, xt, sigma)</span>
<span id="cb74-13"><a href="#cb74-13"></a>  r &lt;-<span class="st"> </span>r1 <span class="op">/</span><span class="st"> </span>r2</span>
<span id="cb74-14"><a href="#cb74-14"></a>  <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>r) x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span></span>
<span id="cb74-15"><a href="#cb74-15"></a>    x[i] &lt;-<span class="st"> </span>xt</span>
<span id="cb74-16"><a href="#cb74-16"></a>  }</span>
<span id="cb74-17"><a href="#cb74-17"></a>  <span class="kw">return</span>(x)</span>
<span id="cb74-18"><a href="#cb74-18"></a>}</span></code></pre></div>
<p>In the following simulation, the proposal distribution has an appropriate variance <span class="math inline">\(\sigma^2=1\)</span>. Now we generate four chains with different initial values <span class="math inline">\(x_1\)</span>.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a>sigma &lt;-<span class="dv">1</span> <span class="co">#parameter of proposal distribution</span></span>
<span id="cb75-2"><a href="#cb75-2"></a>k &lt;-<span class="st"> </span><span class="dv">4</span> <span class="co">#number of chains to generate</span></span>
<span id="cb75-3"><a href="#cb75-3"></a>n &lt;-<span class="st"> </span><span class="dv">15000</span> <span class="co">#length of chains</span></span>
<span id="cb75-4"><a href="#cb75-4"></a>b &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb75-5"><a href="#cb75-5"></a>x0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">-5</span>, <span class="dv">5</span>, <span class="dv">10</span>)<span class="co">#different initial values</span></span>
<span id="cb75-6"><a href="#cb75-6"></a></span>
<span id="cb75-7"><a href="#cb75-7"></a><span class="co">#generate the MC chains</span></span>
<span id="cb75-8"><a href="#cb75-8"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)</span>
<span id="cb75-9"><a href="#cb75-9"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb75-10"><a href="#cb75-10"></a>  X[i, ] &lt;-<span class="st"> </span><span class="kw">normal.chain</span>(sigma, n, x0[i])</span>
<span id="cb75-11"><a href="#cb75-11"></a>}</span>
<span id="cb75-12"><a href="#cb75-12"></a></span>
<span id="cb75-13"><a href="#cb75-13"></a><span class="co">#compute diagnostic statistics, that is mean of the first j elements in the k chain</span></span>
<span id="cb75-14"><a href="#cb75-14"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb75-15"><a href="#cb75-15"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb75-16"><a href="#cb75-16"></a>psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb75-17"><a href="#cb75-17"></a><span class="kw">print</span>(<span class="kw">Gelman.Rubin</span>(psi))</span>
<span id="cb75-18"><a href="#cb75-18"></a></span>
<span id="cb75-19"><a href="#cb75-19"></a><span class="co">#plot psi for the four chains</span></span>
<span id="cb75-20"><a href="#cb75-20"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb75-21"><a href="#cb75-21"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb75-22"><a href="#cb75-22"></a>  <span class="kw">plot</span>(psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span>i, <span class="dt">ylab=</span><span class="kw">bquote</span>(psi))</span>
<span id="cb75-23"><a href="#cb75-23"></a>}</span>
<span id="cb75-24"><a href="#cb75-24"></a><span class="co">#par(mfrow=c(1,1)) #restore default</span></span>
<span id="cb75-25"><a href="#cb75-25"></a></span>
<span id="cb75-26"><a href="#cb75-26"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb75-27"><a href="#cb75-27"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb75-28"><a href="#cb75-28"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n)</span>
<span id="cb75-29"><a href="#cb75-29"></a>rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb75-30"><a href="#cb75-30"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb75-31"><a href="#cb75-31"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p>The plot of <span class="math inline">\(\hat R\)</span> over time 1001 to 15000 suggest that its value is below within 6500 iterations.</p>
</div>
<div id="question-3-1" class="section level2">
<h2>Question 3</h2>
<p>Find the intersection points A(k) in <span class="math inline">\((0,\sqrt k)\)</span> of the curves <span class="math display">\[
S_{k-1}(a)=P\left(t(k-1)&gt;\sqrt{\frac{a^{2}(k-1)}{k-a^{2}}}\right)
\]</span> and <span class="math display">\[
S_{k}(a)=P\left(t(k)&gt;\sqrt{\frac{a^{2} k}{k+1-a^{2}}}\right)
\]</span> for k = 4 : 25, 100, 500, 1000, where t(k) is a Student t random variable with k degrees of freedom. (These intersection points determine the critical values for a t-test for scale-mixture errors proposed by Sz´ekely [260].)</p>
</div>
<div id="answer-26" class="section level2">
<h2>Answer</h2>
<p>The solution “a” is symmetric about 0, so we just consider the case where a&gt;0 and we can easily find another negative solution, -a.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a>K&lt;-<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb76-2"><a href="#cb76-2"></a>n&lt;-<span class="kw">length</span>(K)</span>
<span id="cb76-3"><a href="#cb76-3"></a><span class="co">#a&gt;0 and a^2&lt;k</span></span>
<span id="cb76-4"><a href="#cb76-4"></a>pre&lt;-<span class="kw">numeric</span>(n)</span>
<span id="cb76-5"><a href="#cb76-5"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb76-6"><a href="#cb76-6"></a>  k&lt;-K[i]</span>
<span id="cb76-7"><a href="#cb76-7"></a>  f&lt;-<span class="cf">function</span>(a){</span>
<span id="cb76-8"><a href="#cb76-8"></a>    <span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k)<span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="dv">-1</span>)<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k<span class="dv">-1</span>)</span>
<span id="cb76-9"><a href="#cb76-9"></a>  }</span>
<span id="cb76-10"><a href="#cb76-10"></a>  pre[i]&lt;-<span class="kw">f</span>(<span class="fl">0.1</span>)<span class="op">*</span><span class="kw">f</span>(<span class="kw">sqrt</span>(k)<span class="op">-</span><span class="fl">0.1</span>)</span>
<span id="cb76-11"><a href="#cb76-11"></a>  <span class="cf">if</span>(pre[i]<span class="op">&gt;=</span><span class="dv">0</span>) <span class="kw">print</span>(K[i])</span>
<span id="cb76-12"><a href="#cb76-12"></a>}</span></code></pre></div>
<pre><code>## [1] 100
## [1] 500
## [1] 1000</code></pre>
<p>The output above is a set of k values that give the function of x the same sign at both ends of the given interval <span class="math inline">\((0.1,\sqrt{k}-0.1)\)</span>. First we Find the intersection points A(k) at <span class="math inline">\((0,\sqrt k)\)</span> for k=4 : 25.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a>Ak&lt;-<span class="kw">rep</span>(<span class="ot">NA</span>,n)</span>
<span id="cb78-2"><a href="#cb78-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">22</span>){</span>
<span id="cb78-3"><a href="#cb78-3"></a>  Ak[i]&lt;-<span class="kw">uniroot</span>(f,<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="kw">sqrt</span>(K[i])<span class="op">-</span><span class="fl">0.1</span>))<span class="op">$</span>root</span>
<span id="cb78-4"><a href="#cb78-4"></a>}</span>
<span id="cb78-5"><a href="#cb78-5"></a><span class="kw">print</span>(Ak)</span></code></pre></div>
<pre><code>##  [1] 1.730898 1.730894 1.730898 1.730896 1.730897 1.730895 1.730901 1.730897
##  [9] 1.730919 1.730897 1.730900 1.730912 1.730897 1.730902 1.730916 1.730891
## [17] 1.730897 1.730898 1.730898 1.730897 1.730922 1.730886       NA       NA
## [25]       NA</code></pre>
<p>From the results A(k), we can find the solution is close to 1.731. Now we try find intersection points in interval(1,2). The following shows the solution for all values of k=4:25,100,500,1000.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">23</span><span class="op">:</span><span class="dv">25</span>){</span>
<span id="cb80-2"><a href="#cb80-2"></a>  Ak[i]&lt;-<span class="kw">uniroot</span>(f,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))<span class="op">$</span>root</span>
<span id="cb80-3"><a href="#cb80-3"></a>}</span>
<span id="cb80-4"><a href="#cb80-4"></a><span class="kw">print</span>(Ak)</span></code></pre></div>
<pre><code>##  [1] 1.730898 1.730894 1.730898 1.730896 1.730897 1.730895 1.730901 1.730897
##  [9] 1.730919 1.730897 1.730900 1.730912 1.730897 1.730902 1.730916 1.730891
## [17] 1.730897 1.730898 1.730898 1.730897 1.730922 1.730886 1.730907 1.730907
## [25] 1.730907</code></pre>
<p>Because of symmetry, the intersection points A(k) has two values (the above result and negative of it) for each k.</p>
</div>
</div>
<div id="section-8" class="section level1">
<h1>2020-11-24</h1>
<p>#Question 1</p>
<p>A-B-O blood type problem</p>
<p>Observed data: <span class="math inline">\(n_{A·}=n_{AA}+n_{AO}=444(A-type), n_{B·}=n_{BB}+n_{BO}=132(B-type),n_{OO}=361, n_{AB}=63\)</span></p>
<p>1)Use EM algorithm to solve MLE of p and q (consider missing data <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span>).</p>
<p>2)Record the values of p and q that maximize the conditional likelihood in each EM steps, calculate the corresponding log-maximum likelihood values (for observed data), are they increasing?</p>
<div id="answer-27" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="co">#赋初值</span></span>
<span id="cb82-2"><a href="#cb82-2"></a>nA&lt;-<span class="dv">444</span>;nB&lt;-<span class="dv">132</span>;nOO&lt;-<span class="dv">361</span>;nAB&lt;-<span class="dv">63</span></span>
<span id="cb82-3"><a href="#cb82-3"></a>loglike_obs&lt;-<span class="cf">function</span>(theta){</span>
<span id="cb82-4"><a href="#cb82-4"></a>  p&lt;-theta[<span class="dv">1</span>];q&lt;-theta[<span class="dv">2</span>]</span>
<span id="cb82-5"><a href="#cb82-5"></a>  r&lt;-<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q</span>
<span id="cb82-6"><a href="#cb82-6"></a>  t&lt;-nA<span class="op">*</span><span class="kw">log</span>(p<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>r)<span class="op">+</span>nB<span class="op">*</span><span class="kw">log</span>(q<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>r)<span class="op">+</span>nAB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>q)<span class="op">+</span>nOO<span class="op">*</span><span class="kw">log</span>(r<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb82-7"><a href="#cb82-7"></a>  <span class="kw">return</span>(t)</span>
<span id="cb82-8"><a href="#cb82-8"></a>}</span>
<span id="cb82-9"><a href="#cb82-9"></a></span>
<span id="cb82-10"><a href="#cb82-10"></a>theta0&lt;-<span class="kw">c</span>(<span class="fl">0.33</span>,<span class="fl">0.33</span>)</span>
<span id="cb82-11"><a href="#cb82-11"></a>m&lt;-<span class="dv">10</span></span>
<span id="cb82-12"><a href="#cb82-12"></a>record&lt;-<span class="kw">matrix</span>(m<span class="op">*</span><span class="dv">3</span>,m,<span class="dv">3</span>)</span>
<span id="cb82-13"><a href="#cb82-13"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb82-14"><a href="#cb82-14"></a><span class="co">#E-step</span></span>
<span id="cb82-15"><a href="#cb82-15"></a><span class="co">#这里应当求出nAO和nBO这两个缺失值的估计，它们是上述函数最大值时的p0和q0</span></span>
<span id="cb82-16"><a href="#cb82-16"></a>p0&lt;-theta0[<span class="dv">1</span>];q0&lt;-theta0[<span class="dv">2</span>];r0&lt;-<span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(theta0)</span>
<span id="cb82-17"><a href="#cb82-17"></a>nAO&lt;-nA<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>p0<span class="op">*</span>r0)<span class="op">/</span>(p0<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p0<span class="op">*</span>r0)</span>
<span id="cb82-18"><a href="#cb82-18"></a>nBO&lt;-nB<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>q0<span class="op">*</span>r0)<span class="op">/</span>(q0<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q0<span class="op">*</span>r0)</span>
<span id="cb82-19"><a href="#cb82-19"></a>loglike_all&lt;-<span class="cf">function</span>(theta){</span>
<span id="cb82-20"><a href="#cb82-20"></a>  p&lt;-theta[<span class="dv">1</span>];q&lt;-theta[<span class="dv">2</span>]</span>
<span id="cb82-21"><a href="#cb82-21"></a>  r&lt;-<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q</span>
<span id="cb82-22"><a href="#cb82-22"></a>  t&lt;-nA<span class="op">*</span><span class="kw">log</span>(p<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span>nAO<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>r<span class="op">/</span>p)<span class="op">+</span>nB<span class="op">*</span><span class="kw">log</span>(q<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span>nBO<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>r<span class="op">/</span>q)<span class="op">*</span><span class="kw">is.na</span>(<span class="dv">2</span><span class="op">*</span>r<span class="op">/</span>q)<span class="op">+</span>nOO<span class="op">*</span><span class="kw">log</span>(r<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span>nAB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>q)<span class="op">*</span><span class="kw">is.na</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">/</span>q)</span>
<span id="cb82-23"><a href="#cb82-23"></a>  <span class="kw">return</span>(<span class="op">-</span>t)</span>
<span id="cb82-24"><a href="#cb82-24"></a>}</span>
<span id="cb82-25"><a href="#cb82-25"></a><span class="co">#M-step</span></span>
<span id="cb82-26"><a href="#cb82-26"></a>res1&lt;-<span class="kw">optim</span>(<span class="kw">c</span>(<span class="fl">0.33</span>,<span class="fl">0.33</span>),loglike_all)<span class="co">#这里的初值是极小值函数optim的初值设定</span></span>
<span id="cb82-27"><a href="#cb82-27"></a>theta1&lt;-res1<span class="op">$</span>par</span>
<span id="cb82-28"><a href="#cb82-28"></a>p1&lt;-theta1[<span class="dv">1</span>];q1&lt;-theta1[<span class="dv">2</span>];r1&lt;-<span class="dv">1</span><span class="op">-</span>p1<span class="op">-</span>q1</span>
<span id="cb82-29"><a href="#cb82-29"></a>loglike_obs&lt;-nA<span class="op">*</span><span class="kw">log</span>( (p1)<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p1<span class="op">*</span>r1) <span class="op">+</span><span class="st"> </span>nB<span class="op">*</span><span class="kw">log</span>( (q1)<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q1<span class="op">*</span>r1) <span class="op">+</span><span class="st"> </span>nOO<span class="op">*</span><span class="kw">log</span>( (r1)<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>nAB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p1<span class="op">*</span>q1)</span>
<span id="cb82-30"><a href="#cb82-30"></a>record[i,]&lt;-<span class="kw">c</span>(theta1,loglike_obs)</span>
<span id="cb82-31"><a href="#cb82-31"></a>theta0&lt;-theta1</span>
<span id="cb82-32"><a href="#cb82-32"></a>}</span>
<span id="cb82-33"><a href="#cb82-33"></a><span class="kw">colnames</span>(record)=<span class="kw">c</span>(<span class="st">&quot;p&quot;</span>,<span class="st">&quot;q&quot;</span>,<span class="st">&quot;logML_obs&quot;</span>)</span>
<span id="cb82-34"><a href="#cb82-34"></a>knitr<span class="op">::</span><span class="kw">kable</span>(record)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">p</th>
<th align="right">q</th>
<th align="right">logML_obs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.3143867</td>
<td align="right">0.1408525</td>
<td align="right">-1185.757</td>
</tr>
<tr class="even">
<td align="right">0.2899952</td>
<td align="right">0.1408753</td>
<td align="right">-1182.311</td>
</tr>
<tr class="odd">
<td align="right">0.2850613</td>
<td align="right">0.1408409</td>
<td align="right">-1182.213</td>
</tr>
<tr class="even">
<td align="right">0.2840780</td>
<td align="right">0.1409145</td>
<td align="right">-1182.267</td>
</tr>
<tr class="odd">
<td align="right">0.2838319</td>
<td align="right">0.1408613</td>
<td align="right">-1182.240</td>
</tr>
<tr class="even">
<td align="right">0.2838414</td>
<td align="right">0.1408557</td>
<td align="right">-1182.236</td>
</tr>
<tr class="odd">
<td align="right">0.2838414</td>
<td align="right">0.1408557</td>
<td align="right">-1182.236</td>
</tr>
<tr class="even">
<td align="right">0.2838414</td>
<td align="right">0.1408557</td>
<td align="right">-1182.236</td>
</tr>
<tr class="odd">
<td align="right">0.2838414</td>
<td align="right">0.1408557</td>
<td align="right">-1182.236</td>
</tr>
<tr class="even">
<td align="right">0.2838414</td>
<td align="right">0.1408557</td>
<td align="right">-1182.236</td>
</tr>
</tbody>
</table>
<p>In the above process, we use the <strong>optim</strong> function to find the <span class="math inline">\(p_1, q_1\)</span> to maximize the log likelihood function in the M-step. We could find that p and q soon converge to stable values, within 10 E and M repeats. The results of p, q and corresponding log-maximum likelihood values (for observed data) is shown above.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a>nA&lt;-<span class="dv">444</span>;nB&lt;-<span class="dv">132</span>;nOO&lt;-<span class="dv">361</span>;nAB&lt;-<span class="dv">63</span></span>
<span id="cb83-2"><a href="#cb83-2"></a>m&lt;-<span class="dv">10</span></span>
<span id="cb83-3"><a href="#cb83-3"></a></span>
<span id="cb83-4"><a href="#cb83-4"></a>record&lt;-<span class="kw">matrix</span>(m<span class="op">*</span><span class="dv">3</span>,m,<span class="dv">3</span>)</span>
<span id="cb83-5"><a href="#cb83-5"></a><span class="co">#根据理论推导的（全数据）条件似然的极大值点表达式，写出下列递推函数</span></span>
<span id="cb83-6"><a href="#cb83-6"></a><span class="co">#并同时计算log max likelihood values(for observed data)</span></span>
<span id="cb83-7"><a href="#cb83-7"></a><span class="co">#自变量p0,q0，输出结果是p1,q1</span></span>
<span id="cb83-8"><a href="#cb83-8"></a>recur&lt;-<span class="cf">function</span>(p0,q0){</span>
<span id="cb83-9"><a href="#cb83-9"></a>  r0&lt;-<span class="dv">1</span><span class="op">-</span>p0<span class="op">-</span>q0</span>
<span id="cb83-10"><a href="#cb83-10"></a>  nAO&lt;-nA<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>p0<span class="op">*</span>r0)<span class="op">/</span>(p0<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p0<span class="op">*</span>r0)</span>
<span id="cb83-11"><a href="#cb83-11"></a>  nBO&lt;-nB<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>q0<span class="op">*</span>r0)<span class="op">/</span>(q0<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q0<span class="op">*</span>r0)</span>
<span id="cb83-12"><a href="#cb83-12"></a>  c1&lt;-<span class="dv">2</span><span class="op">*</span>nA<span class="op">+</span>nAB<span class="op">-</span>nAO</span>
<span id="cb83-13"><a href="#cb83-13"></a>  c2&lt;-<span class="dv">2</span><span class="op">*</span>nB<span class="op">+</span>nAB<span class="op">-</span>nBO</span>
<span id="cb83-14"><a href="#cb83-14"></a>  c3&lt;-<span class="dv">2</span><span class="op">*</span>nOO<span class="op">+</span>nAO<span class="op">+</span>nBO</span>
<span id="cb83-15"><a href="#cb83-15"></a>  p1&lt;-c1<span class="op">/</span>(c1<span class="op">+</span>c2<span class="op">+</span>c3)</span>
<span id="cb83-16"><a href="#cb83-16"></a>  q1&lt;-c2<span class="op">/</span>(c1<span class="op">+</span>c2<span class="op">+</span>c3)</span>
<span id="cb83-17"><a href="#cb83-17"></a>  r1&lt;-<span class="dv">1</span><span class="op">-</span>p1<span class="op">-</span>q1</span>
<span id="cb83-18"><a href="#cb83-18"></a>  loglike_obs&lt;-nA<span class="op">*</span><span class="kw">log</span>( (p1)<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p1<span class="op">*</span>r1) <span class="op">+</span><span class="st"> </span>nB<span class="op">*</span><span class="kw">log</span>( (q1)<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q1<span class="op">*</span>r1) <span class="op">+</span><span class="st"> </span>nOO<span class="op">*</span><span class="kw">log</span>( (r1)<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>nAB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p1<span class="op">*</span>q1)</span>
<span id="cb83-19"><a href="#cb83-19"></a>  <span class="kw">return</span>(<span class="kw">c</span>(p1,q1,loglike_obs))</span>
<span id="cb83-20"><a href="#cb83-20"></a>}</span>
<span id="cb83-21"><a href="#cb83-21"></a><span class="co">#下面写出对数最大似然的值（对于观测数据）</span></span>
<span id="cb83-22"><a href="#cb83-22"></a></span>
<span id="cb83-23"><a href="#cb83-23"></a>p0&lt;-<span class="fl">0.3</span>;q0&lt;-<span class="fl">0.3</span></span>
<span id="cb83-24"><a href="#cb83-24"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb83-25"><a href="#cb83-25"></a>  record[i,]&lt;-<span class="kw">c</span>(<span class="kw">recur</span>(p0,q0))</span>
<span id="cb83-26"><a href="#cb83-26"></a>  p0&lt;-record[i,<span class="dv">1</span>]</span>
<span id="cb83-27"><a href="#cb83-27"></a>  q0&lt;-record[i,<span class="dv">2</span>]</span>
<span id="cb83-28"><a href="#cb83-28"></a>}</span>
<span id="cb83-29"><a href="#cb83-29"></a><span class="kw">colnames</span>(record)=<span class="kw">c</span>(<span class="st">&quot;p&quot;</span>,<span class="st">&quot;q&quot;</span>,<span class="st">&quot;logML_obs&quot;</span>)</span>
<span id="cb83-30"><a href="#cb83-30"></a>knitr<span class="op">::</span><span class="kw">kable</span>(record)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">p</th>
<th align="right">q</th>
<th align="right">logML_obs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.3140455</td>
<td align="right">0.1155000</td>
<td align="right">-1173.108</td>
</tr>
<tr class="even">
<td align="right">0.3014177</td>
<td align="right">0.1035673</td>
<td align="right">-1169.896</td>
</tr>
<tr class="odd">
<td align="right">0.2983656</td>
<td align="right">0.1027841</td>
<td align="right">-1169.824</td>
</tr>
<tr class="even">
<td align="right">0.2977742</td>
<td align="right">0.1027163</td>
<td align="right">-1169.822</td>
</tr>
<tr class="odd">
<td align="right">0.2976650</td>
<td align="right">0.1027079</td>
<td align="right">-1169.822</td>
</tr>
<tr class="even">
<td align="right">0.2976451</td>
<td align="right">0.1027065</td>
<td align="right">-1169.822</td>
</tr>
<tr class="odd">
<td align="right">0.2976415</td>
<td align="right">0.1027063</td>
<td align="right">-1169.822</td>
</tr>
<tr class="even">
<td align="right">0.2976408</td>
<td align="right">0.1027063</td>
<td align="right">-1169.822</td>
</tr>
<tr class="odd">
<td align="right">0.2976407</td>
<td align="right">0.1027063</td>
<td align="right">-1169.822</td>
</tr>
<tr class="even">
<td align="right">0.2976407</td>
<td align="right">0.1027063</td>
<td align="right">-1169.822</td>
</tr>
</tbody>
</table>
<p>The above code is written according to the recursive relation of A and Bd, and the theoretical result is <span class="math display">\[
p_1=\frac{C_1(p_0)}{C_1(p_0)+C_2(p_0)+C_3(p_0)},
\]</span> <span class="math display">\[
q_1=\frac{C_2(p_0)}{C_1(p_0)+C_2(p_0)+C_3(p_0)},
\]</span> where <span class="math display">\[
\left\{\begin{array}{l}
C_{1}=2 n_{A .}+n_{A B}-n_{A .} \frac{2 p_{0} r_{0}}{p_{0}^{2}+2 p_{0} r_{0}}=\frac{2 p_{0}^{2}+2 p_{0} r 0}{p_{0}^{2}+2 p_{0} r 0} n_{A .}+n_{A B} \\
C_{2}=2 n_{B .}+n_{A B}-n_{B .} \frac{2 q_{0} r_{0}}{q_{0}+2 q_{0} r_{0}}=\frac{2 q_{0}^{+2 q_{0} r 0}}{q_{0}^{+2 q_{0} r 0}} n_{B .}+n_{A B} \\
C_{3}=2 n_{O O}+n_{A .} \frac{2 p_{0} r_{0}}{p_{0}^{2}+2 p_{0} r_{0}}+n_{B .} \frac{2 q_{0} r_{0}}{q_{0}^{2}+2 q_{0} r_{0}}
\end{array}\right.
\]</span></p>
</div>
</div>
<div id="question-2-3" class="section level1">
<h1>Question 2</h1>
<p>Exercises 3 (page 204, Advanced R).Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list: <span class="math display">\[
\begin{aligned}
&amp;\text { formulas &lt;- list ( }\\
&amp;\begin{aligned}
m p g &amp; \sim d i s p \\
m p g &amp; \sim I(1 / d i s p) \\
m p g &amp; \sim d i s p+w t \\
m p g &amp; \sim I(1 / d i s p)+w t\\
)
\end{aligned}
\end{aligned}
\]</span></p>
</div>
<div id="answer-28" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="kw">attach</span>(mtcars)</span>
<span id="cb84-2"><a href="#cb84-2"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb84-3"><a href="#cb84-3"></a>  mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb84-4"><a href="#cb84-4"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb84-5"><a href="#cb84-5"></a>  mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb84-6"><a href="#cb84-6"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb84-7"><a href="#cb84-7"></a>)</span>
<span id="cb84-8"><a href="#cb84-8"></a><span class="co">#lapply function</span></span>
<span id="cb84-9"><a href="#cb84-9"></a>lap_models&lt;-<span class="kw">lapply</span>(formulas,lm)</span>
<span id="cb84-10"><a href="#cb84-10"></a>lap_models</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<p>The results above are fitted linear models to the mtcars using the formulas for <strong>loops</strong>.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a><span class="co">#loops</span></span>
<span id="cb86-2"><a href="#cb86-2"></a>loop_models&lt;-<span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>,<span class="kw">length</span>(formulas))</span>
<span id="cb86-3"><a href="#cb86-3"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(formulas)){</span>
<span id="cb86-4"><a href="#cb86-4"></a>  loop_models[[i]]&lt;-<span class="kw">lm</span>(formulas[[i]])</span>
<span id="cb86-5"><a href="#cb86-5"></a>}</span>
<span id="cb86-6"><a href="#cb86-6"></a>loop_models</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<p>The results above are fitted linear models to the mtcars using the formulas for <strong>lapply()</strong>.</p>
<p>We can find that both results are the same.</p>
</div>
<div id="question-3-2" class="section level1">
<h1>Question 3</h1>
<p>Excecises 3 (page 213-214, Advanced R)</p>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial. <span class="math display">\[
\begin{array}{l}
\text { trials &lt;- replicate( } \\
100 \text { , } \\
\text { t. test(rpois(10, 10), rpois (7, 10)), } \\
\text { simplify = FALSE }\\
)
\end{array}
\]</span> Extra challenge: get rid of the anonymous function by using [[ directly.</p>
<p>Note: the anonymous function is defined in Section 10.2 (page 181, Advanced R)</p>
</div>
<div id="answer-29" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb88-2"><a href="#cb88-2"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">100</span>, <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),<span class="dt">simplify =</span> <span class="ot">FALSE</span>)</span>
<span id="cb88-3"><a href="#cb88-3"></a>pvalue&lt;-<span class="kw">sapply</span>(trials,<span class="cf">function</span>(x) x[]<span class="op">$</span>p.value)</span>
<span id="cb88-4"><a href="#cb88-4"></a><span class="kw">print</span>(pvalue)</span></code></pre></div>
<pre><code>##   [1] 0.125949930 0.800930340 0.952855296 0.452959855 0.483083494 0.320611150
##   [7] 0.706780317 0.063119508 0.621092522 0.162276154 0.820427933 0.053095862
##  [13] 0.914712292 0.792200487 0.390189150 0.538640844 0.143988430 0.788393427
##  [19] 0.672267752 0.216269737 0.534646674 0.809214595 0.960266963 0.569466705
##  [25] 0.632178255 0.582700745 0.254983356 0.282179271 0.005098396 0.162075913
##  [31] 0.877783340 0.654074362 0.169752059 0.754440969 0.764179721 0.026793925
##  [37] 0.114713268 0.028496672 0.598991648 0.885239097 0.719211331 0.409696973
##  [43] 0.847167535 0.764438221 0.418863595 0.519132187 0.463910875 0.286785195
##  [49] 0.875030871 0.241068098 0.838739962 0.348638336 0.622633185 0.232606824
##  [55] 0.398974335 0.970218660 0.860375193 0.909101881 0.851096482 0.523397015
##  [61] 0.746860279 0.764894312 0.025411594 0.019036587 0.397989350 0.714919878
##  [67] 0.631471636 0.110724341 0.927143289 0.041990454 0.208117904 0.607178718
##  [73] 0.906974079 0.554576397 0.194404278 0.771678543 0.396686801 0.803958799
##  [79] 0.768941702 0.994186553 0.194123673 0.316046848 0.415575715 0.619270683
##  [85] 0.295629509 0.942948679 0.607585865 0.718018866 0.761453123 0.120281420
##  [91] 0.577128336 0.019315507 0.483007741 0.108496205 0.469918314 0.011282410
##  [97] 0.231024499 0.955230239 0.964944823 0.281065452</code></pre>
</div>
<div id="question-4" class="section level1">
<h1>Question 4</h1>
<p>Excecises 3 (page 213-214, Advanced R)</p>
<p>Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</p>
</div>
<div id="answer-30" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a>f4=<span class="cf">function</span>(x,fun4,fun4_value){</span>
<span id="cb90-2"><a href="#cb90-2"></a>    row4=<span class="kw">length</span>(x[,<span class="dv">1</span>]);col4=<span class="kw">length</span>(x[<span class="dv">1</span>,])<span class="co">##行列数</span></span>
<span id="cb90-3"><a href="#cb90-3"></a>    i4=<span class="kw">vapply</span>(x,fun4,fun4_value)<span class="co">##对矩阵每个单独值，类似lapply函数单独求值</span></span>
<span id="cb90-4"><a href="#cb90-4"></a>    <span class="kw">print</span>(<span class="kw">matrix</span>(i4,<span class="dt">ncol=</span>col4))<span class="co">##返回矩阵形式的值</span></span>
<span id="cb90-5"><a href="#cb90-5"></a>  }</span>
<span id="cb90-6"><a href="#cb90-6"></a><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>,<span class="dt">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    4
## [2,]    2    5
## [3,]    3    6</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a><span class="kw">f4</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>,<span class="dt">ncol=</span><span class="dv">2</span>),<span class="cf">function</span>(x){x<span class="op">^</span><span class="dv">2</span>},<span class="kw">c</span>(<span class="dv">0</span>))</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1   16
## [2,]    4   25
## [3,]    9   36</code></pre>
</div>
<div id="section-9" class="section level1">
<h1>2020-12-01</h1>
</div>
<div id="question-1-2" class="section level1">
<h1>Question 1</h1>
<p>Write an Rcpp function for Exercise 9.4 (page 277, Statistical Computing with R).</p>
</div>
<div id="answer-31" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a><span class="kw">library</span>(Rcpp)</span>
<span id="cb94-2"><a href="#cb94-2"></a><span class="co">#metro function returns rate and chain</span></span>
<span id="cb94-3"><a href="#cb94-3"></a><span class="kw">library</span>(StatComp20056)</span></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;StatComp20056&#39;</code></pre>
<pre><code>## The following objects are masked _by_ &#39;.GlobalEnv&#39;:
## 
##     count5test, eqdist.nn, eqtest.permu, ftest, Gelman.Rubin, lap,
##     maxout, power, power_stu, ranfe, rw.Metropolis, sk, Tn</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     power</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a><span class="co">#sourceCpp(&quot;./metro.cpp&quot;)</span></span>
<span id="cb98-2"><a href="#cb98-2"></a>sigma&lt;-<span class="kw">c</span>(<span class="fl">0.05</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">16</span>)</span>
<span id="cb98-3"><a href="#cb98-3"></a>x0&lt;-<span class="dv">5</span>;N&lt;-<span class="dv">5000</span></span>
<span id="cb98-4"><a href="#cb98-4"></a>a1&lt;-<span class="kw">as.numeric</span>(<span class="kw">metro</span>(N,sigma[<span class="dv">1</span>],x0))</span>
<span id="cb98-5"><a href="#cb98-5"></a>a2&lt;-<span class="kw">as.numeric</span>(<span class="kw">metro</span>(N,sigma[<span class="dv">2</span>],x0))</span>
<span id="cb98-6"><a href="#cb98-6"></a>a3&lt;-<span class="kw">as.numeric</span>(<span class="kw">metro</span>(N,sigma[<span class="dv">3</span>],x0))</span>
<span id="cb98-7"><a href="#cb98-7"></a>a4&lt;-<span class="kw">as.numeric</span>(<span class="kw">metro</span>(N,sigma[<span class="dv">4</span>],x0))</span>
<span id="cb98-8"><a href="#cb98-8"></a><span class="co">#acceptance rates with different variances</span></span>
<span id="cb98-9"><a href="#cb98-9"></a><span class="kw">print</span>(<span class="kw">c</span>(a1[<span class="dv">1</span>],a2[<span class="dv">1</span>],a3[<span class="dv">1</span>],a4[<span class="dv">1</span>]))</span></code></pre></div>
<pre><code>## [1] 0.9818 0.7082 0.3402 0.1058</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a><span class="co">#compare different variances</span></span>
<span id="cb100-2"><a href="#cb100-2"></a><span class="co">#use R plot</span></span>
<span id="cb100-3"><a href="#cb100-3"></a><span class="co">#par(mfrow=c(2,2)) #display 4 graphs together</span></span>
<span id="cb100-4"><a href="#cb100-4"></a>refline &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">log</span>(<span class="fl">0.05</span>),<span class="op">-</span><span class="kw">log</span>(<span class="fl">0.05</span>))</span>
<span id="cb100-5"><a href="#cb100-5"></a>a&lt;-<span class="st"> </span><span class="kw">cbind</span>(a1,a2,a3,a4)</span>
<span id="cb100-6"><a href="#cb100-6"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb100-7"><a href="#cb100-7"></a>  <span class="kw">plot</span>(a[<span class="op">-</span><span class="dv">1</span>,j],<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(a[<span class="op">-</span><span class="dv">1</span>,j]))</span>
<span id="cb100-8"><a href="#cb100-8"></a>  <span class="kw">abline</span>(<span class="dt">h=</span>refline)</span>
<span id="cb100-9"><a href="#cb100-9"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAZlBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6ZpA6ZrY6kNtmAABmADpmOgBmZjpmZrZmtttmtv+QOgCQZgCQ2/+2ZgC2Zjq2Zma22/+2///bkDrbtpDb////tmb/25D//7b//9v///+iPZrwAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIXElEQVR4nO3dC3ubNhgFYKVpdom3dc3qbfXqy/f//+TAICFA0pHETdjnPH1aAugDvRHYThVbCROM2voESg+BQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoHMDKR2k2WAjp++y+VNqZdvs5TbMMsA3X1+qnCuh68zlNsyiwBdD+8V0ud68fT6Y3K5TbMQ0Fe5fbzXi+dqLNlVki/tqZl6oIUusWr0nMoYQWUCXQ+fvt+H0Nl3l35yoEqmuZA+z1QuP6UCrVxuuQMRaK72BFr4QMuWW+5ABJqrPYEWPpC73PJODwg075H2DeR8SUagrtzyQJNfFZcONLl/BPK39R5hUsXJO6aUI9CoSv8HZm4ge+VwB3AaLqBpZ17iw/yWQOMC2S2nZVmgbq8aKO7Ulbv+IwCp0WIekHLV3xkQuqv7gCLO/mmB1PMBBS47D1DMVfaUQGrHQLvJVkD+qs05uXeYYwR5elLaCHJU1evGQGa3uYF6TXu1lWPvYAoA0j11Aw1atV8+KJAaAykCmXGirGcuZjjZQMMbU/e3DaRKBjpVp3WfOnXqT38ZlntWoNPLN7ke6pkL8wKpKCDlAlKD3UfLawI1k6duH68/4oD6XwyAmqGj+9oDMu1M1wyQCgD1VKzF9YD0zMTj649TeIZZ75vfniIC0puVEW2vP6uS0ivDQDb1vVXvQSGt3+kjSOqZZvEjKBGo6U+zS/dDjXggpZvqM2iBOv7Efqfdg1qW60HlAal4IA3QPQOYA2h4GeMkAVWPYs1FdvuAQMoGUvFAXVc6INUD0k2set0tbGOg2HIIqHuUjgFSMUC6mZhbuVmvei0T+70wkBLz3bM61F0hBkgNgIYWZhwoN5BxdQL1yqX1e2Ug5QXqMSYBmSrWkwDpNtlA5gxKAFJinZd1otI/6Qwgu8UDAA2/6+I66f6XIqPtAKgD3RGQJ7MCDW9j0g5K+88DAjlWeOsBIEetIoACCW0NsIZK9oDcOk8HFDrEwkD/uJ8jzwcU2hidlYGuX/TXlzfPi4h9AYVWZwEd2t9vOvpehT4AkNmcAVS9+qx/xeny5v9FpycHqn8T7OUP/28zoyr9o89jEO7lhKZ5QO0gmpgHBjrVI2jaDWg5oHHBtYGuh3r4VH+/rw8Usbf0/ols5C2WAbTmo5iv954+i7Wpd69LrG4t5ACt+Dxo1INVgaSMZ9Lu190ZQDIHkKGZB2hSCBQNNH4pJG6iHtCwYWs9AAr+PGX8E5Sygax7o3uMzAgksh+g8YWzBNAQQwP1nw8036/m8PoUFwKKnf6CgUw3PECaxAMk0mIMOJs1/Z9Z3ncVWQMoevqLSBSQBIC0ngayB4Y+gF1S935LoPjpL5aQdelbQOY8bSCBQN24soHMIENAsjCQf/rL5kDiANLjU5+XMv8sBRQ//aVdTgESAyR9IHOX7UpIt150Uy+QOa/lgeKnv7TLkUASBhIfkLQg5QB5p79Yl7wPSIJAYgPJGEhsoEEHbCAxQHqDXWJ5oKRyvT55gLo7RACoX0yGQFIakLkVgXIOIOsePGpgAYm+8FzFfEASAhLZF5Crgb6ldCucQMNT9gLJLoFk0G8C2VdFDJC9abDfDEDWWXi7EOhRZFKABAEFzmYEJACof9TtgGLL6TtuYUCOL0LZAChwzCcA2k22AhpwuVbGHjN1BI1OosgR1P/KDRRby9HpMVC71g3kP/DDAVmNHwkosDK5mFkVDZRYe+KOOeWcQJPrEwjUd5ZLPcbTAeUUmnfHcJXg0wsCgXIEAuUItFg5Z30CgfoEAvUJBOoTCNQnEKhPIFCfQKA+gUD9koE2/4zD2eovA7T9ZxyWDVTAZxyWDuT7jMOscjkpG6iAzzgsHGj7zzgsHMj7GYfp/2GZmeKBVi63XJYEip3+UnQIBEIgkM2AdpONgOKKgu3TNk9tPm33eYoSaNp2AhFo2nYCEWjadgIRaNr2xwd6pBAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRDI/EBnlfi21LcPpZo32TVNxwvhHO+TTbKbhzI7UD3xwzv5w5XbR7X3qZ4PYZqOF8AxVQ2U3TyYuYGa/zQ7Jrx19+Wtns53aifW1E3HC+FcDzVQdvNw5gYy3U1sV32jTdPxQrjt6fWvCii7eTizA9VzPL0z9Pw5Vv3RTccL6JD1PSi3OcjcQM0ln3zhn6u7tGk6Xgg1rS+kGiizOUoZQGd9j87oYT1dckdAWcP6fH+Uz7tG7vvs6BLLuTGemmdBeXfZUzud5etObtIZD63dmzNmP04f9/Mwn/7k7PKmpxvlP9M77ueJ4n3MJ51Te43UbUzT8UI4zUuN7Oah8MUqCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACASyN6DLz5Mms6RnZ0D128yte8R9AZ2V7xNwF8uugM7qfeKEuvQUCHT7++0+Y8j5Nk4EqmdD/SuXL+53+iSQmez6a/PVsZ2jqScaEqgluP7mnjpHIA3kecdqArU0zRxnXmKunF/+lNuH5/2YCVTlv9+V+oWPYjsJgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQC+R+NMWye3gjuPgAAAABJRU5ErkJggg==" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAY1BMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6ZpA6ZrY6kNtmAABmADpmOgBmZjpmZrZmtttmtv+QOgCQZgCQ2/+2ZgC2Zjq2Zma22/+2///bkDrbtpDb////tmb/25D//7b//9v///8i3mfXAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAK60lEQVR4nO2d6YLbthWFj2NPW0/bJNOobVTPgvd/yooisZDYF/JcjvX98FDAXQ6OIUoTwQrUgyRgC5AO2AKkA7YA6YAtQDpgC5AO2AKkA7YA6YAtQDpgC5AO2AKkA7YA6YAtQDpgC5AO2AKkA7YA6YAtQDpgC5AO2AKkA7YA6YAtQDpgC5AO2AKkA7YA6YAtQDpgC5AO2AKkA7YA6YAtQDpgC5AO2AKkA7YA6YAtQDpgC5AO2AKkA7YA6YAtQDpgC5AO2AKkA7YA6YAtQDpgC5AO2AKkA7YA6YAtQDpgC5AO2AKkA7YA6YAtQDpgC5AO2AKkA7YA6YAtQDpgC5AO2AKkA7YA6YAtQDpgC5AO2AKkA7YA6YAtQDpgC5AO2AKkA7YA6YAtQDpgC5AO2AKkA7YA6YAtQDpgC5AO2AKkA7YA6YAtQDpgC5AO2AKkA7YA6YAtQDpgC5AOBpc7DSyDxpbbDwwPpJTbDwwPpJTbDwwPpJTrAR2zLYGUcj2d0gHZ9OpASrmeTumAbHp1IKVcT6d0QDa9OpBSrqdTOiCbXh145/LLn+rtCfjyx5ByPWQ7pQOy6dWBE3d//nIz5/359wHlush1yrxXzqXXB6rJlu83k75Nl9evP7rL9ZHrFDIIwcu+Pi7Tvvl4+T5dvt720kpN7a843eQ6MQy6757rYwfFeX/+5c/7FnqN3aWrynWR6+QahM3PgvT6wJnX+Yn0raFcZaccuXIkgzrKHddpnncCsPlZkF4f2F3uuE7zvBOAzc+C9PrA7nLHdZrnnQBsfhak1wd2l6voVBKaiwkaBG9oiJYKEgoqOhWEZt9xPQyqCIA/VqymOLC2nFe4olNB6NYgvx38yTMaFBrN7Q4EYvx28Cc/iUGB3+jgPSoxCNvJT2kQ/CiojUE4pUHbyuFO3ih6DHIGZRkU+M8da4NQaxBWAVjF3uexykkZBAEGBcqtVwC/E+yfq9CHQf6iV6EPg9aLhnoYtINB3o3cqWaDTMXAdFB+gOLA2nJRg5A0CCmDsIpxep3QoNUL2mo98yWGGwS3GpwAWQadBpZBjlPOIMzf53St/8bNzdYRYXYQ7EBsB9nH0D10MJxHegdhral2RWOA/jNrEGIGwRiEecCWhY7RBunxoEE4iUFGvH60Nci9m6wN0tssZZCu5RgExyAca9D11uP+qfx1/cnqptwiWt83HfExg2DTPIN0qjG93CD4BqFy3cWBE9cvf6j35+lDsbRBi9w+g7BNDRpkYiUYNH8u//Hy9UeZQVqub5AdKTVoWeES1GCQs+Oq1l0cqOyhl8vXH9f04YWNQc5chUGrdWcMwrrj2iDd46AdNDn0LbeD4Mq1BsE1CAMMcmJjBuk61tCqdRcHTmhb3p8xxiD7V78kxwzSQ4UGrYo7lfY26PYqNj/JPl7GGYRxBiFrEHY2qLRcvUFQoUWrVXLEoHWlrEGoW3dxYFW5qEEIG+R4kjbIHTm9QZ7cFoPC8wmDwtXPYZB+ZrQZFPHHMygWK9IgBDd80KD1Ymxk2IfQwu2jYKwZ/AwGOZGVqGiaGew16D/hF/BjDdoB07LFoPdf9eO3p8g7nEaDQhrVCQ16Xs71XmJvkRsNimhkYJq3GHR7azwd7X17ih/w/ckNmk5Af/ln/F/xjDHoSFR8ps2gZRM1+rLuHhd3HCo+02bQddpBfTcg9Yl30PvztH1uf37f3aDk5LjEuIgWgw56FWtYp59YmD/YoL3eB8XXmRwJuqDiU0EbYjVbDHIZ+k46sB5/gYElh1xQm3UGfbHR0ca9BnWxh0EbR1T4F65tkfmXnGAdGQZtlmWv0wapzZByKyl3JGiQHTyDQWr7W9feBinYzWsNUk7E3gYVfvRsDQr8HfqrG2eQcg1SW4OU9Wcng8o/ejYG+fcjZ3XKFb5y45wGVXz0nDXIvRxkkGlNMyj+0XPaIHe17QYp+QZVffRsDFKb1RYbpJa4hEGOSRuDlsYmSB1zD6r46LnHILuwIQYtRQ4wKPrRs6MzZJBRvaxdD+UMUsvatKe2sOthlUEmrHTJxYGV5TyDrGkpg/S4WgyZs1MGmX0B21h7SzLI3IpS5RyD7g/nB7DX2qB5RNsyL6LCIJ1daJATVkhxoKXQIJUxyLihzEaKG6TmQLtryg1aWuofJqyQ4kBLkUEqbpCy9gUM0uuHa5Bdog6as/XUpzHICdNLXCL1RdQgWxPKZtsEp6s1SHfQ2XAKFVIcaNnbIDMAE5o1aNWVbVCy3GlgGbS6RuSBiYSZhBlcrrANMWWgyyV2kK22maTvoNU1Ig9MJMwkNunNBqmf1CCnDEw5hEIyBgWEJikOrC+H+NRmDN4usAN+GpT1O1h0ZVAgIJbYF1hfDvGpzdhOBsUCUuPtgfXlEJ/ysj67QcFXz03pRKd6g9TJDAqWQ3zKyxprUEHXhJrGwO5yyamhBpV0TahpDOwul5x6GDTcoHhRRB+UqWkM7C6XnPINiqchch0ci3VNqGkM7C6XnHoYlJvazsK7CBZKFE0HZBOrA7vLpacqdCByXdW1uF9x4J2eL/1PT9XpKCmaDijuVxw40fWl/+mpKh1FRdMBxf2KA1Xvl/63TWVozixOrOkQ/9L/knJtUxmaM4sTqzp0fel/21SG5szixKoOXV/63zaVoTmzOLGyQ+RL/+s/LOgRMSKzOLG5w8hybVldmcWJDR1KPzgspy2rK7M4saHDw6AMkgxqprhlcaDlYVCGh0FH9B2Q1UVxy+JASrn9wPBASrn9wPBASrn9wPBASrn9wPDAwnKngWRQWdHMfN90b3pf+Jiimfm+6YdB+1bvDB9TNDPfN/0waN/qneFjimbm+6YfBu1bvTN8TNHMfN/0w6B9q3eG/3yALUA6YAuQDtgCpAO2AOmALUA6YAuQDtgCpAO2AOmALUA6YAuQDtgCpAO2AOlgeMXXxDnzIB8vwPwluybVv0hzuZ8pbU5Pgb50n+l8Z/SMZ4iPl1v0dTr2aFL9i0xPTAY1pydBV7bPfDbmUvHV3W9P06n963J+dkr1L9K8P08GNaenQVe2j1luZd7tL9qk+hfp3OvXf90Mak5Pg57kAPd/yhE9iB/ncluPTvUvci2ne1Bregb0JAeYn/LVT/zX213apPoXqdTpiTQZ1JieAz3JAdpEvep7dMMKp38VcSKDmrb16/1Vvu05co850VOs5cZ4nd8Ftd1lr8txlt9PcpNueGm1317Z/Dp9Oc/LfP2bs7cnfaq4/Z3e5TxvFO97vkrT8hyZckyqf5Fm/lWjOT0F+tI/P2ALkA7YAqQDtgDpgC1AOmALkA7YAqQDtgDpgC1AOmALkA7YAqQDtgDpgC1AOmALkA7YAqQDtgDpgC1AOmALkA7YAqQDtgDpgC1AOmALkA7YAqQDtgDpgC1AOmALkA7YAqQDtoBaLpFvkd0LHNqtn/nE74Hg0G7dzCd+jwSHdutmPvF7JDi0WxEf/366nxgKfFvjcuL3SHBotyIuX/+r3n4N2aBP/B4JDu1WwnI29W/zo8tyRtN8D/rDoPnY7vvf/aNz5sTvkeDQbiUsBgX+xxTmxO+RcnBksyJma+Yzzpun2H3gp99B6vXLb7fbccyHh0FK/e8fwF9jNjwMEgbYAqQDtgDpgC1AOmALkA7YAqQDtgDpgC1AOmALkA7YAqQDtgDpgC1AOmALkA7YAqQDtgDpgC1AOmALkA7YAqQDtgDpgC1AOmALkA7YAqQDtgDpgC1AOv8Hp0v5koqLvHEAAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>The function <strong>metro</strong> is defined in “metro.cpp”. It returns the corresponding acceptance rate and the chain with given chain length, <span class="math inline">\(\sigma\)</span> and initial value. The acceptance rates and plots of each chain is shown above.</p>
</div>
<div id="question-2-4" class="section level1">
<h1>Question 2</h1>
<p>Compare the corresponding generated random numbers with those by the R function you wrote before using the function “qqplot”.</p>
</div>
<div id="answer-32" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a>quan&lt;-(<span class="dv">1</span><span class="op">:</span>N)<span class="op">/</span>N</span>
<span id="cb101-2"><a href="#cb101-2"></a>theo1&lt;-<span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>quan[<span class="dv">1</span><span class="op">:</span>(N<span class="op">/</span><span class="dv">2</span>)])</span>
<span id="cb101-3"><a href="#cb101-3"></a>theo2&lt;-<span class="op">-</span><span class="kw">rev</span>(theo1)</span>
<span id="cb101-4"><a href="#cb101-4"></a>theo&lt;-<span class="kw">c</span>(theo1,theo2)</span>
<span id="cb101-5"><a href="#cb101-5"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb101-6"><a href="#cb101-6"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</span>
<span id="cb101-7"><a href="#cb101-7"></a>  <span class="kw">qqplot</span>(a[<span class="op">-</span><span class="dv">1</span>,j],theo,<span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),<span class="dt">ylab =</span> <span class="st">&quot;Sample quantile&quot;</span>)</span>
<span id="cb101-8"><a href="#cb101-8"></a>  <span class="kw">abline</span>(<span class="dt">coef =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb101-9"><a href="#cb101-9"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAY1BMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6ZpA6ZrY6kNtmAABmADpmOgBmZrZmtttmtv+QOgCQZgCQ2/+2ZgC2Zjq22/+2/7a2///bkDrbtpDb////tmb/25D//7b//9v///85hKq0AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJtklEQVR4nO2diXbbNhREx7XdxUrbpFbbqJFt/v9XVgRILSQgPizkDGXdHquM9QCM52AjCEFo7lwFbAHqgC1AHbAFqAO2AHXAFqAO2ALUAVuAOmALUAdsAeqALUAdsAWoA7YAdcAWoA7YAtQBW4A6YAtQB2wB6oAtQB2wBagDtgB1wBagDtgC1AFbgDpgC1AHbAHqgC1AHbAFqAO2AHXAFqAO2ALUAVuAOmALUAdsAeqALUAdsAWoA7YAdcAWoA7YAtQBW4A6YAtQB2wB6oAtQB2wBagDtgB1wBagDtgC1AFbgDpgC1AHbAHqgC1AHbAFqAO2AHXAFqAO2ALUAVuAOmALUAdsAeqALUAdsAWoA7YAdcAWoA7YAtQBW4A6YAtQB2wB6oAtQB2wBagDtgB1wBagDtgC1AFbgDpgC1AHbAHqgC1AHbAFqAO2AHVwunzf4PHH9oUmRRMcr/YPr7vHH++bIoewGpIN+vj20hwManY/fS8xqCDtMnTewBzfX7xvvjqD9rdtEM5+zAkcfQ3aHn7KylcG/SvSUrT4PmiHr+UCdEH/irQUjsMoBjy8VhCgC/pXpKWoLEAX10WjuRsUAQWjWDUFwuD0irQ0rvvpuNVh/jg7xPHFlKyyirrZVcObA399fDGlrCykbna1gPvvvHuGPWllJXr0IxfOmll6H/Ry7IZurQ/yt6YYzH4QiR4nr6ymbnYV6P3pW1n/a3P6/uL9i59D39jN6ml143yJI2e5ozfoxpY7QgtA/WzaloH/3/aUUdmCWUniORgvj2WvB30pu00dZCfCqPpkjmLVqJxdKcP2dXIKofBgFserj29Tw7xfr95fizGXuwiDDuiiHzLncbzaTvbOzqB21dGtz05kJ8DlEv3lwIVQgmAm/YXhcUYb0lmziyzMmstdgAt/huM6AgnCufQX0UpxojXo7dmFDWZLocGUC84Z2ZO3aP80FbuiGjRhT96i/eRyvb9de2qutEdzufOCywoUijBn1V/YblYPUQ+vBy9j/ZW53Bm5qDuxRh/5dUEgJbscpmuPizJnV0HSfNllCLD5k2NQ38bWfLMKqz9ZE8XHH7unfhjPxVzuLFjdaXInivt2d8dqn82ba48LNufaX7QTnLdfvruffMzlVsfeuny4Od/+ot3d0S55rNSgJHearD6oXUrcvqy0iaX6kzXMb5/akaxoECMZlGzP55oHZdjzmQxK65tPyZID1/ngMNOeghpU9lhsaYNy7SlpYtvJZaEq5dYgu/o0JQat5slq4sxwmDo7cC1PVovsKTDofbOKJlZoT8koVjSRXsigYntuex5UwZ5bNqisbz5lkxxYZ6Orudzc/OvYU/DYR/qzGtXsyVsP8s7oLncM7Skqy5z4GKi+Ba+qPSU1SPPzYpXtyeuD3CehdmWfhzKXm5ZrbXvyhnk3jl2vP5ObrMzlJjCDPXPNg3b9M/now/mk7EzMYs9MBrUPPjqW2v4ykz0zGXS2x2qZDVSz2XMTNWjkTsW85+uDuiq0QB80qz2z3axOromkZRdl3trjSsgIrHG4ibncq5nMbk/uRLHC4SYlifs85rcnd/OCwuEmi9iTu/1F4HCTZewpqUHUm9WF3GkK+iDmgtlStceVlRHIPtxkOXeaVS7aL2nPCg1atPo06zNoYXuSDSIfbrJ09WnWVYMI9qzKIIY9s61J1yv3lILiz2qealCalys4OZDyXIxlz0qerNKqT7OKZ/NMe1awu+NgCdGevPWgGnNFY7nOEqY/2vMg7wjVH2WDekOY9mQZtMyHeo+GUOtP3ig2OXyVH49zsoPsT+ai/QSlx+OcucHtgJrcRfsJyg43OfeC7k9OH/T289RdWPx4nOlyL6zg+5Nl0PNUJ51fgy6dEPAnq4kZzg9q/6j043EGRij4M08n3USPx7n2Nw9/56LY/szTSeeUO7Kh85HszzyddMc1Kwfljl2QaF9N0c3q5EzabFDABBV/Zr0XMxoU7o9E/OEbFLRAx59Zb1YNBg1mzafLhj9+eZAeWO8EqstZc3NuGy4MI4LkwGonUI1mzcdS+glQQf7VQHJgpROoRrNmb1pXlkj7anInitVPoELXwnD8p4g/OX1QxROojjZg0Ohk/Mka5qudQIXm1KiUTDkH1QPt2eEs49O/xUD1QHt2OM9Ys/5kGPT2/OLW4yvscvUjlVkBByQGuvlh+/C5wkTRz5dLclkAJAa6c6fcsf/FJ1ChkZkNXgFpgW4J1S+6Fm9/QZoAEkgLdOut3XPBu0GBQGeQ737KJ4r9jzRIDGx7Hrc90fBwYzI7/R4o3aD9w+v7pq0709/PUqdcNkgN3LsdwG/PpduAV0OqQZWJZ6v8Tnl0hWyV3ymPrpCt8jvl0RWyVX6nPLpCtsrvlEdXyFb5nfLoCtkqv1MeXSFb5XfKoytkq/xOefQnBGwB6oAtQB2wBagDtgB1wBagDtgC1AFbgDpgC1AHbAHqgC1AHbAFqAO2AHUwT7bth88Sn0C6084DO7Cje3JiCTyRM0iShSEl2Ey7nzjxa5Q+vh1s2I3Ft4fS7EMOxRJ0ycIH/aQLQ0KsGb8XP+3Q025nwDCNzyq0JyeSwOMO7q0iDPZQO+ZPVo0Y1ZWrNoQSeHaPf4UMyhCG1AQW9j/9u7nSPVxhtDXA/0nxPTnhvQSHVME+KEMYUoKt7NrNxDn7RMYnnfsaEqknsaPR25YUNChDGBJizfhzvtK3Yu3DfXTcoEACV37s0N4MYbCH2vFdRvJ+0FB1uNrEIkfruzRhg9KFwR5qYtfOTfzfY+4Rd34+swv9udc66WCCLr+WsQ2JwlpgD7XjP2Ke2MTCZ1/Fh/mJw7KCNShDGOyhCbSdQOLnzN1O9gDRiWIsQUd4Jp0uDAmxCeyv3QUE6drF2Ipd5FYjmsATudVIFoaU4M8I2ALUAVuAOmALUAdsAeqALUAdsAWoA7YAdcAWoA7YAtQBW4A6YAtQB2wB6oAtQB2wBagDtgB1wBagDtgC1AFbgDpgC1AHbAHqgC1AHbAFqAO2AHXAFqAO2ALUAVuAOmALSKTsJNUMsGxxpbxvys43SgfLFlfIvvDLqzLAssWVse83ry0Ili3Owsff/kt0gtt47ga1W5/+ad7+iBwVdjeo39f6m//XttuQ2W9SvBvUWdB/L2743QXBssUZ6AyKfBfT3aDOmn6z972Jjdk//Bn/Ssq7QQf++x349T6KrQSwBagDtgB1wBagDtgC1AFbgDpgC1AHbAHqgC1AHbAFqAO2AHXAFqAO2ALUAVuAOmALUAdsAeqALUAdsAWoA7YAdcAWoA7YAtQBW4A6YAtQB2wB6vwPf9YzodKIEVAAAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAY1BMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6ZpA6ZrY6kNtmAABmADpmOgBmZrZmtttmtv+QOgCQZgCQ2/+2ZgC2Zjq22/+2/7a2///bkDrbtpDb////tmb/25D//7b//9v///85hKq0AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJpUlEQVR4nO2dC1fjNhSEhwX6gD52S9puugH0/39lsWwngcjx1ZXkGYd850DT7NXV7KwsybKiIFw5C9gC1AFbgDpgC1AHbAHqgC1AHbAFqAO2AHXAFqAO2ALUAVuAOmALUAdsAeqALUAdsAWoA7YAdcAWoA7YAtQBW4A6YAtQB2wB6oAtQB2wBagDtgB1wBagDtgC1AFbgDpgC1AHbAHqgC1AHbAFqAO2AHXAFqAO2ALUAVuAOmALUAdsAeqALUAdsAWoA7YAdcAWoA7YAtQBW4A6YAtQB2wB6oAtQB2wBagDtgB1wBagDtgC1AFbgDpgC1AHbAHqgC1AHbAFqAO2AHXAFqAO2ALUAVuAOmALUAdsAeqALUAdsAWoA7YAdcAWoA7YAtQBW4A6YAtQB2wB6oAtQB2wBagDtgB1wBagDtgC1AFbgDpgC1AHbAHq4PDy5RG3PzYPNCmaYP9qd/O0vf3x8ljkEFZDtkGv3x7Cm0Fh++V7iUEFZZdh8Abm+PHFy+PXaNDusg3C0Y+5QGRsQZu3n7L6lcH4G3klOvo+aIuv5QJ0wfgbeSUib6MYcPNUQYAuGH8jr0RlAcJ0fTTC1aAp0I9inmG+lgBp0P9GdguK3c/AJQ/zsQHF1gN7kcoKVBkurXA1KA3CUQcUrgZ9BEcNyDOKvd2i7ruhi+yD3t2iIlxb0Af2/iAMGmEuOr54+a2fQ1/czWrvy96do1ZkKz6+GA26tOUOjB3P+8khJsJPy/f/2RzmQWULZiWFW3DU+RQZdGhBhXoq5KgGxrErsYiIZIlUksqa6qYrYt8vj1fZuz80Z9m/ev02N8z369W7czHmettz6HgS/ngM2sz2ztGgbtUxrs/OpGNzGNmTt+6JtybyjC8MjzO6kMGa7cTCrLne1uCY1J+bE40vJhvFgc6g5/sY9mG2dFYLAcz541q0v5uLXU0LmjEnhphz7V/tZpfr+9u1u3DmejTX25C5xtMHmbONL2w3q29RN09vXk71V+Z6mzF7cQ1h5nzFilqmcwi4GnSudlj98Rg0XmPrvVnN8Mc1Ubz9sb0bh3Ev5npr89GcOSFzf34a2A1Mu253xxqfzZ/YM6tjNuAksJvgPP/8Pf74MddblWx7fBPFh7jksUKD8u1x9UHdUuLmYYWXmMMe3zC/uetGsqJBjGCQy55PNA/y2fNpDPKZE0tmB67xwaHfH38LKnsstqRB3otrKO0O3MwuC1Wpt5gyfwoMWseTVefYdZTAHbiGJ6vF9hQY9PKof4mV21MyihVNpBcxqIY/lzsPqnB19XmqB1LSnaSvZE/RRBElc0Vzvb7s1fzxP/YR/qxGRXt860G9M6rLHVXtcV1i2lvwKvtT0IIkPy+G2v64+qD4Saht2eehzPVmJa3tTvAN83EcO99+ZjdZmeu108KeVvOg7fhMfvLhfFY6C/UvriFv9cDQP/gYWGj7Syt7Ghl0tMdqmQ1Uzey5jBbUrvmEdn3Q0ISW6INa2tPsZnV2TSQv3Rna2uMe5osPNzHXO5enrT3eiWKFw01KCh+ytLbHu3lB43CTBezxbn9RONykdeczVpMdqHG4yUL2FPRB1AWzpjOfD1U5AumHmyxnzyoX7RdsPmGNBi1qz/oMWtiebIPYh5ssbc/KWtDy9qzKIIY9zdak69W7L8DxZzVPNUj2rOW5GKv5hJU8WeXZs45n80x/VrG7g2jPCvYHUd0J8vMg5sU1KKgeWDMd3R6XQct9qJfffnyj2OzwVet4HAF/nIv2M1Q6HkfBH+ei/QxVDjdRuL6Cqw96/mnuLmz6eBxzvRruBJ9B93OddHELirZI+OO6xAznB3V/MffxOIMvazXI0EmHyeNx5q+bowgFf9p00gX1DtaEvUEV6irCLOAQON9JD5yzcqLe943HLK4hyA60f+rZa1AQuboiqB54INcgOXM6UD3wQJ5B+6srKPnT9GbValD0o+95xJpPcBlU+wSq7uXgik7fvAfZgXVPoBrsiJdW0Gs/3olitROo0HsT7cE4iEmB7MCaJ1B1v8eLa9+atEB+YL0TqPa9c4CoPb5hvtYJVP2QLmtND6oHmtNh6JsrZ64Mqgea00H4wjqA3MDn+4e4Hl++y3WcOGuDzMA4P+wePpdOFMeZT0mSJUBmYDx3Kh77X3wCFcIFtqC4hNovuhZvf0GeABLIC4zrrcNzwatBicBoUN/9lE8Uxx9pkBnY9Txxe6Lh4cZsOvkxPuQbtLt5enns2s7897PUqZcNcgN3cQfw833pNuDVkGtQKybyp9+uEJyVwoK/ZFH+9NsVgrNSWPCXLMqffrtCcFYKC/6SRfnTb1cIzkphwV+yKH/67QrBWSks+EsW5U+/XSE4K4UFf8mi/Om3KwRnpbDgL1mUP/12heCsFBb8JYvyp9+uEJyVwoK/5CcBbAHqgC1AHbAFqAO2AHXAFqAO2ALUAVuAOmALUAdsAeqALUAdsAWoA7YAddA4f/cpNOujyHjeuekjNdORqaNHcjScAG9BG93GYuv3Kb1+u3kKW8tfZTpylzjfJ0fDKXCWs9FvyjeefjrsDTAET0bG83pLNJwCXzEj5o9YHdiZ97glIre3f50Y5NBwDEoKz7L78u+jsVsZsW8OOI188+K0D3JoOAbegia23a7irA0jk2edGyK7i+nUoHwN74CznI3+wK+MPVk783CTiEyf1Zut4T3wFTPSd432jaEl7afvbBIGZWr4AHzF5tl2M5X+322+m9z205qt2Z9U5HbY2PLBCauGCeArZqT/rLm1edtPv5qOPG1BeRpOgK+Yla5bsH7gPO5lL41MzKRzNJwCZzkrO+vdw/4SMcyDzkSmbjUyNJwCb8HPAtgC1AFbgDpgC1AHbAHqgC1AHbAFqAO2AHXAFqAO2ALUAVuAOmALUAdsAeqALUAdsAWoA7YAdcAWoA7YAtQBW4A6YAtQB2wB6oAtQB2wBagDtgB1wBagDtgC1AFbgDpgC8il7CsG88GitZWT2ufbFCxaWzGpfb5twaK1FZPa59sWLFqbide/+y/RSWzpSe7zbQsWrc3E5vaf8PxHyob0Pt+2YNHaLPTbLXe/9v+3GXZmxj2/6X2+bcGitVnot1uO34t7zMQ+37Zg0dosDAYlvotpYp9vW7BkZSZ6a8aN3+8usfjGp29BYXfz55mvpLwaFMJ/vwO/TNlwNUgMsAWoA7YAdcAWoA7YAtQBW4A6YAtQB2wB6oAtQB2wBagDtgB1wBagDtgC1AFbgDpgC1AHbAHqgC1AHbAFqAO2AHXAFqAO2ALUAVuAOmALUAdsAer8D9IqNQBwVMKNAAAAAElFTkSuQmCC" /><!-- --><img src="data:image/png;base64,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" /><!-- --> The above four graphs are qq-plots of random numbers generated with different <span class="math inline">\(\sigma\)</span> by <strong>Cpp</strong> functions. We can see that the distribution of generated random numbers is closest to the standard Laplace distribution when <span class="math inline">\(\sigma\)</span> is slected to be 1.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a>rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb102-2"><a href="#cb102-2"></a>  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb102-3"><a href="#cb102-3"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb102-4"><a href="#cb102-4"></a>  k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb102-5"><a href="#cb102-5"></a>  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x0, sigma)</span>
<span id="cb102-6"><a href="#cb102-6"></a>    <span class="cf">if</span> (u[<span class="dv">1</span>] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">lap</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">lap</span>(x0)))</span>
<span id="cb102-7"><a href="#cb102-7"></a>    x[<span class="dv">1</span>] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</span>
<span id="cb102-8"><a href="#cb102-8"></a>      x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb102-9"><a href="#cb102-9"></a>      k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb102-10"><a href="#cb102-10"></a>    }</span>
<span id="cb102-11"><a href="#cb102-11"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb102-12"><a href="#cb102-12"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb102-13"><a href="#cb102-13"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">lap</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">lap</span>(x[i<span class="dv">-1</span>])))</span>
<span id="cb102-14"><a href="#cb102-14"></a>    x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</span>
<span id="cb102-15"><a href="#cb102-15"></a>      x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb102-16"><a href="#cb102-16"></a>      k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb102-17"><a href="#cb102-17"></a>    }</span>
<span id="cb102-18"><a href="#cb102-18"></a>  }</span>
<span id="cb102-19"><a href="#cb102-19"></a><span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>(<span class="dv">1</span><span class="op">-</span>k<span class="op">/</span>N)))</span>
<span id="cb102-20"><a href="#cb102-20"></a>}</span>
<span id="cb102-21"><a href="#cb102-21"></a>rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb102-22"><a href="#cb102-22"></a>rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb102-23"><a href="#cb102-23"></a>rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb102-24"><a href="#cb102-24"></a>rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb102-25"><a href="#cb102-25"></a><span class="co"># acceptance rates</span></span>
<span id="cb102-26"><a href="#cb102-26"></a><span class="co">#print(c(rw1$k, rw2$k, rw3$k, rw4$k))</span></span>
<span id="cb102-27"><a href="#cb102-27"></a>rw&lt;-<span class="kw">cbind</span>(rw1<span class="op">$</span>x,rw2<span class="op">$</span>x,rw3<span class="op">$</span>x,rw4<span class="op">$</span>x)</span>
<span id="cb102-28"><a href="#cb102-28"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb102-29"><a href="#cb102-29"></a><span class="co">#qqplot</span></span>
<span id="cb102-30"><a href="#cb102-30"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</span>
<span id="cb102-31"><a href="#cb102-31"></a>  <span class="kw">qqplot</span>(rw[,j],theo,<span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),<span class="dt">ylab =</span> <span class="st">&quot;Sample quantile&quot;</span>)</span>
<span id="cb102-32"><a href="#cb102-32"></a>  <span class="kw">abline</span>(<span class="dt">coef =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb102-33"><a href="#cb102-33"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAZlBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6ZpA6ZrY6kNtmAABmADpmOgBmZrZmtttmtv+QOgCQZgCQ2/+2ZgC2Zjq22/+2/7a2///bkDrbtpDb////tmb/25D//7b//9v///9HMskYAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIoklEQVR4nO2djXbjJhBGySbpX9Juk8ZtV40T+/1fshZItmVL+gYGzEj57jnZsz5BGN/AAAJhtyezuNoFsA4FASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEGAM0Gfz+7+ffNUrywmOQna3r019++fzypDbjFEC9q9Pu0PgvbNtx8aQYprb0PnJl7Q5/OLF7RdtyB39iO+wNPXoM3hR/f+lnH9v/GCuhjUuBd9AeyiEdT2Ys7dvWUogF1UgvIVwDBtjE6LQZneP2922XHpvViuApjm2MJiBfnw07Hmbt6xic1zGkVT0CjBDQVNktzEDlPUYxhadQzyflxXi2SXZC5B3uxyc5rLJ0xWfw9j6DVPVp0mSPeC1ny7QyFocxoH6W6YaS4uzfm9svQapCxDhjzKEMKzQlCmYuTNLhe9FZWg3Svq5sP96u1cGouCTjegdYI2MDp7Qe1dR39/FmRnhfMRjy4G4eWMNkmnppm4MWtM0HD1QhmkpyrFiVbQx6NPdjFail9NuQFXpdEJ2r0+oLRLqkFjfyudoEPwRVUoTNce9jPt0YagiZp8XslTmphksnpIdfd2cDkVrwwImm7nOkF5qC5oJgo6CprvJLSC+ja21Mkq6kKH/WzKQPH+vXnou/FUagnCAwynFdR2TNt2d8fy1uYlw6/LkVraQPHj5x/+J50KgkSD06uRbMpA8cnf8liWIOnY/WqknxCD2luJm6clNTH5zOZ6JpTSzW8e2p5M1YndUFDMvG9kprjycVDcrHhsKr1mQal2hrc+xNf3/1nKwmHcHRU34Se9BumWxUoLSq882QS1oVpBSUFRdi7lXF6cLsjoyqrQzoiXUT8KQRZXVqOHg9BPuqDPZ3NNTNqyIvRoejHVQDq/oAKVJ6QXF0CasEZ24rAcq2cVgkR25sxM24kp6PVA0WnGirkESewky4kq6OWyj4lnNYQ3TxO8nPIQl6X/z+41mKl+u2O2YUCyF/TUxExswbv8iNhIkh5NDar4vNjwE0a6idwWkBKD/JNQje55qHRB0T40etK6ed+PzdcfuMkqRdBtzcQWNCr/pl+Tn1ycjy9uBTlRBY15j3bhoyPX9pfbm4ktaMxbne2xyrSBqoKZ/p2zJ9xnr0E3VpJY0MgY1FUhfQyq6CayoFHZwnsi4tn3uKGowqhI7ObVh5tI3teF55HqiDkWIj5hnsNNYIJrOxX0pE01yh9u4rpHIqvrSbsfVPhwk7G6U82PogaVmazW6KhmSY5BRW6YmdOjmKzmP9xk0k5FPXZu2rupEU9lPzYEjXZaFuzsLQjqJVi0s48WlP1wk8uH/EzJaalag840GFQTqCdoYMKqnmL3pHF2l1HaqB8jqxpm9RhZFzPsx8TKqmU/Ftbm7caflpQYlHd3h20/9fcHGfdTf6ph3E91Qdb9pAjK+VCveT9JvRjsvuTH45j3k3jTHiA/HmeNgs4W3qcQH25i309KDPr4Cc3Cpo/HuchupYIeUZD+2jVIdH5Q+6kFx+PY91MmSO8nj8e5GDevUpAgSIuzW6UgQZDumFO5YkHyp56/qCA5UNACOjEKQpScrEoFSYtQhQRB2U6gct2GBU0+xUkJ0rlOoFpCC0scKOY5gWoJfhIHinlOoFpCC0uJQdlOoFppDcp3AtVqBeV6X3f8xzBVBYWOPm/GuYkW9PH45O/HZ9jlGtrXygT58WG7+JxloGi/hUUL8udO+WP/1SdQuf0Cevn4TZxP/U1X9fYXF1eASkQLejmuC1LQSEIvKISfDAPFmPevRUoM8tsTBYsbMDv7EShe0Pbu7fO5rTv4+1nyvG9tosdBW78D+ONRvQ14KcQKKoAoa4uJlFfkzdpiIuUVebO2mEh5Rd6sLSZSXpE3a4uJlFfkzdpiIuUVebO2mEh5Rd6sLSZSXpE3a4uJlFd8MSgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCgnCB/evn8AzKS7TaCbAL40JH2ibjoZdFignavh8/ezBaoPW9mCwwJsukygyf7tJuc47/bqZigbqV/ZqE27NgH221wNgF/Uu9sivB20SexFo5BcxVE+tlBNoHm/i8gSPy415DCguaW+kOJRdtt4I6BQ14oBm2//fssi2YDygqaPLnc/9JXC1w5QDYtbfNBgpp2h3P85pWigrYwRosEzWfTIjmlNxw+Fr0/rKQg8IeXNjFYf0JOUJB/o+hNqiUENWHk0oAPJgzSKJvuDVtmP3v4S0SH6nI1CJ5lJerm5UdioRoUnnu308T8zvR5JANFQTYdcCTdBqr4h9+LCeqq/eznb8DvhdkE8FRjK5y0DOBkFUBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCLEDQYLNw/+L0DQ2FsS9osAfk+CJxS2Y85gUNdhGdXuiOWovAvKDBPrTTi+YGrctjRdDu7/DNOVf7dwY7GU8vNr+kbPZJwIqgzf0/+4/vI1ugBnthjy+6A9duYMiIoK5q/BZebbpNmf7gy1FBId0tApERQeGj9l+Ge85EEwu/0x08K8KWoJEvYJoI0uF3N+jrjQgKavoacd7Exrv5kPILNbFDXPlz4nsoxweK4fjirxOk9/v//nDu19GNvN1m4fAcynHn8AbtrM+EGUFWoSAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAP8Dnpg4AwkjofsAAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>The above four graphs are qq-plots of random numbers generated with different <span class="math inline">\(\sigma\)</span> by <strong>R</strong> functions. The chain performs best when <span class="math inline">\(\sigma\)</span> is 1.</p>
<p>Here we compare the distribution similarity of the two generated samples (only for <span class="math inline">\(\sigma=1\)</span>).</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a><span class="co">#par(mfrow=c(1,2))</span></span>
<span id="cb103-2"><a href="#cb103-2"></a><span class="kw">qqplot</span>(a[<span class="op">-</span><span class="dv">1</span>,<span class="dv">2</span>],rw[,<span class="dv">2</span>],<span class="dt">xlab =</span> <span class="st">&quot;Sample quantile (Cpp function) with sigma=1&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;Sample quantile (R function)&quot;</span>)</span>
<span id="cb103-3"><a href="#cb103-3"></a><span class="kw">abline</span>(<span class="dt">coef =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a><span class="kw">qqplot</span>(a[<span class="op">-</span><span class="dv">1</span>,<span class="dv">2</span>],rw[,<span class="dv">2</span>],<span class="dt">xlab =</span> <span class="st">&quot;Sample quantile (Cpp function) with sigma=4&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;Sample quantile (R function)&quot;</span>)</span>
<span id="cb104-2"><a href="#cb104-2"></a><span class="kw">abline</span>(<span class="dt">coef =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The qq-plots with <span class="math inline">\(\sigma=1,4\)</span> are shown above.</p>
</div>
<div id="question-3-3" class="section level1">
<h1>Question 3</h1>
<p>Campare the computation time of the two functions with the function “microbenchmark”.</p>
</div>
<div id="answer-33" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a><span class="kw">library</span>(microbenchmark)</span>
<span id="cb105-2"><a href="#cb105-2"></a>ts1&lt;-<span class="kw">microbenchmark</span>(<span class="dt">rw_R=</span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>],x0,N),<span class="dt">metro_C=</span><span class="kw">metro</span>(N,sigma[<span class="dv">1</span>],x0))</span>
<span id="cb105-3"><a href="#cb105-3"></a>ts2&lt;-<span class="kw">microbenchmark</span>(<span class="dt">rw_R=</span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>],x0,N),<span class="dt">metro_C=</span><span class="kw">metro</span>(N,sigma[<span class="dv">2</span>],x0))</span>
<span id="cb105-4"><a href="#cb105-4"></a>ts3&lt;-<span class="kw">microbenchmark</span>(<span class="dt">rw_R=</span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>],x0,N),<span class="dt">metro_C=</span><span class="kw">metro</span>(N,sigma[<span class="dv">3</span>],x0))</span>
<span id="cb105-5"><a href="#cb105-5"></a>ts4&lt;-<span class="kw">microbenchmark</span>(<span class="dt">rw_R=</span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>],x0,N),<span class="dt">metro_C=</span><span class="kw">metro</span>(N,sigma[<span class="dv">4</span>],x0))</span>
<span id="cb105-6"><a href="#cb105-6"></a><span class="kw">summary</span>(ts1)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##      expr       lq   median       uq
## 1    rw_R 40.26875 45.12525 48.29030
## 2 metro_C  2.34900  2.39385  2.50235</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a><span class="kw">summary</span>(ts2)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##      expr       lq   median      uq
## 1    rw_R 43.49480 48.90040 52.9066
## 2 metro_C  2.47095  2.60835  2.9129</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a><span class="kw">summary</span>(ts3)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##      expr      lq   median      uq
## 1    rw_R 40.4721 42.99165 47.2651
## 2 metro_C  2.4383  2.45565  2.5596</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a><span class="kw">summary</span>(ts4)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##      expr       lq   median       uq
## 1    rw_R 40.86055 45.36020 49.06690
## 2 metro_C  2.36755  2.39105  2.46065</code></pre>
<p>The results of computation time of the two functions<strong>rw_R</strong> and <strong>metro_C</strong> with four different <span class="math inline">\(\sigma\)</span> have been showed. We can observe that the computation time of Cpp function is significantly less than that of R function.</p>
</div>
<div id="question-4-1" class="section level1">
<h1>Question 4</h1>
<p>Comment your results.</p>
</div>
<div id="answer-34" class="section level1">
<h1>Answer</h1>
<p>Whether the chain is generated by a function in R or Cpp, the most suitable variance is around 1 (according to the acceptance rate and convergence performance). when the selected sigma is appropriate, the distribution of random number chains generated by the two functions are both close to the target distribution (standard Laplace)according to the qq-plot.</p>
<p>In terms of acceptance rate, the two are also very close. However, in terms of computation time, especially when the required sample size is large (n = 5000), the function in Cpp performs obviously better than that in R.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
